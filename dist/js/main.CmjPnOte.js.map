{"version":3,"file":"main.CmjPnOte.js","sources":["../../src/types/enums.ts","../../src/core/StateManager.ts","../../src/core/InputState.ts","../../src/core/InputManager.ts","../../src/core/EntityManager.ts","../../src/types/GameConfig.ts","../../src/core/GameEngine.ts","../../src/core/states/MenuState.ts","../../src/core/states/PlayingState.ts","../../src/core/states/PausedState.ts","../../src/core/states/GameOverState.ts","../../src/systems/CollisionSystem.ts","../../src/entities/Bullet.ts","../../src/entities/EnemyAircraft.ts","../../src/entities/PowerUp.ts","../../src/systems/SpawnSystem.ts","../../src/systems/ScoreSystem.ts","../../src/systems/AudioManager.ts","../../src/systems/VisualEffects.ts","../../src/systems/BackgroundRenderer.ts","../../src/systems/UIRenderer.ts","../../src/systems/SpriteManager.ts","../../src/entities/PlayerAircraft.ts","../../src/main.ts"],"sourcesContent":["/**\n * Game Enumerations\n * æ¸¸æˆæšä¸¾ç±»å‹\n */\n\n/**\n * Game State Types\n * æ¸¸æˆçŠ¶æ€ç±»å‹\n */\nexport enum GameStateType {\n  /** Main menu state */\n  MENU = 'menu',\n  /** Active gameplay state */\n  PLAYING = 'playing',\n  /** Game is paused */\n  PAUSED = 'paused',\n  /** Game over state */\n  GAME_OVER = 'gameOver'\n}\n\n/**\n * Enemy Aircraft Types\n * æ•Œæœºç±»å‹\n */\nexport enum EnemyType {\n  /** Basic enemy: moves straight down, no shooting */\n  BASIC = 'basic',\n  /** Shooter enemy: moves down, shoots periodically */\n  SHOOTER = 'shooter',\n  /** Zigzag enemy: moves in zigzag pattern */\n  ZIGZAG = 'zigzag',\n  /** Boss enemy: high health, complex movement */\n  BOSS = 'boss'\n}\n\n/**\n * Bullet Owner Types\n * å­å¼¹æ‰€æœ‰è€…ç±»å‹\n */\nexport enum BulletOwner {\n  /** Bullet fired by player */\n  PLAYER = 'player',\n  /** Bullet fired by enemy */\n  ENEMY = 'enemy'\n}\n\n/**\n * Power-Up Types\n * é“å…·ç±»å‹\n */\nexport enum PowerUpType {\n  /** Weapon upgrade power-up */\n  WEAPON_UPGRADE = 'weaponUpgrade',\n  /** Health restoration power-up */\n  HEALTH = 'health',\n  /** Shield (temporary invincibility) power-up */\n  SHIELD = 'shield'\n}\n\n/**\n * Collision Types\n * ç¢°æ’ç±»å‹ï¼ˆç”¨äºç¢°æ’è¿‡æ»¤ï¼‰\n */\nexport enum CollisionType {\n  /** Player aircraft */\n  PLAYER = 'player',\n  /** Enemy aircraft */\n  ENEMY = 'enemy',\n  /** Player's bullet */\n  PLAYER_BULLET = 'playerBullet',\n  /** Enemy's bullet */\n  ENEMY_BULLET = 'enemyBullet',\n  /** Power-up item */\n  POWER_UP = 'powerUp'\n}\n\n/**\n * Sound Effect Types\n * éŸ³æ•ˆç±»å‹\n */\nexport enum SoundEffect {\n  /** Player shooting sound */\n  PLAYER_SHOOT = 'playerShoot',\n  /** Enemy shooting sound */\n  ENEMY_SHOOT = 'enemyShoot',\n  /** Explosion sound */\n  EXPLOSION = 'explosion',\n  /** Power-up collection sound */\n  POWER_UP = 'powerUp',\n  /** Hit sound */\n  HIT = 'hit'\n}\n\n/**\n * Movement Pattern Types\n * ç§»åŠ¨æ¨¡å¼ç±»å‹\n */\nexport enum MovementPattern {\n  /** Straight line movement */\n  STRAIGHT = 'straight',\n  /** Zigzag movement pattern */\n  ZIGZAG = 'zigzag',\n  /** Sine wave movement pattern */\n  SINE = 'sine',\n  /** Circular movement pattern */\n  CIRCULAR = 'circular',\n  /** Follow player movement pattern */\n  FOLLOW = 'follow'\n}\n","/**\n * StateManager Class\n * çŠ¶æ€ç®¡ç†å™¨ç±»\n * \n * Manages game states and transitions between them.\n * ç®¡ç†æ¸¸æˆçŠ¶æ€åŠå…¶ä¹‹é—´çš„è½¬æ¢ã€‚\n */\nimport { GameStateType } from '../types/enums';\nimport { GameState } from './GameState';\nimport { InputState } from './InputState';\n\n/**\n * Valid state transitions map\n * æœ‰æ•ˆçš„çŠ¶æ€è½¬æ¢æ˜ å°„\n */\nconst VALID_TRANSITIONS: Map<GameStateType, GameStateType[]> = new Map([\n  [GameStateType.MENU, [GameStateType.PLAYING]],\n  [GameStateType.PLAYING, [GameStateType.PAUSED, GameStateType.GAME_OVER]],\n  [GameStateType.PAUSED, [GameStateType.PLAYING, GameStateType.MENU]],\n  [GameStateType.GAME_OVER, [GameStateType.MENU, GameStateType.PLAYING]]\n]);\n\nexport class StateManager {\n  private currentState: GameState | null = null;\n  private states: Map<GameStateType, GameState> = new Map();\n  \n  /**\n   * Register a state with the manager\n   * å‘ç®¡ç†å™¨æ³¨å†ŒçŠ¶æ€\n   * @param type The state type\n   * @param state The state instance\n   */\n  registerState(type: GameStateType, state: GameState): void {\n    this.states.set(type, state);\n  }\n  \n  /**\n   * Change to a new state\n   * åˆ‡æ¢åˆ°æ–°çŠ¶æ€\n   * @param type The target state type\n   * @returns true if transition was successful\n   */\n  changeState(type: GameStateType): boolean {\n    const newState = this.states.get(type);\n    \n    if (!newState) {\n      console.error(`State ${type} not registered`);\n      return false;\n    }\n    \n    // Check if transition is valid (if we have a current state)\n    if (this.currentState) {\n      const validTransitions = VALID_TRANSITIONS.get(this.currentState.type);\n      if (validTransitions && !validTransitions.includes(type)) {\n        console.error(`Invalid state transition from ${this.currentState.type} to ${type}`);\n        return false;\n      }\n      \n      // Exit current state\n      this.currentState.exit();\n    }\n    \n    // Enter new state\n    this.currentState = newState;\n    this.currentState.enter();\n    \n    return true;\n  }\n  \n  /**\n   * Get the current state\n   * è·å–å½“å‰çŠ¶æ€\n   */\n  getCurrentState(): GameState | null {\n    return this.currentState;\n  }\n  \n  /**\n   * Get the current state type\n   * è·å–å½“å‰çŠ¶æ€ç±»å‹\n   */\n  getCurrentStateType(): GameStateType | null {\n    return this.currentState?.type ?? null;\n  }\n  \n  /**\n   * Check if a transition to the target state is valid\n   * æ£€æŸ¥åˆ°ç›®æ ‡çŠ¶æ€çš„è½¬æ¢æ˜¯å¦æœ‰æ•ˆ\n   * @param targetType The target state type\n   */\n  canTransitionTo(targetType: GameStateType): boolean {\n    if (!this.currentState) {\n      return true; // Can transition to any state if no current state\n    }\n    \n    const validTransitions = VALID_TRANSITIONS.get(this.currentState.type);\n    return validTransitions?.includes(targetType) ?? false;\n  }\n  \n  /**\n   * Update the current state\n   * æ›´æ–°å½“å‰çŠ¶æ€\n   * @param deltaTime Time elapsed since last frame in seconds\n   */\n  update(deltaTime: number): void {\n    this.currentState?.update(deltaTime);\n  }\n  \n  /**\n   * Render the current state\n   * æ¸²æŸ“å½“å‰çŠ¶æ€\n   * @param context The 2D rendering context\n   */\n  render(context: CanvasRenderingContext2D): void {\n    this.currentState?.render(context);\n  }\n  \n  /**\n   * Handle input for the current state\n   * å¤„ç†å½“å‰çŠ¶æ€çš„è¾“å…¥\n   * @param input The current input state\n   */\n  handleInput(input: InputState): void {\n    this.currentState?.handleInput(input);\n  }\n  \n  /**\n   * Check if a state is registered\n   * æ£€æŸ¥çŠ¶æ€æ˜¯å¦å·²æ³¨å†Œ\n   * @param type The state type to check\n   */\n  hasState(type: GameStateType): boolean {\n    return this.states.has(type);\n  }\n  \n  /**\n   * Get all registered state types\n   * è·å–æ‰€æœ‰å·²æ³¨å†Œçš„çŠ¶æ€ç±»å‹\n   */\n  getRegisteredStates(): GameStateType[] {\n    return Array.from(this.states.keys());\n  }\n}\n","/**\n * InputState Interface\n * è¾“å…¥çŠ¶æ€æ¥å£\n * \n * Represents the current state of all input devices.\n * è¡¨ç¤ºæ‰€æœ‰è¾“å…¥è®¾å¤‡çš„å½“å‰çŠ¶æ€ã€‚\n */\nexport interface InputState {\n  /** Set of currently pressed keys */\n  keys: Set<string>;\n  \n  /** Current mouse X position relative to canvas */\n  mouseX: number;\n  \n  /** Current mouse Y position relative to canvas */\n  mouseY: number;\n  \n  /** Whether the mouse button is currently pressed */\n  mouseDown: boolean;\n}\n\n/**\n * Create a default input state\n * åˆ›å»ºé»˜è®¤è¾“å…¥çŠ¶æ€\n */\nexport function createDefaultInputState(): InputState {\n  return {\n    keys: new Set<string>(),\n    mouseX: 0,\n    mouseY: 0,\n    mouseDown: false\n  };\n}\n","/**\n * InputManager Class\n * è¾“å…¥ç®¡ç†å™¨ç±»\n * \n * Handles keyboard and mouse input for the game.\n * å¤„ç†æ¸¸æˆçš„é”®ç›˜å’Œé¼ æ ‡è¾“å…¥ã€‚\n */\nimport { InputState, createDefaultInputState } from './InputState';\n\n/**\n * Default key bindings\n * é»˜è®¤é”®ä½ç»‘å®š\n */\nconst DEFAULT_KEY_BINDINGS: Record<string, string> = {\n  // Movement\n  'ArrowUp': 'moveUp',\n  'ArrowDown': 'moveDown',\n  'ArrowLeft': 'moveLeft',\n  'ArrowRight': 'moveRight',\n  'KeyW': 'moveUp',\n  'KeyS': 'moveDown',\n  'KeyA': 'moveLeft',\n  'KeyD': 'moveRight',\n  // Actions\n  'Space': 'fire',\n  'KeyP': 'pause',\n  'Escape': 'menu',\n  'Enter': 'confirm'\n};\n\nexport class InputManager {\n  private inputState: InputState;\n  private keyBindings: Map<string, string>;\n  private canvas: HTMLCanvasElement | null = null;\n  \n  // Bound event handlers for proper removal\n  private boundHandleKeyDown: (e: KeyboardEvent) => void;\n  private boundHandleKeyUp: (e: KeyboardEvent) => void;\n  private boundHandleMouseMove: (e: MouseEvent) => void;\n  private boundHandleMouseDown: (e: MouseEvent) => void;\n  private boundHandleMouseUp: (e: MouseEvent) => void;\n  \n  constructor(canvas?: HTMLCanvasElement) {\n    this.inputState = createDefaultInputState();\n    this.keyBindings = new Map(Object.entries(DEFAULT_KEY_BINDINGS));\n    \n    // Bind event handlers\n    this.boundHandleKeyDown = this.handleKeyDown.bind(this);\n    this.boundHandleKeyUp = this.handleKeyUp.bind(this);\n    this.boundHandleMouseMove = this.handleMouseMove.bind(this);\n    this.boundHandleMouseDown = this.handleMouseDown.bind(this);\n    this.boundHandleMouseUp = this.handleMouseUp.bind(this);\n    \n    if (canvas) {\n      this.attachToCanvas(canvas);\n    }\n  }\n  \n  /**\n   * Attach input listeners to a canvas element\n   * å°†è¾“å…¥ç›‘å¬å™¨é™„åŠ åˆ°ç”»å¸ƒå…ƒç´ \n   * @param canvas The canvas element\n   */\n  attachToCanvas(canvas: HTMLCanvasElement): void {\n    this.canvas = canvas;\n    \n    // Keyboard events on document\n    document.addEventListener('keydown', this.boundHandleKeyDown);\n    document.addEventListener('keyup', this.boundHandleKeyUp);\n    \n    // Mouse events on canvas\n    canvas.addEventListener('mousemove', this.boundHandleMouseMove);\n    canvas.addEventListener('mousedown', this.boundHandleMouseDown);\n    canvas.addEventListener('mouseup', this.boundHandleMouseUp);\n    \n    // Prevent context menu on right-click\n    canvas.addEventListener('contextmenu', (e) => e.preventDefault());\n  }\n  \n  /**\n   * Detach input listeners\n   * åˆ†ç¦»è¾“å…¥ç›‘å¬å™¨\n   */\n  detach(): void {\n    document.removeEventListener('keydown', this.boundHandleKeyDown);\n    document.removeEventListener('keyup', this.boundHandleKeyUp);\n    \n    if (this.canvas) {\n      this.canvas.removeEventListener('mousemove', this.boundHandleMouseMove);\n      this.canvas.removeEventListener('mousedown', this.boundHandleMouseDown);\n      this.canvas.removeEventListener('mouseup', this.boundHandleMouseUp);\n      this.canvas = null;\n    }\n  }\n  \n  /**\n   * Get the current input state\n   * è·å–å½“å‰è¾“å…¥çŠ¶æ€\n   */\n  getInputState(): InputState {\n    return this.inputState;\n  }\n  \n  /**\n   * Check if an action is currently active\n   * æ£€æŸ¥æŸä¸ªåŠ¨ä½œæ˜¯å¦å½“å‰æ¿€æ´»\n   * @param action The action name (e.g., 'moveUp', 'fire')\n   */\n  isActionActive(action: string): boolean {\n    for (const [key, boundAction] of this.keyBindings) {\n      if (boundAction === action && this.inputState.keys.has(key)) {\n        return true;\n      }\n    }\n    \n    // Special case for fire action with mouse\n    if (action === 'fire' && this.inputState.mouseDown) {\n      return true;\n    }\n    \n    return false;\n  }\n  \n  /**\n   * Check if a specific key is pressed\n   * æ£€æŸ¥ç‰¹å®šé”®æ˜¯å¦è¢«æŒ‰ä¸‹\n   * @param keyCode The key code (e.g., 'KeyW', 'Space')\n   */\n  isKeyPressed(keyCode: string): boolean {\n    return this.inputState.keys.has(keyCode);\n  }\n  \n  /**\n   * Get the current mouse position\n   * è·å–å½“å‰é¼ æ ‡ä½ç½®\n   */\n  getMousePosition(): { x: number; y: number } {\n    return {\n      x: this.inputState.mouseX,\n      y: this.inputState.mouseY\n    };\n  }\n  \n  /**\n   * Check if the mouse button is down\n   * æ£€æŸ¥é¼ æ ‡æŒ‰é’®æ˜¯å¦æŒ‰ä¸‹\n   */\n  isMouseDown(): boolean {\n    return this.inputState.mouseDown;\n  }\n  \n  /**\n   * Set a key binding\n   * è®¾ç½®é”®ä½ç»‘å®š\n   * @param keyCode The key code\n   * @param action The action name\n   */\n  setKeyBinding(keyCode: string, action: string): void {\n    this.keyBindings.set(keyCode, action);\n  }\n  \n  /**\n   * Get the action bound to a key\n   * è·å–ç»‘å®šåˆ°æŸä¸ªé”®çš„åŠ¨ä½œ\n   * @param keyCode The key code\n   */\n  getKeyBinding(keyCode: string): string | undefined {\n    return this.keyBindings.get(keyCode);\n  }\n  \n  /**\n   * Get all key bindings\n   * è·å–æ‰€æœ‰é”®ä½ç»‘å®š\n   */\n  getAllKeyBindings(): Map<string, string> {\n    return new Map(this.keyBindings);\n  }\n  \n  /**\n   * Reset key bindings to defaults\n   * é‡ç½®é”®ä½ç»‘å®šä¸ºé»˜è®¤å€¼\n   */\n  resetKeyBindings(): void {\n    this.keyBindings = new Map(Object.entries(DEFAULT_KEY_BINDINGS));\n  }\n  \n  /**\n   * Clear all current input state\n   * æ¸…é™¤æ‰€æœ‰å½“å‰è¾“å…¥çŠ¶æ€\n   */\n  clearInputState(): void {\n    this.inputState.keys.clear();\n    this.inputState.mouseDown = false;\n  }\n  \n  // Private event handlers\n  \n  private handleKeyDown(event: KeyboardEvent): void {\n    // Prevent default for game keys to avoid scrolling, etc.\n    if (this.keyBindings.has(event.code)) {\n      event.preventDefault();\n    }\n    this.inputState.keys.add(event.code);\n  }\n  \n  private handleKeyUp(event: KeyboardEvent): void {\n    this.inputState.keys.delete(event.code);\n  }\n  \n  private handleMouseMove(event: MouseEvent): void {\n    if (!this.canvas) return;\n    \n    const rect = this.canvas.getBoundingClientRect();\n    const scaleX = this.canvas.width / rect.width;\n    const scaleY = this.canvas.height / rect.height;\n    \n    this.inputState.mouseX = (event.clientX - rect.left) * scaleX;\n    this.inputState.mouseY = (event.clientY - rect.top) * scaleY;\n  }\n  \n  private handleMouseDown(event: MouseEvent): void {\n    if (event.button === 0) { // Left mouse button\n      this.inputState.mouseDown = true;\n    }\n  }\n  \n  private handleMouseUp(event: MouseEvent): void {\n    if (event.button === 0) { // Left mouse button\n      this.inputState.mouseDown = false;\n    }\n  }\n}\n","/**\n * EntityManager Class\n * å®ä½“ç®¡ç†å™¨ç±»\n * \n * Manages all game entities (player, enemies, bullets, power-ups).\n * ç®¡ç†æ‰€æœ‰æ¸¸æˆå®ä½“ï¼ˆç©å®¶ã€æ•Œæœºã€å­å¼¹ã€é“å…·ï¼‰ã€‚\n */\nimport { GameObject } from '../interfaces/GameObject';\n\nexport class EntityManager {\n  private entities: Map<string, GameObject> = new Map();\n  private entitiesToAdd: GameObject[] = [];\n  private entitiesToRemove: string[] = [];\n  private isUpdating: boolean = false;\n  \n  /**\n   * Add an entity to the manager\n   * å‘ç®¡ç†å™¨æ·»åŠ å®ä½“\n   * @param entity The entity to add\n   */\n  addEntity(entity: GameObject): void {\n    if (this.isUpdating) {\n      // Defer addition until after update completes\n      this.entitiesToAdd.push(entity);\n    } else {\n      this.entities.set(entity.id, entity);\n    }\n  }\n  \n  /**\n   * Remove an entity from the manager\n   * ä»ç®¡ç†å™¨ç§»é™¤å®ä½“\n   * @param id The entity ID to remove\n   */\n  removeEntity(id: string): void {\n    if (this.isUpdating) {\n      // Defer removal until after update completes\n      this.entitiesToRemove.push(id);\n    } else {\n      const entity = this.entities.get(id);\n      if (entity) {\n        entity.destroy();\n        this.entities.delete(id);\n      }\n    }\n  }\n  \n  /**\n   * Get an entity by ID\n   * é€šè¿‡IDè·å–å®ä½“\n   * @param id The entity ID\n   */\n  getEntity(id: string): GameObject | undefined {\n    return this.entities.get(id);\n  }\n  \n  /**\n   * Get all entities of a specific type\n   * è·å–ç‰¹å®šç±»å‹çš„æ‰€æœ‰å®ä½“\n   * @param type The constructor/class of the entity type\n   */\n  getEntitiesByType<T extends GameObject>(type: new (...args: any[]) => T): T[] {\n    const result: T[] = [];\n    for (const entity of this.entities.values()) {\n      if (entity instanceof type) {\n        result.push(entity);\n      }\n    }\n    return result;\n  }\n  \n  /**\n   * Get all active entities\n   * è·å–æ‰€æœ‰æ´»è·ƒå®ä½“\n   */\n  getAllEntities(): GameObject[] {\n    return Array.from(this.entities.values());\n  }\n  \n  /**\n   * Get all active entities (filtered by active flag)\n   * è·å–æ‰€æœ‰æ´»è·ƒå®ä½“ï¼ˆæŒ‰æ´»è·ƒæ ‡å¿—è¿‡æ»¤ï¼‰\n   */\n  getActiveEntities(): GameObject[] {\n    return Array.from(this.entities.values()).filter(e => e.active);\n  }\n  \n  /**\n   * Get the count of entities\n   * è·å–å®ä½“æ•°é‡\n   */\n  getEntityCount(): number {\n    return this.entities.size;\n  }\n  \n  /**\n   * Update all entities\n   * æ›´æ–°æ‰€æœ‰å®ä½“\n   * @param deltaTime Time elapsed since last frame in seconds\n   */\n  update(deltaTime: number): void {\n    this.isUpdating = true;\n    \n    // Update all active entities\n    for (const entity of this.entities.values()) {\n      if (entity.active) {\n        entity.update(deltaTime);\n      }\n    }\n    \n    this.isUpdating = false;\n    \n    // Process deferred additions and removals\n    this.processAdditions();\n    this.processRemovals();\n    \n    // Remove inactive entities\n    this.removeInactiveEntities();\n  }\n  \n  /**\n   * Render all entities\n   * æ¸²æŸ“æ‰€æœ‰å®ä½“\n   * @param context The 2D rendering context\n   */\n  render(context: CanvasRenderingContext2D): void {\n    // Render all active entities\n    for (const entity of this.entities.values()) {\n      if (entity.active) {\n        entity.render(context);\n      }\n    }\n  }\n  \n  /**\n   * Clear all entities\n   * æ¸…é™¤æ‰€æœ‰å®ä½“\n   */\n  clear(): void {\n    // Destroy all entities\n    for (const entity of this.entities.values()) {\n      entity.destroy();\n    }\n    \n    this.entities.clear();\n    this.entitiesToAdd = [];\n    this.entitiesToRemove = [];\n  }\n  \n  /**\n   * Check if an entity exists\n   * æ£€æŸ¥å®ä½“æ˜¯å¦å­˜åœ¨\n   * @param id The entity ID\n   */\n  hasEntity(id: string): boolean {\n    return this.entities.has(id);\n  }\n  \n  /**\n   * Process deferred entity additions\n   * å¤„ç†å»¶è¿Ÿçš„å®ä½“æ·»åŠ \n   */\n  private processAdditions(): void {\n    for (const entity of this.entitiesToAdd) {\n      this.entities.set(entity.id, entity);\n    }\n    this.entitiesToAdd = [];\n  }\n  \n  /**\n   * Process deferred entity removals\n   * å¤„ç†å»¶è¿Ÿçš„å®ä½“ç§»é™¤\n   */\n  private processRemovals(): void {\n    for (const id of this.entitiesToRemove) {\n      const entity = this.entities.get(id);\n      if (entity) {\n        entity.destroy();\n        this.entities.delete(id);\n      }\n    }\n    this.entitiesToRemove = [];\n  }\n  \n  /**\n   * Remove all inactive entities\n   * ç§»é™¤æ‰€æœ‰éæ´»è·ƒå®ä½“\n   */\n  private removeInactiveEntities(): void {\n    const inactiveIds: string[] = [];\n    \n    for (const [id, entity] of this.entities) {\n      if (!entity.active) {\n        inactiveIds.push(id);\n      }\n    }\n    \n    for (const id of inactiveIds) {\n      const entity = this.entities.get(id);\n      if (entity) {\n        entity.destroy();\n        this.entities.delete(id);\n      }\n    }\n  }\n}\n","/**\n * Game Configuration Types\n * æ¸¸æˆé…ç½®ç±»å‹\n */\n\n/**\n * Enemy Configuration\n * æ•Œæœºé…ç½®\n */\nexport interface EnemyConfig {\n  /** Width of the enemy */\n  width: number;\n  /** Height of the enemy */\n  height: number;\n  /** Movement speed (pixels per second) */\n  speed: number;\n  /** Health points */\n  health: number;\n  /** Score value when destroyed */\n  scoreValue: number;\n  /** Fire rate in milliseconds (optional, for shooting enemies) */\n  fireRate?: number;\n}\n\n/**\n * Bullet Configuration\n * å­å¼¹é…ç½®\n */\nexport interface BulletConfig {\n  /** Width of the bullet */\n  width: number;\n  /** Height of the bullet */\n  height: number;\n  /** Movement speed (pixels per second) */\n  speed: number;\n  /** Damage dealt on hit */\n  damage: number;\n}\n\n/**\n * Game Configuration\n * æ¸¸æˆé…ç½®\n */\nexport interface GameConfig {\n  /** Canvas configuration */\n  canvas: {\n    /** Canvas width in pixels */\n    width: number;\n    /** Canvas height in pixels */\n    height: number;\n  };\n  \n  /** Player configuration */\n  player: {\n    /** Player aircraft width */\n    width: number;\n    /** Player aircraft height */\n    height: number;\n    /** Movement speed (pixels per second) */\n    speed: number;\n    /** Maximum health points */\n    maxHealth: number;\n    /** Fire rate (milliseconds between shots) */\n    fireRate: number;\n    /** Invincibility duration after taking damage (milliseconds) */\n    invincibleDuration: number;\n  };\n  \n  /** Enemy configurations by type */\n  enemy: {\n    basic: EnemyConfig;\n    shooter: EnemyConfig;\n    zigzag: EnemyConfig;\n    boss: EnemyConfig;\n  };\n  \n  /** Bullet configurations */\n  bullet: {\n    player: BulletConfig;\n    enemy: BulletConfig;\n  };\n  \n  /** Power-up configuration */\n  powerUp: {\n    /** Drop chance (0-1) */\n    dropChance: number;\n    /** Fall speed (pixels per second) */\n    fallSpeed: number;\n  };\n  \n  /** Spawn system configuration */\n  spawn: {\n    /** Initial spawn rate (milliseconds) */\n    initialRate: number;\n    /** Minimum spawn rate (milliseconds) */\n    minRate: number;\n    /** Difficulty increase interval (milliseconds) */\n    difficultyIncrease: number;\n  };\n}\n\n/**\n * Default game configuration\n * é»˜è®¤æ¸¸æˆé…ç½®\n */\nexport const DEFAULT_GAME_CONFIG: GameConfig = {\n  canvas: {\n    width: 480,\n    height: 800\n  },\n  \n  player: {\n    width: 48,\n    height: 64,\n    speed: 300,\n    maxHealth: 3,\n    fireRate: 200,\n    invincibleDuration: 2000\n  },\n  \n  enemy: {\n    basic: {\n      width: 40,\n      height: 40,\n      speed: 100,\n      health: 1,\n      scoreValue: 10\n    },\n    shooter: {\n      width: 48,\n      height: 48,\n      speed: 80,\n      health: 2,\n      scoreValue: 20,\n      fireRate: 2000\n    },\n    zigzag: {\n      width: 44,\n      height: 44,\n      speed: 120,\n      health: 2,\n      scoreValue: 30\n    },\n    boss: {\n      width: 120,\n      height: 100,\n      speed: 50,\n      health: 20,\n      scoreValue: 200,\n      fireRate: 1000\n    }\n  },\n  \n  bullet: {\n    player: {\n      width: 8,\n      height: 16,\n      speed: 500,\n      damage: 1\n    },\n    enemy: {\n      width: 8,\n      height: 12,\n      speed: 300,\n      damage: 1\n    }\n  },\n  \n  powerUp: {\n    dropChance: 0.15,\n    fallSpeed: 100\n  },\n  \n  spawn: {\n    initialRate: 2000,\n    minRate: 500,\n    difficultyIncrease: 30000\n  }\n};\n","/**\n * GameEngine Class\n * æ¸¸æˆå¼•æ“ç±»\n * \n * The core game controller that manages the game loop, rendering, and state.\n * ç®¡ç†æ¸¸æˆå¾ªç¯ã€æ¸²æŸ“å’ŒçŠ¶æ€çš„æ ¸å¿ƒæ¸¸æˆæ§åˆ¶å™¨ã€‚\n */\nimport { StateManager } from './StateManager';\nimport { InputManager } from './InputManager';\nimport { EntityManager } from './EntityManager';\nimport { GameConfig, DEFAULT_GAME_CONFIG } from '../types/GameConfig';\n\nexport class GameEngine {\n  private canvas: HTMLCanvasElement;\n  private context: CanvasRenderingContext2D;\n  private stateManager: StateManager;\n  private inputManager: InputManager;\n  private entityManager: EntityManager;\n  private config: GameConfig;\n  \n  private lastFrameTime: number = 0;\n  private isRunning: boolean = false;\n  private isPaused: boolean = false;\n  private animationFrameId: number | null = null;\n  \n  // Performance tracking\n  private frameCount: number = 0;\n  private fpsUpdateTime: number = 0;\n  private currentFps: number = 0;\n  \n  constructor(canvasId: string, config: GameConfig = DEFAULT_GAME_CONFIG) {\n    // Get canvas element\n    const canvas = document.getElementById(canvasId) as HTMLCanvasElement;\n    if (!canvas) {\n      throw new Error(`Canvas element with id '${canvasId}' not found`);\n    }\n    this.canvas = canvas;\n    \n    // Get 2D context\n    const context = canvas.getContext('2d');\n    if (!context) {\n      throw new Error('Could not get 2D rendering context');\n    }\n    this.context = context;\n    \n    // Store config\n    this.config = config;\n    \n    // Set canvas size from config\n    this.canvas.width = config.canvas.width;\n    this.canvas.height = config.canvas.height;\n    \n    // Initialize managers\n    this.stateManager = new StateManager();\n    this.inputManager = new InputManager(this.canvas);\n    this.entityManager = new EntityManager();\n    \n    // Bind the game loop to preserve 'this' context\n    this.gameLoop = this.gameLoop.bind(this);\n  }\n  \n  /**\n   * Start the game engine\n   * å¯åŠ¨æ¸¸æˆå¼•æ“\n   */\n  start(): void {\n    if (this.isRunning) {\n      console.warn('Game engine is already running');\n      return;\n    }\n    \n    this.isRunning = true;\n    this.isPaused = false;\n    this.lastFrameTime = performance.now();\n    this.fpsUpdateTime = this.lastFrameTime;\n    this.frameCount = 0;\n    \n    // Start the game loop\n    this.animationFrameId = requestAnimationFrame(this.gameLoop);\n  }\n  \n  /**\n   * Stop the game engine\n   * åœæ­¢æ¸¸æˆå¼•æ“\n   */\n  stop(): void {\n    this.isRunning = false;\n    this.isPaused = false;\n    \n    if (this.animationFrameId !== null) {\n      cancelAnimationFrame(this.animationFrameId);\n      this.animationFrameId = null;\n    }\n    \n    // Clean up input manager\n    this.inputManager.detach();\n  }\n  \n  /**\n   * Pause the game\n   * æš‚åœæ¸¸æˆ\n   */\n  pause(): void {\n    if (!this.isRunning) {\n      console.warn('Cannot pause: game is not running');\n      return;\n    }\n    \n    this.isPaused = true;\n  }\n  \n  /**\n   * Resume the game\n   * æ¢å¤æ¸¸æˆ\n   */\n  resume(): void {\n    if (!this.isRunning) {\n      console.warn('Cannot resume: game is not running');\n      return;\n    }\n    \n    if (!this.isPaused) {\n      console.warn('Game is not paused');\n      return;\n    }\n    \n    this.isPaused = false;\n    this.lastFrameTime = performance.now(); // Reset to avoid large deltaTime\n  }\n  \n  /**\n   * The main game loop\n   * ä¸»æ¸¸æˆå¾ªç¯\n   * @param currentTime The current timestamp from requestAnimationFrame\n   */\n  private gameLoop(currentTime: number): void {\n    if (!this.isRunning) {\n      return;\n    }\n    \n    // Calculate delta time in seconds\n    const deltaTime = this.calculateDeltaTime(currentTime);\n    \n    // Update FPS counter\n    this.updateFps(currentTime);\n    \n    // Handle input\n    const inputState = this.inputManager.getInputState();\n    this.stateManager.handleInput(inputState);\n    \n    // Update game state (only if not paused)\n    if (!this.isPaused) {\n      this.update(deltaTime);\n    }\n    \n    // Render\n    this.render();\n    \n    // Schedule next frame\n    this.animationFrameId = requestAnimationFrame(this.gameLoop);\n  }\n  \n  /**\n   * Calculate delta time between frames\n   * è®¡ç®—å¸§ä¹‹é—´çš„æ—¶é—´å·®\n   * @param currentTime The current timestamp\n   * @returns Delta time in seconds\n   */\n  private calculateDeltaTime(currentTime: number): number {\n    const deltaTime = (currentTime - this.lastFrameTime) / 1000; // Convert to seconds\n    this.lastFrameTime = currentTime;\n    \n    // Cap delta time to prevent large jumps (e.g., when tab is inactive)\n    return Math.min(deltaTime, 0.1); // Max 100ms\n  }\n  \n  /**\n   * Update FPS counter\n   * æ›´æ–°FPSè®¡æ•°å™¨\n   * @param currentTime The current timestamp\n   */\n  private updateFps(currentTime: number): void {\n    this.frameCount++;\n    \n    const elapsed = currentTime - this.fpsUpdateTime;\n    if (elapsed >= 1000) { // Update every second\n      this.currentFps = Math.round((this.frameCount * 1000) / elapsed);\n      this.frameCount = 0;\n      this.fpsUpdateTime = currentTime;\n    }\n  }\n  \n  /**\n   * Update game logic\n   * æ›´æ–°æ¸¸æˆé€»è¾‘\n   * @param deltaTime Time elapsed since last frame in seconds\n   */\n  private update(deltaTime: number): void {\n    this.stateManager.update(deltaTime);\n  }\n  \n  /**\n   * Render the game\n   * æ¸²æŸ“æ¸¸æˆ\n   */\n  private render(): void {\n    // Clear the canvas\n    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    \n    // Render current state\n    this.stateManager.render(this.context);\n  }\n  \n  // Getters for managers and state\n  \n  /**\n   * Get the state manager\n   * è·å–çŠ¶æ€ç®¡ç†å™¨\n   */\n  getStateManager(): StateManager {\n    return this.stateManager;\n  }\n  \n  /**\n   * Get the input manager\n   * è·å–è¾“å…¥ç®¡ç†å™¨\n   */\n  getInputManager(): InputManager {\n    return this.inputManager;\n  }\n  \n  /**\n   * Get the entity manager\n   * è·å–å®ä½“ç®¡ç†å™¨\n   */\n  getEntityManager(): EntityManager {\n    return this.entityManager;\n  }\n  \n  /**\n   * Get the game configuration\n   * è·å–æ¸¸æˆé…ç½®\n   */\n  getConfig(): GameConfig {\n    return this.config;\n  }\n  \n  /**\n   * Get the canvas element\n   * è·å–ç”»å¸ƒå…ƒç´ \n   */\n  getCanvas(): HTMLCanvasElement {\n    return this.canvas;\n  }\n  \n  /**\n   * Get the rendering context\n   * è·å–æ¸²æŸ“ä¸Šä¸‹æ–‡\n   */\n  getContext(): CanvasRenderingContext2D {\n    return this.context;\n  }\n  \n  /**\n   * Check if the game is running\n   * æ£€æŸ¥æ¸¸æˆæ˜¯å¦æ­£åœ¨è¿è¡Œ\n   */\n  getIsRunning(): boolean {\n    return this.isRunning;\n  }\n  \n  /**\n   * Check if the game is paused\n   * æ£€æŸ¥æ¸¸æˆæ˜¯å¦æš‚åœ\n   */\n  getIsPaused(): boolean {\n    return this.isPaused;\n  }\n  \n  /**\n   * Get the current FPS\n   * è·å–å½“å‰FPS\n   */\n  getCurrentFps(): number {\n    return this.currentFps;\n  }\n}\n","/**\n * MenuState Class\n * èœå•çŠ¶æ€ç±»\n * \n * The main menu state shown when the game starts.\n * æ¸¸æˆå¼€å§‹æ—¶æ˜¾ç¤ºçš„ä¸»èœå•çŠ¶æ€ã€‚\n */\nimport { GameState } from '../GameState';\nimport { InputState } from '../InputState';\nimport { GameStateType } from '../../types/enums';\nimport { StateManager } from '../StateManager';\nimport { GameConfig } from '../../types/GameConfig';\n\nexport class MenuState implements GameState {\n  readonly type = GameStateType.MENU;\n  \n  private stateManager: StateManager;\n  private config: GameConfig;\n  private startKeyPressed: boolean = false;\n  \n  constructor(stateManager: StateManager, config: GameConfig) {\n    this.stateManager = stateManager;\n    this.config = config;\n  }\n  \n  /**\n   * Called when entering the menu state\n   * è¿›å…¥èœå•çŠ¶æ€æ—¶è°ƒç”¨\n   */\n  enter(): void {\n    this.startKeyPressed = false;\n    console.log('Entered Menu State');\n  }\n  \n  /**\n   * Called when exiting the menu state\n   * é€€å‡ºèœå•çŠ¶æ€æ—¶è°ƒç”¨\n   */\n  exit(): void {\n    console.log('Exited Menu State');\n  }\n  \n  /**\n   * Update the menu state\n   * æ›´æ–°èœå•çŠ¶æ€\n   * @param _deltaTime Time elapsed since last frame (unused in menu)\n   */\n  update(_deltaTime: number): void {\n    // Menu state doesn't need continuous updates\n  }\n  \n  /**\n   * Render the menu state\n   * æ¸²æŸ“èœå•çŠ¶æ€\n   * @param context The 2D rendering context\n   */\n  render(context: CanvasRenderingContext2D): void {\n    const { width, height } = this.config.canvas;\n    \n    // Draw background\n    context.fillStyle = '#1a1a2e';\n    context.fillRect(0, 0, width, height);\n    \n    // Draw title\n    context.fillStyle = '#e94560';\n    context.font = 'bold 48px Arial';\n    context.textAlign = 'center';\n    context.textBaseline = 'middle';\n    context.fillText('é›·éœ†æˆ˜æœº', width / 2, height / 3);\n    \n    // Draw subtitle\n    context.fillStyle = '#16213e';\n    context.font = '24px Arial';\n    context.fillText('Thunder Fighter', width / 2, height / 3 + 50);\n    \n    // Draw start instruction (blinking effect)\n    const alpha = 0.5 + 0.5 * Math.sin(Date.now() / 300);\n    context.fillStyle = `rgba(255, 255, 255, ${alpha})`;\n    context.font = '20px Arial';\n    context.fillText('æŒ‰ ENTER æˆ– SPACE å¼€å§‹æ¸¸æˆ', width / 2, height / 2 + 50);\n    context.fillText('Press ENTER or SPACE to Start', width / 2, height / 2 + 80);\n    \n    // Draw controls info\n    context.fillStyle = '#a0a0a0';\n    context.font = '16px Arial';\n    context.fillText('æ§åˆ¶æ–¹å¼ / Controls:', width / 2, height - 150);\n    context.fillText('æ–¹å‘é”® / WASD - ç§»åŠ¨ / Move', width / 2, height - 120);\n    context.fillText('ç©ºæ ¼é”® / é¼ æ ‡å·¦é”® - å°„å‡» / Fire', width / 2, height - 90);\n    context.fillText('P - æš‚åœ / Pause', width / 2, height - 60);\n  }\n  \n  /**\n   * Handle input for the menu state\n   * å¤„ç†èœå•çŠ¶æ€çš„è¾“å…¥\n   * @param input The current input state\n   */\n  handleInput(input: InputState): void {\n    // Check for start game input\n    const startPressed = input.keys.has('Enter') || \n                         input.keys.has('Space') ||\n                         input.mouseDown;\n    \n    // Only trigger on key down (not held)\n    if (startPressed && !this.startKeyPressed) {\n      this.startKeyPressed = true;\n      this.stateManager.changeState(GameStateType.PLAYING);\n    } else if (!startPressed) {\n      this.startKeyPressed = false;\n    }\n  }\n}\n","/**\n * PlayingState Class\n * æ¸¸æˆä¸­çŠ¶æ€ç±»\n * \n * The main gameplay state where the action happens.\n * æ¸¸æˆè¿›è¡Œä¸­çš„ä¸»è¦çŠ¶æ€ã€‚\n */\nimport { GameState } from '../GameState';\nimport { InputState } from '../InputState';\nimport { GameStateType } from '../../types/enums';\nimport { StateManager } from '../StateManager';\nimport { EntityManager } from '../EntityManager';\nimport { GameConfig } from '../../types/GameConfig';\n\nexport class PlayingState implements GameState {\n  readonly type = GameStateType.PLAYING;\n  \n  private stateManager: StateManager;\n  private entityManager: EntityManager;\n  private config: GameConfig;\n  \n  // Game state\n  private score: number = 0;\n  private health: number = 3;\n  private gameTime: number = 0;\n  private pauseKeyPressed: boolean = false;\n  \n  constructor(\n    stateManager: StateManager, \n    entityManager: EntityManager,\n    config: GameConfig\n  ) {\n    this.stateManager = stateManager;\n    this.entityManager = entityManager;\n    this.config = config;\n  }\n  \n  /**\n   * Called when entering the playing state\n   * è¿›å…¥æ¸¸æˆçŠ¶æ€æ—¶è°ƒç”¨\n   */\n  enter(): void {\n    console.log('Entered Playing State');\n    this.pauseKeyPressed = false;\n    \n    // Reset game state if coming from menu or game over\n    // (This will be expanded when player entity is implemented)\n    this.score = 0;\n    this.health = this.config.player.maxHealth;\n    this.gameTime = 0;\n    \n    // Clear any existing entities\n    this.entityManager.clear();\n  }\n  \n  /**\n   * Called when exiting the playing state\n   * é€€å‡ºæ¸¸æˆçŠ¶æ€æ—¶è°ƒç”¨\n   */\n  exit(): void {\n    console.log('Exited Playing State');\n  }\n  \n  /**\n   * Update the playing state\n   * æ›´æ–°æ¸¸æˆçŠ¶æ€\n   * @param deltaTime Time elapsed since last frame in seconds\n   */\n  update(deltaTime: number): void {\n    this.gameTime += deltaTime;\n    \n    // Update all entities\n    this.entityManager.update(deltaTime);\n    \n    // Check for game over condition\n    if (this.health <= 0) {\n      this.stateManager.changeState(GameStateType.GAME_OVER);\n    }\n  }\n  \n  /**\n   * Render the playing state\n   * æ¸²æŸ“æ¸¸æˆçŠ¶æ€\n   * @param context The 2D rendering context\n   */\n  render(context: CanvasRenderingContext2D): void {\n    const { width, height } = this.config.canvas;\n    \n    // Draw background\n    context.fillStyle = '#0f0f23';\n    context.fillRect(0, 0, width, height);\n    \n    // Draw stars (simple background effect)\n    this.renderStars(context);\n    \n    // Render all entities\n    this.entityManager.render(context);\n    \n    // Render UI\n    this.renderUI(context);\n  }\n  \n  /**\n   * Handle input for the playing state\n   * å¤„ç†æ¸¸æˆçŠ¶æ€çš„è¾“å…¥\n   * @param input The current input state\n   */\n  handleInput(input: InputState): void {\n    // Check for pause input\n    const pausePressed = input.keys.has('KeyP') || input.keys.has('Escape');\n    \n    if (pausePressed && !this.pauseKeyPressed) {\n      this.pauseKeyPressed = true;\n      this.stateManager.changeState(GameStateType.PAUSED);\n    } else if (!pausePressed) {\n      this.pauseKeyPressed = false;\n    }\n    \n    // Player input handling will be added when PlayerAircraft is implemented\n  }\n  \n  /**\n   * Render simple star background\n   * æ¸²æŸ“ç®€å•çš„æ˜Ÿæ˜ŸèƒŒæ™¯\n   */\n  private renderStars(context: CanvasRenderingContext2D): void {\n    context.fillStyle = '#ffffff';\n    \n    // Use game time to create scrolling effect\n    const offset = (this.gameTime * 50) % this.config.canvas.height;\n    \n    // Draw some static stars (positions based on simple hash)\n    for (let i = 0; i < 50; i++) {\n      const x = (i * 97) % this.config.canvas.width;\n      const y = ((i * 73 + offset) % this.config.canvas.height);\n      const size = (i % 3) + 1;\n      \n      context.globalAlpha = 0.3 + (i % 5) * 0.1;\n      context.fillRect(x, y, size, size);\n    }\n    \n    context.globalAlpha = 1;\n  }\n  \n  /**\n   * Render the game UI\n   * æ¸²æŸ“æ¸¸æˆUI\n   */\n  private renderUI(context: CanvasRenderingContext2D): void {\n    const { width } = this.config.canvas;\n    \n    // Draw score\n    context.fillStyle = '#ffffff';\n    context.font = '20px Arial';\n    context.textAlign = 'left';\n    context.textBaseline = 'top';\n    context.fillText(`åˆ†æ•°: ${this.score}`, 10, 10);\n    \n    // Draw health\n    context.fillStyle = '#e94560';\n    context.textAlign = 'right';\n    context.fillText(`ç”Ÿå‘½: ${'â¤'.repeat(this.health)}`, width - 10, 10);\n    \n    // Draw game time\n    context.fillStyle = '#a0a0a0';\n    context.font = '14px Arial';\n    context.textAlign = 'left';\n    context.fillText(`æ—¶é—´: ${Math.floor(this.gameTime)}s`, 10, 35);\n  }\n  \n  // Public methods for game logic\n  \n  /**\n   * Add to the score\n   * å¢åŠ åˆ†æ•°\n   * @param points Points to add\n   */\n  addScore(points: number): void {\n    this.score += points;\n  }\n  \n  /**\n   * Get the current score\n   * è·å–å½“å‰åˆ†æ•°\n   */\n  getScore(): number {\n    return this.score;\n  }\n  \n  /**\n   * Set the health\n   * è®¾ç½®ç”Ÿå‘½å€¼\n   * @param health New health value\n   */\n  setHealth(health: number): void {\n    this.health = Math.max(0, Math.min(health, this.config.player.maxHealth));\n  }\n  \n  /**\n   * Get the current health\n   * è·å–å½“å‰ç”Ÿå‘½å€¼\n   */\n  getHealth(): number {\n    return this.health;\n  }\n  \n  /**\n   * Take damage\n   * å—åˆ°ä¼¤å®³\n   * @param damage Amount of damage\n   */\n  takeDamage(damage: number): void {\n    this.health = Math.max(0, this.health - damage);\n  }\n  \n  /**\n   * Get the game time\n   * è·å–æ¸¸æˆæ—¶é—´\n   */\n  getGameTime(): number {\n    return this.gameTime;\n  }\n}\n","/**\n * PausedState Class\n * æš‚åœçŠ¶æ€ç±»\n * \n * The paused state shown when the game is paused.\n * æ¸¸æˆæš‚åœæ—¶æ˜¾ç¤ºçš„æš‚åœçŠ¶æ€ã€‚\n */\nimport { GameState } from '../GameState';\nimport { InputState } from '../InputState';\nimport { GameStateType } from '../../types/enums';\nimport { StateManager } from '../StateManager';\nimport { GameConfig } from '../../types/GameConfig';\n\nexport class PausedState implements GameState {\n  readonly type = GameStateType.PAUSED;\n  \n  private stateManager: StateManager;\n  private config: GameConfig;\n  \n  private resumeKeyPressed: boolean = false;\n  private menuKeyPressed: boolean = false;\n  private selectedOption: number = 0; // 0 = Resume, 1 = Menu\n  \n  constructor(stateManager: StateManager, config: GameConfig) {\n    this.stateManager = stateManager;\n    this.config = config;\n  }\n  \n  /**\n   * Called when entering the paused state\n   * è¿›å…¥æš‚åœçŠ¶æ€æ—¶è°ƒç”¨\n   */\n  enter(): void {\n    console.log('Entered Paused State');\n    this.resumeKeyPressed = false;\n    this.menuKeyPressed = false;\n    this.selectedOption = 0;\n  }\n  \n  /**\n   * Called when exiting the paused state\n   * é€€å‡ºæš‚åœçŠ¶æ€æ—¶è°ƒç”¨\n   */\n  exit(): void {\n    console.log('Exited Paused State');\n  }\n  \n  /**\n   * Update the paused state\n   * æ›´æ–°æš‚åœçŠ¶æ€\n   * @param _deltaTime Time elapsed since last frame (unused in pause)\n   */\n  update(_deltaTime: number): void {\n    // Paused state doesn't need continuous updates\n  }\n  \n  /**\n   * Render the paused state\n   * æ¸²æŸ“æš‚åœçŠ¶æ€\n   * @param context The 2D rendering context\n   */\n  render(context: CanvasRenderingContext2D): void {\n    const { width, height } = this.config.canvas;\n    \n    // Draw semi-transparent overlay\n    context.fillStyle = 'rgba(0, 0, 0, 0.7)';\n    context.fillRect(0, 0, width, height);\n    \n    // Draw pause title\n    context.fillStyle = '#e94560';\n    context.font = 'bold 48px Arial';\n    context.textAlign = 'center';\n    context.textBaseline = 'middle';\n    context.fillText('æ¸¸æˆæš‚åœ', width / 2, height / 3);\n    \n    // Draw subtitle\n    context.fillStyle = '#ffffff';\n    context.font = '24px Arial';\n    context.fillText('PAUSED', width / 2, height / 3 + 50);\n    \n    // Draw menu options\n    const options = [\n      { text: 'ç»§ç»­æ¸¸æˆ / Resume', action: 'resume' },\n      { text: 'è¿”å›èœå• / Main Menu', action: 'menu' }\n    ];\n    \n    const optionStartY = height / 2 + 30;\n    const optionSpacing = 50;\n    \n    options.forEach((option, index) => {\n      const y = optionStartY + index * optionSpacing;\n      const isSelected = index === this.selectedOption;\n      \n      // Draw selection indicator\n      if (isSelected) {\n        context.fillStyle = '#e94560';\n        context.fillText('â–¶', width / 2 - 150, y);\n      }\n      \n      // Draw option text\n      context.fillStyle = isSelected ? '#ffffff' : '#808080';\n      context.font = isSelected ? 'bold 24px Arial' : '24px Arial';\n      context.fillText(option.text, width / 2, y);\n    });\n    \n    // Draw instructions\n    context.fillStyle = '#a0a0a0';\n    context.font = '16px Arial';\n    context.fillText('â†‘â†“ é€‰æ‹© / Select   Enter ç¡®è®¤ / Confirm', width / 2, height - 50);\n    context.fillText('P / ESC ç»§ç»­ / Resume', width / 2, height - 25);\n  }\n  \n  /**\n   * Handle input for the paused state\n   * å¤„ç†æš‚åœçŠ¶æ€çš„è¾“å…¥\n   * @param input The current input state\n   */\n  handleInput(input: InputState): void {\n    // Check for resume input (P or Escape)\n    const resumePressed = input.keys.has('KeyP') || input.keys.has('Escape');\n    \n    if (resumePressed && !this.resumeKeyPressed) {\n      this.resumeKeyPressed = true;\n      this.stateManager.changeState(GameStateType.PLAYING);\n      return;\n    } else if (!resumePressed) {\n      this.resumeKeyPressed = false;\n    }\n    \n    // Handle menu navigation\n    if (input.keys.has('ArrowUp') || input.keys.has('KeyW')) {\n      if (!this.menuKeyPressed) {\n        this.selectedOption = Math.max(0, this.selectedOption - 1);\n        this.menuKeyPressed = true;\n      }\n    } else if (input.keys.has('ArrowDown') || input.keys.has('KeyS')) {\n      if (!this.menuKeyPressed) {\n        this.selectedOption = Math.min(1, this.selectedOption + 1);\n        this.menuKeyPressed = true;\n      }\n    } else {\n      this.menuKeyPressed = false;\n    }\n    \n    // Handle selection\n    if (input.keys.has('Enter') || input.keys.has('Space')) {\n      if (this.selectedOption === 0) {\n        // Resume\n        this.stateManager.changeState(GameStateType.PLAYING);\n      } else {\n        // Return to menu\n        this.stateManager.changeState(GameStateType.MENU);\n      }\n    }\n  }\n}\n","/**\n * GameOverState Class\n * æ¸¸æˆç»“æŸçŠ¶æ€ç±»\n * \n * The game over state shown when the player loses.\n * ç©å®¶å¤±è´¥æ—¶æ˜¾ç¤ºçš„æ¸¸æˆç»“æŸçŠ¶æ€ã€‚\n */\nimport { GameState } from '../GameState';\nimport { InputState } from '../InputState';\nimport { GameStateType } from '../../types/enums';\nimport { StateManager } from '../StateManager';\nimport { GameConfig } from '../../types/GameConfig';\n\nexport class GameOverState implements GameState {\n  readonly type = GameStateType.GAME_OVER;\n  \n  private stateManager: StateManager;\n  private config: GameConfig;\n  \n  private keyPressed: boolean = false;\n  private selectedOption: number = 0; // 0 = Restart, 1 = Menu\n  private menuKeyPressed: boolean = false;\n  \n  // Score data (will be set when entering state)\n  private finalScore: number = 0;\n  private highScore: number = 0;\n  private isNewHighScore: boolean = false;\n  \n  constructor(stateManager: StateManager, config: GameConfig) {\n    this.stateManager = stateManager;\n    this.config = config;\n  }\n  \n  /**\n   * Called when entering the game over state\n   * è¿›å…¥æ¸¸æˆç»“æŸçŠ¶æ€æ—¶è°ƒç”¨\n   */\n  enter(): void {\n    console.log('Entered Game Over State');\n    this.keyPressed = false;\n    this.menuKeyPressed = false;\n    this.selectedOption = 0;\n    \n    // Load high score from localStorage\n    this.loadHighScore();\n    \n    // Check if new high score\n    if (this.finalScore > this.highScore) {\n      this.highScore = this.finalScore;\n      this.isNewHighScore = true;\n      this.saveHighScore();\n    } else {\n      this.isNewHighScore = false;\n    }\n  }\n  \n  /**\n   * Called when exiting the game over state\n   * é€€å‡ºæ¸¸æˆç»“æŸçŠ¶æ€æ—¶è°ƒç”¨\n   */\n  exit(): void {\n    console.log('Exited Game Over State');\n  }\n  \n  /**\n   * Update the game over state\n   * æ›´æ–°æ¸¸æˆç»“æŸçŠ¶æ€\n   * @param _deltaTime Time elapsed since last frame (unused)\n   */\n  update(_deltaTime: number): void {\n    // Game over state doesn't need continuous updates\n  }\n  \n  /**\n   * Render the game over state\n   * æ¸²æŸ“æ¸¸æˆç»“æŸçŠ¶æ€\n   * @param context The 2D rendering context\n   */\n  render(context: CanvasRenderingContext2D): void {\n    const { width, height } = this.config.canvas;\n    \n    // Draw background\n    context.fillStyle = '#1a1a2e';\n    context.fillRect(0, 0, width, height);\n    \n    // Draw game over title\n    context.fillStyle = '#e94560';\n    context.font = 'bold 48px Arial';\n    context.textAlign = 'center';\n    context.textBaseline = 'middle';\n    context.fillText('æ¸¸æˆç»“æŸ', width / 2, height / 4);\n    \n    // Draw subtitle\n    context.fillStyle = '#ffffff';\n    context.font = '24px Arial';\n    context.fillText('GAME OVER', width / 2, height / 4 + 50);\n    \n    // Draw score\n    context.fillStyle = '#ffffff';\n    context.font = '28px Arial';\n    context.fillText(`æœ€ç»ˆå¾—åˆ†: ${this.finalScore}`, width / 2, height / 2 - 40);\n    \n    // Draw high score\n    if (this.isNewHighScore) {\n      // Blinking new high score text\n      const alpha = 0.5 + 0.5 * Math.sin(Date.now() / 200);\n      context.fillStyle = `rgba(233, 69, 96, ${alpha})`;\n      context.font = 'bold 24px Arial';\n      context.fillText('ğŸ‰ æ–°çºªå½•! NEW HIGH SCORE! ğŸ‰', width / 2, height / 2);\n    }\n    \n    context.fillStyle = '#ffd700';\n    context.font = '24px Arial';\n    context.fillText(`æœ€é«˜åˆ†: ${this.highScore}`, width / 2, height / 2 + 40);\n    \n    // Draw menu options\n    const options = [\n      { text: 'é‡æ–°å¼€å§‹ / Restart', action: 'restart' },\n      { text: 'è¿”å›èœå• / Main Menu', action: 'menu' }\n    ];\n    \n    const optionStartY = height / 2 + 120;\n    const optionSpacing = 50;\n    \n    options.forEach((option, index) => {\n      const y = optionStartY + index * optionSpacing;\n      const isSelected = index === this.selectedOption;\n      \n      // Draw selection indicator\n      if (isSelected) {\n        context.fillStyle = '#e94560';\n        context.fillText('â–¶', width / 2 - 150, y);\n      }\n      \n      // Draw option text\n      context.fillStyle = isSelected ? '#ffffff' : '#808080';\n      context.font = isSelected ? 'bold 24px Arial' : '24px Arial';\n      context.fillText(option.text, width / 2, y);\n    });\n    \n    // Draw instructions\n    context.fillStyle = '#a0a0a0';\n    context.font = '16px Arial';\n    context.fillText('â†‘â†“ é€‰æ‹© / Select   Enter ç¡®è®¤ / Confirm', width / 2, height - 30);\n  }\n  \n  /**\n   * Handle input for the game over state\n   * å¤„ç†æ¸¸æˆç»“æŸçŠ¶æ€çš„è¾“å…¥\n   * @param input The current input state\n   */\n  handleInput(input: InputState): void {\n    // Handle menu navigation\n    if (input.keys.has('ArrowUp') || input.keys.has('KeyW')) {\n      if (!this.menuKeyPressed) {\n        this.selectedOption = Math.max(0, this.selectedOption - 1);\n        this.menuKeyPressed = true;\n      }\n    } else if (input.keys.has('ArrowDown') || input.keys.has('KeyS')) {\n      if (!this.menuKeyPressed) {\n        this.selectedOption = Math.min(1, this.selectedOption + 1);\n        this.menuKeyPressed = true;\n      }\n    } else {\n      this.menuKeyPressed = false;\n    }\n    \n    // Handle selection\n    const confirmPressed = input.keys.has('Enter') || input.keys.has('Space');\n    \n    if (confirmPressed && !this.keyPressed) {\n      this.keyPressed = true;\n      \n      if (this.selectedOption === 0) {\n        // Restart game\n        this.stateManager.changeState(GameStateType.PLAYING);\n      } else {\n        // Return to menu\n        this.stateManager.changeState(GameStateType.MENU);\n      }\n    } else if (!confirmPressed) {\n      this.keyPressed = false;\n    }\n  }\n  \n  /**\n   * Set the final score\n   * è®¾ç½®æœ€ç»ˆå¾—åˆ†\n   * @param score The final score\n   */\n  setFinalScore(score: number): void {\n    this.finalScore = score;\n  }\n  \n  /**\n   * Get the final score\n   * è·å–æœ€ç»ˆå¾—åˆ†\n   */\n  getFinalScore(): number {\n    return this.finalScore;\n  }\n  \n  /**\n   * Get the high score\n   * è·å–æœ€é«˜åˆ†\n   */\n  getHighScore(): number {\n    return this.highScore;\n  }\n  \n  /**\n   * Load high score from localStorage\n   * ä»localStorageåŠ è½½æœ€é«˜åˆ†\n   */\n  private loadHighScore(): void {\n    try {\n      const saved = localStorage.getItem('thunderFighter_highScore');\n      this.highScore = saved ? parseInt(saved, 10) : 0;\n    } catch (e) {\n      console.warn('Could not load high score from localStorage:', e);\n      this.highScore = 0;\n    }\n  }\n  \n  /**\n   * Save high score to localStorage\n   * ä¿å­˜æœ€é«˜åˆ†åˆ°localStorage\n   */\n  private saveHighScore(): void {\n    try {\n      localStorage.setItem('thunderFighter_highScore', this.highScore.toString());\n    } catch (e) {\n      console.warn('Could not save high score to localStorage:', e);\n    }\n  }\n}\n","/**\n * CollisionSystem Class\n * ç¢°æ’æ£€æµ‹ç³»ç»Ÿç±»\n * \n * Handles all collision detection between game entities.\n * å¤„ç†æ‰€æœ‰æ¸¸æˆå®ä½“ä¹‹é—´çš„ç¢°æ’æ£€æµ‹ã€‚\n */\nimport { Rectangle } from '../types/Rectangle';\nimport { Collidable } from '../interfaces/Collidable';\nimport { PlayerAircraft } from '../entities/PlayerAircraft';\nimport { EnemyAircraft } from '../entities/EnemyAircraft';\nimport { Bullet } from '../entities/Bullet';\nimport { PowerUp } from '../entities/PowerUp';\nimport { BulletOwner } from '../types/enums';\n\n/**\n * Collision Event Interface\n * ç¢°æ’äº‹ä»¶æ¥å£\n */\nexport interface CollisionEvent {\n  /** First entity in collision */\n  entityA: Collidable;\n  /** Second entity in collision */\n  entityB: Collidable;\n  /** Type of collision */\n  type: CollisionEventType;\n}\n\n/**\n * Collision Event Types\n * ç¢°æ’äº‹ä»¶ç±»å‹\n */\nexport enum CollisionEventType {\n  /** Player bullet hit enemy */\n  PLAYER_BULLET_ENEMY = 'playerBulletEnemy',\n  /** Enemy bullet hit player */\n  ENEMY_BULLET_PLAYER = 'enemyBulletPlayer',\n  /** Player collided with enemy */\n  PLAYER_ENEMY = 'playerEnemy',\n  /** Player collected power-up */\n  PLAYER_POWERUP = 'playerPowerUp'\n}\n\n/**\n * Collision callback type\n */\nexport type CollisionCallback = (event: CollisionEvent) => void;\n\n/**\n * CollisionSystem Class\n * ç¢°æ’æ£€æµ‹ç³»ç»Ÿ\n */\nexport class CollisionSystem {\n  private callbacks: Map<CollisionEventType, CollisionCallback[]> = new Map();\n\n  constructor() {\n    // Initialize callback arrays for each event type\n    Object.values(CollisionEventType).forEach(type => {\n      this.callbacks.set(type, []);\n    });\n  }\n\n  /**\n   * Check AABB collision between two rectangles\n   * æ£€æŸ¥ä¸¤ä¸ªçŸ©å½¢ä¹‹é—´çš„AABBç¢°æ’\n   * @param a First rectangle\n   * @param b Second rectangle\n   * @returns true if collision detected\n   */\n  checkCollision(a: Rectangle, b: Rectangle): boolean {\n    return (\n      a.x < b.x + b.width &&\n      a.x + a.width > b.x &&\n      a.y < b.y + b.height &&\n      a.y + a.height > b.y\n    );\n  }\n\n  /**\n   * Check collisions between player bullets and enemies\n   * æ£€æŸ¥ç©å®¶å­å¼¹ä¸æ•Œæœºä¹‹é—´çš„ç¢°æ’\n   * @param bullets Array of bullets\n   * @param enemies Array of enemies\n   * @returns Array of collision events\n   */\n  checkPlayerBulletCollisions(\n    bullets: Bullet[],\n    enemies: EnemyAircraft[]\n  ): CollisionEvent[] {\n    const events: CollisionEvent[] = [];\n\n    // Filter to only player bullets\n    const playerBullets = bullets.filter(\n      b => b.active && b.owner === BulletOwner.PLAYER\n    );\n\n    for (const bullet of playerBullets) {\n      for (const enemy of enemies) {\n        if (!enemy.active) continue;\n\n        if (this.checkCollision(bullet.collisionBox, enemy.collisionBox)) {\n          events.push({\n            entityA: bullet,\n            entityB: enemy,\n            type: CollisionEventType.PLAYER_BULLET_ENEMY\n          });\n        }\n      }\n    }\n\n    return events;\n  }\n\n  /**\n   * Check collisions between enemy bullets and player\n   * æ£€æŸ¥æ•Œæœºå­å¼¹ä¸ç©å®¶ä¹‹é—´çš„ç¢°æ’\n   * @param bullets Array of bullets\n   * @param player Player aircraft\n   * @returns Array of collision events\n   */\n  checkEnemyBulletCollisions(\n    bullets: Bullet[],\n    player: PlayerAircraft\n  ): CollisionEvent[] {\n    const events: CollisionEvent[] = [];\n\n    if (!player.active) return events;\n\n    // Filter to only enemy bullets\n    const enemyBullets = bullets.filter(\n      b => b.active && b.owner === BulletOwner.ENEMY\n    );\n\n    for (const bullet of enemyBullets) {\n      if (this.checkCollision(bullet.collisionBox, player.collisionBox)) {\n        events.push({\n          entityA: bullet,\n          entityB: player,\n          type: CollisionEventType.ENEMY_BULLET_PLAYER\n        });\n      }\n    }\n\n    return events;\n  }\n\n  /**\n   * Check collisions between player and enemies\n   * æ£€æŸ¥ç©å®¶ä¸æ•Œæœºä¹‹é—´çš„ç¢°æ’\n   * @param player Player aircraft\n   * @param enemies Array of enemies\n   * @returns Array of collision events\n   */\n  checkPlayerEnemyCollisions(\n    player: PlayerAircraft,\n    enemies: EnemyAircraft[]\n  ): CollisionEvent[] {\n    const events: CollisionEvent[] = [];\n\n    if (!player.active) return events;\n\n    for (const enemy of enemies) {\n      if (!enemy.active) continue;\n\n      if (this.checkCollision(player.collisionBox, enemy.collisionBox)) {\n        events.push({\n          entityA: player,\n          entityB: enemy,\n          type: CollisionEventType.PLAYER_ENEMY\n        });\n      }\n    }\n\n    return events;\n  }\n\n  /**\n   * Check collisions between player and power-ups\n   * æ£€æŸ¥ç©å®¶ä¸é“å…·ä¹‹é—´çš„ç¢°æ’\n   * @param player Player aircraft\n   * @param powerUps Array of power-ups\n   * @returns Array of collision events\n   */\n  checkPlayerPowerUpCollisions(\n    player: PlayerAircraft,\n    powerUps: PowerUp[]\n  ): CollisionEvent[] {\n    const events: CollisionEvent[] = [];\n\n    if (!player.active) return events;\n\n    for (const powerUp of powerUps) {\n      if (!powerUp.active) continue;\n\n      if (this.checkCollision(player.collisionBox, powerUp.collisionBox)) {\n        events.push({\n          entityA: player,\n          entityB: powerUp,\n          type: CollisionEventType.PLAYER_POWERUP\n        });\n      }\n    }\n\n    return events;\n  }\n\n  /**\n   * Check all collisions in the game\n   * æ£€æŸ¥æ¸¸æˆä¸­çš„æ‰€æœ‰ç¢°æ’\n   * @param player Player aircraft\n   * @param enemies Array of enemies\n   * @param bullets Array of bullets\n   * @param powerUps Array of power-ups\n   * @returns Array of all collision events\n   */\n  checkAllCollisions(\n    player: PlayerAircraft,\n    enemies: EnemyAircraft[],\n    bullets: Bullet[],\n    powerUps: PowerUp[]\n  ): CollisionEvent[] {\n    const events: CollisionEvent[] = [];\n\n    // Check player bullets vs enemies\n    events.push(...this.checkPlayerBulletCollisions(bullets, enemies));\n\n    // Check enemy bullets vs player\n    events.push(...this.checkEnemyBulletCollisions(bullets, player));\n\n    // Check player vs enemies\n    events.push(...this.checkPlayerEnemyCollisions(player, enemies));\n\n    // Check player vs power-ups\n    events.push(...this.checkPlayerPowerUpCollisions(player, powerUps));\n\n    return events;\n  }\n\n  /**\n   * Register a callback for a collision event type\n   * ä¸ºç¢°æ’äº‹ä»¶ç±»å‹æ³¨å†Œå›è°ƒ\n   * @param type Collision event type\n   * @param callback Callback function\n   */\n  onCollision(type: CollisionEventType, callback: CollisionCallback): void {\n    const callbacks = this.callbacks.get(type);\n    if (callbacks) {\n      callbacks.push(callback);\n    }\n  }\n\n  /**\n   * Remove a callback for a collision event type\n   * ç§»é™¤ç¢°æ’äº‹ä»¶ç±»å‹çš„å›è°ƒ\n   * @param type Collision event type\n   * @param callback Callback function to remove\n   */\n  offCollision(type: CollisionEventType, callback: CollisionCallback): void {\n    const callbacks = this.callbacks.get(type);\n    if (callbacks) {\n      const index = callbacks.indexOf(callback);\n      if (index !== -1) {\n        callbacks.splice(index, 1);\n      }\n    }\n  }\n\n  /**\n   * Process collision events and trigger callbacks\n   * å¤„ç†ç¢°æ’äº‹ä»¶å¹¶è§¦å‘å›è°ƒ\n   * @param events Array of collision events\n   */\n  processCollisions(events: CollisionEvent[]): void {\n    for (const event of events) {\n      // Trigger entity collision handlers\n      event.entityA.onCollision(event.entityB);\n      event.entityB.onCollision(event.entityA);\n\n      // Trigger registered callbacks\n      const callbacks = this.callbacks.get(event.type);\n      if (callbacks) {\n        for (const callback of callbacks) {\n          callback(event);\n        }\n      }\n    }\n  }\n\n  /**\n   * Update collision system - check and process all collisions\n   * æ›´æ–°ç¢°æ’ç³»ç»Ÿ - æ£€æŸ¥å¹¶å¤„ç†æ‰€æœ‰ç¢°æ’\n   * @param player Player aircraft\n   * @param enemies Array of enemies\n   * @param bullets Array of bullets\n   * @param powerUps Array of power-ups\n   */\n  update(\n    player: PlayerAircraft,\n    enemies: EnemyAircraft[],\n    bullets: Bullet[],\n    powerUps: PowerUp[]\n  ): void {\n    const events = this.checkAllCollisions(player, enemies, bullets, powerUps);\n    this.processCollisions(events);\n  }\n\n  /**\n   * Clear all registered callbacks\n   * æ¸…é™¤æ‰€æœ‰æ³¨å†Œçš„å›è°ƒ\n   */\n  clearCallbacks(): void {\n    Object.values(CollisionEventType).forEach(type => {\n      this.callbacks.set(type, []);\n    });\n  }\n}\n","/**\n * Bullet Class\n * å­å¼¹ç±»\n * \n * Represents bullets fired by player or enemies.\n * è¡¨ç¤ºç©å®¶æˆ–æ•Œæœºå‘å°„çš„å­å¼¹ã€‚\n */\nimport { Collidable } from '../interfaces/Collidable';\nimport { Movable } from '../interfaces/Movable';\nimport { Rectangle } from '../types/Rectangle';\nimport { CollisionType, BulletOwner } from '../types/enums';\nimport { DEFAULT_GAME_CONFIG, GameConfig } from '../types/GameConfig';\n\nexport class Bullet implements Collidable, Movable {\n  // GameObject properties\n  id: string;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  active: boolean;\n\n  // Movable properties\n  velocityX: number;\n  velocityY: number;\n  speed: number;\n\n  // Collidable properties\n  collisionBox: Rectangle;\n  collisionType: CollisionType;\n\n  // Bullet-specific properties\n  owner: BulletOwner;\n  damage: number;\n\n  // Canvas bounds for boundary checking\n  private canvasWidth: number;\n  private canvasHeight: number;\n\n  /**\n   * Create a new bullet\n   * @param x Initial X position\n   * @param y Initial Y position\n   * @param owner Who fired the bullet (PLAYER or ENEMY)\n   * @param velocityY Y velocity (negative for player bullets going up, positive for enemy bullets going down)\n   * @param config Game configuration\n   */\n  constructor(\n    x: number,\n    y: number,\n    owner: BulletOwner,\n    velocityY: number,\n    config: GameConfig = DEFAULT_GAME_CONFIG\n  ) {\n    this.id = `bullet_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    this.owner = owner;\n    this.x = x;\n    this.y = y;\n    this.active = true;\n\n    // Set properties based on owner\n    const bulletConfig = owner === BulletOwner.PLAYER \n      ? config.bullet.player \n      : config.bullet.enemy;\n\n    this.width = bulletConfig.width;\n    this.height = bulletConfig.height;\n    this.speed = bulletConfig.speed;\n    this.damage = bulletConfig.damage;\n\n    // Movable initialization\n    this.velocityX = 0;\n    this.velocityY = velocityY;\n\n    // Collidable initialization\n    this.collisionBox = { x: this.x, y: this.y, width: this.width, height: this.height };\n    this.collisionType = owner === BulletOwner.PLAYER \n      ? CollisionType.PLAYER_BULLET \n      : CollisionType.ENEMY_BULLET;\n\n    // Canvas bounds\n    this.canvasWidth = config.canvas.width;\n    this.canvasHeight = config.canvas.height;\n  }\n\n  /**\n   * Update the bullet state\n   * @param deltaTime Time elapsed since last frame in seconds\n   */\n  update(deltaTime: number): void {\n    if (!this.active) return;\n\n    // Move the bullet\n    this.move(deltaTime);\n\n    // Check if bullet is out of bounds\n    this.checkBounds();\n\n    // Update collision box position\n    this.collisionBox.x = this.x;\n    this.collisionBox.y = this.y;\n  }\n\n  /**\n   * Move the bullet based on velocity\n   * @param deltaTime Time elapsed since last frame in seconds\n   */\n  move(deltaTime: number): void {\n    this.x += this.velocityX * deltaTime;\n    this.y += this.velocityY * deltaTime;\n  }\n\n  /**\n   * Set the velocity of the bullet\n   * @param vx Velocity in X direction\n   * @param vy Velocity in Y direction\n   */\n  setVelocity(vx: number, vy: number): void {\n    this.velocityX = vx;\n    this.velocityY = vy;\n  }\n\n  /**\n   * Check if bullet is out of canvas bounds and deactivate if so\n   */\n  private checkBounds(): void {\n    // Check if completely out of bounds\n    if (\n      this.y + this.height < 0 || // Above screen\n      this.y > this.canvasHeight || // Below screen\n      this.x + this.width < 0 || // Left of screen\n      this.x > this.canvasWidth // Right of screen\n    ) {\n      this.active = false;\n    }\n  }\n\n  /**\n   * Handle collision with another object\n   * @param other The other collidable object\n   */\n  onCollision(other: Collidable): void {\n    // Deactivate bullet on collision with valid target\n    if (this.owner === BulletOwner.PLAYER) {\n      if (other.collisionType === CollisionType.ENEMY) {\n        this.active = false;\n      }\n    } else {\n      if (other.collisionType === CollisionType.PLAYER) {\n        this.active = false;\n      }\n    }\n  }\n\n  /**\n   * Check collision with another object using AABB\n   * @param other The other collidable object\n   * @returns true if collision detected\n   */\n  checkCollision(other: Collidable): boolean {\n    const a = this.collisionBox;\n    const b = other.collisionBox;\n\n    return (\n      a.x < b.x + b.width &&\n      a.x + a.width > b.x &&\n      a.y < b.y + b.height &&\n      a.y + a.height > b.y\n    );\n  }\n\n  /**\n   * Render the bullet\n   * @param context The 2D rendering context\n   */\n  render(context: CanvasRenderingContext2D): void {\n    if (!this.active) return;\n\n    context.save();\n\n    // Different colors for player and enemy bullets\n    if (this.owner === BulletOwner.PLAYER) {\n      // Player bullet - yellow/gold\n      context.fillStyle = '#FFD700';\n      \n      // Draw as elongated rectangle with rounded ends\n      context.beginPath();\n      context.roundRect(this.x, this.y, this.width, this.height, 2);\n      context.fill();\n      \n      // Add glow effect\n      context.shadowColor = '#FFD700';\n      context.shadowBlur = 5;\n      context.fill();\n    } else {\n      // Enemy bullet - red\n      context.fillStyle = '#FF4444';\n      \n      // Draw as circle/oval\n      context.beginPath();\n      context.ellipse(\n        this.x + this.width / 2,\n        this.y + this.height / 2,\n        this.width / 2,\n        this.height / 2,\n        0,\n        0,\n        Math.PI * 2\n      );\n      context.fill();\n      \n      // Add glow effect\n      context.shadowColor = '#FF4444';\n      context.shadowBlur = 5;\n      context.fill();\n    }\n\n    context.restore();\n  }\n\n  /**\n   * Clean up and mark the bullet for removal\n   */\n  destroy(): void {\n    this.active = false;\n  }\n}\n","/**\n * EnemyAircraft Class\n * æ•Œæœºç±»\n * \n * Enemy aircraft with different types and movement patterns.\n * å…·æœ‰ä¸åŒç±»å‹å’Œç§»åŠ¨æ¨¡å¼çš„æ•Œæœºã€‚\n */\nimport { Collidable } from '../interfaces/Collidable';\nimport { Movable } from '../interfaces/Movable';\nimport { Rectangle } from '../types/Rectangle';\nimport { CollisionType, EnemyType, BulletOwner, MovementPattern } from '../types/enums';\nimport { DEFAULT_GAME_CONFIG, GameConfig, EnemyConfig } from '../types/GameConfig';\nimport { Bullet } from './Bullet';\n\nexport class EnemyAircraft implements Collidable, Movable {\n  // GameObject properties\n  id: string;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  active: boolean;\n\n  // Movable properties\n  velocityX: number;\n  velocityY: number;\n  speed: number;\n\n  // Collidable properties\n  collisionBox: Rectangle;\n  collisionType: CollisionType;\n\n  // Enemy-specific properties\n  type: EnemyType;\n  health: number;\n  maxHealth: number;\n  scoreValue: number;\n  fireRate: number;\n  lastFireTime: number;\n  movementPattern: MovementPattern;\n\n  // Movement pattern state\n  private initialX: number;\n  private zigzagAmplitude: number = 50;\n  private zigzagFrequency: number = 2;\n  private elapsedTime: number = 0;\n  private bossPhase: number = 0;\n  private bossPhaseTime: number = 0;\n\n  // Canvas bounds\n  private canvasWidth: number;\n  private canvasHeight: number;\n  private config: GameConfig;\n\n  /**\n   * Create a new enemy aircraft\n   * @param x Initial X position\n   * @param y Initial Y position\n   * @param type Enemy type\n   * @param config Game configuration\n   */\n  constructor(\n    x: number,\n    y: number,\n    type: EnemyType,\n    config: GameConfig = DEFAULT_GAME_CONFIG\n  ) {\n    this.id = `enemy_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    this.type = type;\n    this.x = x;\n    this.y = y;\n    this.initialX = x;\n    this.active = true;\n    this.config = config;\n\n    // Get enemy config based on type\n    const enemyConfig = this.getEnemyConfig(type, config);\n\n    this.width = enemyConfig.width;\n    this.height = enemyConfig.height;\n    this.speed = enemyConfig.speed;\n    this.health = enemyConfig.health;\n    this.maxHealth = enemyConfig.health;\n    this.scoreValue = enemyConfig.scoreValue;\n    this.fireRate = enemyConfig.fireRate || 0;\n    this.lastFireTime = 0;\n\n    // Set movement pattern based on type\n    this.movementPattern = this.getMovementPattern(type);\n\n    // Movable initialization\n    this.velocityX = 0;\n    this.velocityY = this.speed;\n\n    // Collidable initialization\n    this.collisionBox = { x: this.x, y: this.y, width: this.width, height: this.height };\n    this.collisionType = CollisionType.ENEMY;\n\n    // Canvas bounds\n    this.canvasWidth = config.canvas.width;\n    this.canvasHeight = config.canvas.height;\n  }\n\n  /**\n   * Get enemy configuration based on type\n   */\n  private getEnemyConfig(type: EnemyType, config: GameConfig): EnemyConfig {\n    switch (type) {\n      case EnemyType.BASIC:\n        return config.enemy.basic;\n      case EnemyType.SHOOTER:\n        return config.enemy.shooter;\n      case EnemyType.ZIGZAG:\n        return config.enemy.zigzag;\n      case EnemyType.BOSS:\n        return config.enemy.boss;\n      default:\n        return config.enemy.basic;\n    }\n  }\n\n  /**\n   * Get movement pattern based on enemy type\n   */\n  private getMovementPattern(type: EnemyType): MovementPattern {\n    switch (type) {\n      case EnemyType.BASIC:\n      case EnemyType.SHOOTER:\n        return MovementPattern.STRAIGHT;\n      case EnemyType.ZIGZAG:\n        return MovementPattern.ZIGZAG;\n      case EnemyType.BOSS:\n        return MovementPattern.SINE;\n      default:\n        return MovementPattern.STRAIGHT;\n    }\n  }\n\n  /**\n   * Update the enemy aircraft state\n   * @param deltaTime Time elapsed since last frame in seconds\n   */\n  update(deltaTime: number): void {\n    if (!this.active) return;\n\n    this.elapsedTime += deltaTime;\n\n    // Move based on movement pattern\n    this.move(deltaTime);\n\n    // Check if enemy is out of bounds (below screen)\n    if (this.y > this.canvasHeight) {\n      this.active = false;\n    }\n\n    // Update collision box position\n    this.collisionBox.x = this.x;\n    this.collisionBox.y = this.y;\n  }\n\n  /**\n   * Move the enemy based on movement pattern\n   * @param deltaTime Time elapsed since last frame in seconds\n   */\n  move(deltaTime: number): void {\n    switch (this.movementPattern) {\n      case MovementPattern.STRAIGHT:\n        this.moveStraight(deltaTime);\n        break;\n      case MovementPattern.ZIGZAG:\n        this.moveZigzag(deltaTime);\n        break;\n      case MovementPattern.SINE:\n        this.moveBoss(deltaTime);\n        break;\n      default:\n        this.moveStraight(deltaTime);\n    }\n  }\n\n  /**\n   * Straight down movement (BASIC and SHOOTER enemies)\n   */\n  private moveStraight(deltaTime: number): void {\n    this.y += this.speed * deltaTime;\n  }\n\n  /**\n   * Zigzag movement pattern (ZIGZAG enemies)\n   */\n  private moveZigzag(deltaTime: number): void {\n    // Move down\n    this.y += this.speed * deltaTime;\n\n    // Calculate horizontal oscillation\n    const newX = this.initialX + Math.sin(this.elapsedTime * this.zigzagFrequency * Math.PI) * this.zigzagAmplitude;\n    \n    // Clamp to canvas bounds\n    this.x = Math.max(0, Math.min(newX, this.canvasWidth - this.width));\n  }\n\n  /**\n   * Boss movement pattern (complex sine wave with phases)\n   */\n  private moveBoss(deltaTime: number): void {\n    this.bossPhaseTime += deltaTime;\n\n    switch (this.bossPhase) {\n      case 0:\n        // Phase 0: Move down to position\n        if (this.y < 50) {\n          this.y += this.speed * deltaTime;\n        } else {\n          this.bossPhase = 1;\n          this.bossPhaseTime = 0;\n        }\n        break;\n\n      case 1:\n        // Phase 1: Horizontal sine wave movement\n        this.x = this.canvasWidth / 2 - this.width / 2 + \n                 Math.sin(this.bossPhaseTime * 0.5 * Math.PI) * (this.canvasWidth / 3);\n        \n        // Clamp to canvas bounds\n        this.x = Math.max(0, Math.min(this.x, this.canvasWidth - this.width));\n\n        // Switch phase periodically\n        if (this.bossPhaseTime > 8) {\n          this.bossPhase = 2;\n          this.bossPhaseTime = 0;\n        }\n        break;\n\n      case 2:\n        // Phase 2: Move down slightly then back up\n        const verticalOffset = Math.sin(this.bossPhaseTime * Math.PI) * 30;\n        this.y = 50 + verticalOffset;\n\n        // Continue horizontal movement\n        this.x = this.canvasWidth / 2 - this.width / 2 + \n                 Math.sin(this.bossPhaseTime * Math.PI) * (this.canvasWidth / 4);\n        \n        this.x = Math.max(0, Math.min(this.x, this.canvasWidth - this.width));\n\n        if (this.bossPhaseTime > 4) {\n          this.bossPhase = 1;\n          this.bossPhaseTime = 0;\n        }\n        break;\n    }\n  }\n\n  /**\n   * Set the velocity of the enemy\n   * @param vx Velocity in X direction\n   * @param vy Velocity in Y direction\n   */\n  setVelocity(vx: number, vy: number): void {\n    this.velocityX = vx;\n    this.velocityY = vy;\n  }\n\n  /**\n   * Fire a bullet (for SHOOTER and BOSS enemies)\n   * @param currentTime Current game time in milliseconds\n   * @returns Bullet if fired, null otherwise\n   */\n  fire(currentTime: number): Bullet | null {\n    // Only SHOOTER and BOSS enemies can fire\n    if (this.type !== EnemyType.SHOOTER && this.type !== EnemyType.BOSS) {\n      return null;\n    }\n\n    // Check fire rate limit\n    if (this.fireRate <= 0 || currentTime - this.lastFireTime < this.fireRate) {\n      return null;\n    }\n\n    this.lastFireTime = currentTime;\n\n    // Create bullet at bottom center of enemy\n    const bulletConfig = this.config.bullet.enemy;\n    const bulletX = this.x + this.width / 2 - bulletConfig.width / 2;\n    const bulletY = this.y + this.height;\n\n    return new Bullet(\n      bulletX,\n      bulletY,\n      BulletOwner.ENEMY,\n      bulletConfig.speed, // Positive Y velocity (moving down)\n      this.config\n    );\n  }\n\n  /**\n   * Fire multiple bullets (for BOSS enemy)\n   * @param currentTime Current game time in milliseconds\n   * @returns Array of bullets fired\n   */\n  fireBoss(currentTime: number): Bullet[] {\n    if (this.type !== EnemyType.BOSS) {\n      return [];\n    }\n\n    // Check fire rate limit\n    if (this.fireRate <= 0 || currentTime - this.lastFireTime < this.fireRate) {\n      return [];\n    }\n\n    this.lastFireTime = currentTime;\n    const bullets: Bullet[] = [];\n    const bulletConfig = this.config.bullet.enemy;\n\n    // Fire 3 bullets in a spread pattern\n    const centerX = this.x + this.width / 2;\n    const bulletY = this.y + this.height;\n    const spread = 30;\n\n    for (let i = -1; i <= 1; i++) {\n      const bullet = new Bullet(\n        centerX - bulletConfig.width / 2 + i * spread,\n        bulletY,\n        BulletOwner.ENEMY,\n        bulletConfig.speed,\n        this.config\n      );\n      bullets.push(bullet);\n    }\n\n    return bullets;\n  }\n\n  /**\n   * Apply damage to the enemy\n   * @param damage Amount of damage to apply\n   */\n  takeDamage(damage: number): void {\n    this.health -= damage;\n\n    if (this.health <= 0) {\n      this.health = 0;\n      this.active = false;\n    }\n  }\n\n  /**\n   * Handle collision with another object\n   * @param other The other collidable object\n   */\n  onCollision(other: Collidable): void {\n    switch (other.collisionType) {\n      case CollisionType.PLAYER_BULLET:\n        // Damage is handled by collision system\n        break;\n      case CollisionType.PLAYER:\n        // Collision with player - enemy is destroyed\n        this.active = false;\n        break;\n    }\n  }\n\n  /**\n   * Check collision with another object using AABB\n   * @param other The other collidable object\n   * @returns true if collision detected\n   */\n  checkCollision(other: Collidable): boolean {\n    const a = this.collisionBox;\n    const b = other.collisionBox;\n\n    return (\n      a.x < b.x + b.width &&\n      a.x + a.width > b.x &&\n      a.y < b.y + b.height &&\n      a.y + a.height > b.y\n    );\n  }\n\n  /**\n   * Render the enemy aircraft\n   * @param context The 2D rendering context\n   */\n  render(context: CanvasRenderingContext2D): void {\n    if (!this.active) return;\n\n    context.save();\n\n    // Different colors and shapes for different enemy types\n    switch (this.type) {\n      case EnemyType.BASIC:\n        this.renderBasic(context);\n        break;\n      case EnemyType.SHOOTER:\n        this.renderShooter(context);\n        break;\n      case EnemyType.ZIGZAG:\n        this.renderZigzag(context);\n        break;\n      case EnemyType.BOSS:\n        this.renderBoss(context);\n        break;\n    }\n\n    context.restore();\n  }\n\n  /**\n   * Render basic enemy (simple red triangle)\n   */\n  private renderBasic(context: CanvasRenderingContext2D): void {\n    context.fillStyle = '#FF6B6B';\n    context.beginPath();\n    context.moveTo(this.x + this.width / 2, this.y + this.height); // Bottom center\n    context.lineTo(this.x, this.y); // Top left\n    context.lineTo(this.x + this.width, this.y); // Top right\n    context.closePath();\n    context.fill();\n  }\n\n  /**\n   * Render shooter enemy (orange diamond)\n   */\n  private renderShooter(context: CanvasRenderingContext2D): void {\n    context.fillStyle = '#FFA500';\n    context.beginPath();\n    context.moveTo(this.x + this.width / 2, this.y); // Top\n    context.lineTo(this.x + this.width, this.y + this.height / 2); // Right\n    context.lineTo(this.x + this.width / 2, this.y + this.height); // Bottom\n    context.lineTo(this.x, this.y + this.height / 2); // Left\n    context.closePath();\n    context.fill();\n\n    // Draw cannon indicator\n    context.fillStyle = '#FF4500';\n    context.fillRect(\n      this.x + this.width / 2 - 3,\n      this.y + this.height - 5,\n      6,\n      8\n    );\n  }\n\n  /**\n   * Render zigzag enemy (purple hexagon-like shape)\n   */\n  private renderZigzag(context: CanvasRenderingContext2D): void {\n    context.fillStyle = '#9B59B6';\n    context.beginPath();\n    context.moveTo(this.x + this.width * 0.3, this.y);\n    context.lineTo(this.x + this.width * 0.7, this.y);\n    context.lineTo(this.x + this.width, this.y + this.height * 0.4);\n    context.lineTo(this.x + this.width * 0.8, this.y + this.height);\n    context.lineTo(this.x + this.width * 0.2, this.y + this.height);\n    context.lineTo(this.x, this.y + this.height * 0.4);\n    context.closePath();\n    context.fill();\n  }\n\n  /**\n   * Render boss enemy (large red/black ship)\n   */\n  private renderBoss(context: CanvasRenderingContext2D): void {\n    // Main body\n    context.fillStyle = '#8B0000';\n    context.beginPath();\n    context.moveTo(this.x + this.width / 2, this.y + this.height); // Bottom center\n    context.lineTo(this.x, this.y + this.height * 0.3); // Left wing\n    context.lineTo(this.x + this.width * 0.2, this.y); // Top left\n    context.lineTo(this.x + this.width * 0.8, this.y); // Top right\n    context.lineTo(this.x + this.width, this.y + this.height * 0.3); // Right wing\n    context.closePath();\n    context.fill();\n\n    // Cockpit\n    context.fillStyle = '#FF0000';\n    context.beginPath();\n    context.arc(\n      this.x + this.width / 2,\n      this.y + this.height * 0.4,\n      this.width * 0.15,\n      0,\n      Math.PI * 2\n    );\n    context.fill();\n\n    // Health bar\n    const healthBarWidth = this.width * 0.8;\n    const healthBarHeight = 6;\n    const healthBarX = this.x + (this.width - healthBarWidth) / 2;\n    const healthBarY = this.y - 15;\n\n    // Background\n    context.fillStyle = '#333';\n    context.fillRect(healthBarX, healthBarY, healthBarWidth, healthBarHeight);\n\n    // Health\n    const healthPercent = this.health / this.maxHealth;\n    context.fillStyle = healthPercent > 0.3 ? '#00FF00' : '#FF0000';\n    context.fillRect(healthBarX, healthBarY, healthBarWidth * healthPercent, healthBarHeight);\n  }\n\n  /**\n   * Clean up and mark the enemy for removal\n   */\n  destroy(): void {\n    this.active = false;\n  }\n}\n","/**\n * PowerUp Class\n * é“å…·ç±»\n * \n * Collectible power-up items that enhance player abilities.\n * å¯æ”¶é›†çš„é“å…·ï¼Œç”¨äºå¢å¼ºç©å®¶èƒ½åŠ›ã€‚\n */\nimport { Collidable } from '../interfaces/Collidable';\nimport { Movable } from '../interfaces/Movable';\nimport { Rectangle } from '../types/Rectangle';\nimport { CollisionType, PowerUpType } from '../types/enums';\nimport { DEFAULT_GAME_CONFIG, GameConfig } from '../types/GameConfig';\nimport { PlayerAircraft } from './PlayerAircraft';\n\nexport class PowerUp implements Collidable, Movable {\n  // GameObject properties\n  id: string;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  active: boolean;\n\n  // Movable properties\n  velocityX: number;\n  velocityY: number;\n  speed: number;\n\n  // Collidable properties\n  collisionBox: Rectangle;\n  collisionType: CollisionType;\n\n  // PowerUp-specific properties\n  type: PowerUpType;\n\n  // Animation state\n  private animationTime: number = 0;\n  private pulseScale: number = 1;\n\n  // Canvas bounds\n  private canvasHeight: number;\n  private config: GameConfig;\n\n  // Power-up dimensions\n  static readonly POWERUP_SIZE = 24;\n\n  /**\n   * Create a new power-up\n   * @param x Initial X position\n   * @param y Initial Y position\n   * @param type Power-up type\n   * @param config Game configuration\n   */\n  constructor(\n    x: number,\n    y: number,\n    type: PowerUpType,\n    config: GameConfig = DEFAULT_GAME_CONFIG\n  ) {\n    this.id = `powerup_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    this.type = type;\n    this.x = x;\n    this.y = y;\n    this.active = true;\n    this.config = config;\n\n    this.width = PowerUp.POWERUP_SIZE;\n    this.height = PowerUp.POWERUP_SIZE;\n    this.speed = config.powerUp.fallSpeed;\n\n    // Movable initialization\n    this.velocityX = 0;\n    this.velocityY = this.speed;\n\n    // Collidable initialization\n    this.collisionBox = { x: this.x, y: this.y, width: this.width, height: this.height };\n    this.collisionType = CollisionType.POWER_UP;\n\n    // Canvas bounds\n    this.canvasHeight = config.canvas.height;\n  }\n\n  /**\n   * Update the power-up state\n   * @param deltaTime Time elapsed since last frame in seconds\n   */\n  update(deltaTime: number): void {\n    if (!this.active) return;\n\n    // Update animation\n    this.animationTime += deltaTime;\n    this.pulseScale = 1 + Math.sin(this.animationTime * 4) * 0.1;\n\n    // Move the power-up\n    this.move(deltaTime);\n\n    // Check if power-up is out of bounds (below screen)\n    if (this.y > this.canvasHeight) {\n      this.active = false;\n    }\n\n    // Update collision box position\n    this.collisionBox.x = this.x;\n    this.collisionBox.y = this.y;\n  }\n\n  /**\n   * Move the power-up (falls down)\n   * @param deltaTime Time elapsed since last frame in seconds\n   */\n  move(deltaTime: number): void {\n    this.y += this.velocityY * deltaTime;\n  }\n\n  /**\n   * Set the velocity of the power-up\n   * @param vx Velocity in X direction\n   * @param vy Velocity in Y direction\n   */\n  setVelocity(vx: number, vy: number): void {\n    this.velocityX = vx;\n    this.velocityY = vy;\n  }\n\n  /**\n   * Apply the power-up effect to the player\n   * @param player The player aircraft to apply the effect to\n   */\n  apply(player: PlayerAircraft): void {\n    switch (this.type) {\n      case PowerUpType.WEAPON_UPGRADE:\n        player.upgradeWeapon();\n        break;\n\n      case PowerUpType.HEALTH:\n        player.heal(1);\n        break;\n\n      case PowerUpType.SHIELD:\n        player.activateShield(this.config.player.invincibleDuration);\n        break;\n    }\n\n    // Deactivate power-up after collection\n    this.active = false;\n  }\n\n  /**\n   * Handle collision with another object\n   * @param other The other collidable object\n   */\n  onCollision(other: Collidable): void {\n    if (other.collisionType === CollisionType.PLAYER) {\n      // Effect is applied through the apply() method\n      this.active = false;\n    }\n  }\n\n  /**\n   * Check collision with another object using AABB\n   * @param other The other collidable object\n   * @returns true if collision detected\n   */\n  checkCollision(other: Collidable): boolean {\n    const a = this.collisionBox;\n    const b = other.collisionBox;\n\n    return (\n      a.x < b.x + b.width &&\n      a.x + a.width > b.x &&\n      a.y < b.y + b.height &&\n      a.y + a.height > b.y\n    );\n  }\n\n  /**\n   * Render the power-up\n   * @param context The 2D rendering context\n   */\n  render(context: CanvasRenderingContext2D): void {\n    if (!this.active) return;\n\n    context.save();\n\n    // Apply pulse animation\n    const centerX = this.x + this.width / 2;\n    const centerY = this.y + this.height / 2;\n    context.translate(centerX, centerY);\n    context.scale(this.pulseScale, this.pulseScale);\n    context.translate(-centerX, -centerY);\n\n    // Draw based on power-up type\n    switch (this.type) {\n      case PowerUpType.WEAPON_UPGRADE:\n        this.renderWeaponUpgrade(context);\n        break;\n\n      case PowerUpType.HEALTH:\n        this.renderHealth(context);\n        break;\n\n      case PowerUpType.SHIELD:\n        this.renderShield(context);\n        break;\n    }\n\n    context.restore();\n  }\n\n  /**\n   * Render weapon upgrade power-up (yellow star)\n   */\n  private renderWeaponUpgrade(context: CanvasRenderingContext2D): void {\n    const cx = this.x + this.width / 2;\n    const cy = this.y + this.height / 2;\n    const outerRadius = this.width / 2;\n    const innerRadius = this.width / 4;\n    const spikes = 5;\n\n    // Draw star\n    context.fillStyle = '#FFD700';\n    context.beginPath();\n\n    for (let i = 0; i < spikes * 2; i++) {\n      const radius = i % 2 === 0 ? outerRadius : innerRadius;\n      const angle = (i * Math.PI) / spikes - Math.PI / 2;\n      const x = cx + Math.cos(angle) * radius;\n      const y = cy + Math.sin(angle) * radius;\n\n      if (i === 0) {\n        context.moveTo(x, y);\n      } else {\n        context.lineTo(x, y);\n      }\n    }\n\n    context.closePath();\n    context.fill();\n\n    // Add glow\n    context.shadowColor = '#FFD700';\n    context.shadowBlur = 10;\n    context.fill();\n  }\n\n  /**\n   * Render health power-up (green cross/plus)\n   */\n  private renderHealth(context: CanvasRenderingContext2D): void {\n    const crossWidth = this.width * 0.3;\n    const crossLength = this.height * 0.8;\n\n    context.fillStyle = '#00FF00';\n\n    // Vertical bar\n    context.fillRect(\n      this.x + (this.width - crossWidth) / 2,\n      this.y + (this.height - crossLength) / 2,\n      crossWidth,\n      crossLength\n    );\n\n    // Horizontal bar\n    context.fillRect(\n      this.x + (this.width - crossLength) / 2,\n      this.y + (this.height - crossWidth) / 2,\n      crossLength,\n      crossWidth\n    );\n\n    // Add glow\n    context.shadowColor = '#00FF00';\n    context.shadowBlur = 10;\n    context.fillRect(\n      this.x + (this.width - crossWidth) / 2,\n      this.y + (this.height - crossLength) / 2,\n      crossWidth,\n      crossLength\n    );\n  }\n\n  /**\n   * Render shield power-up (blue circle with shield icon)\n   */\n  private renderShield(context: CanvasRenderingContext2D): void {\n    const cx = this.x + this.width / 2;\n    const cy = this.y + this.height / 2;\n    const radius = this.width / 2;\n\n    // Draw outer circle\n    context.fillStyle = '#4169E1';\n    context.beginPath();\n    context.arc(cx, cy, radius, 0, Math.PI * 2);\n    context.fill();\n\n    // Draw shield shape inside\n    context.fillStyle = '#87CEEB';\n    context.beginPath();\n    context.moveTo(cx, cy - radius * 0.6);\n    context.lineTo(cx + radius * 0.5, cy - radius * 0.3);\n    context.lineTo(cx + radius * 0.5, cy + radius * 0.2);\n    context.lineTo(cx, cy + radius * 0.6);\n    context.lineTo(cx - radius * 0.5, cy + radius * 0.2);\n    context.lineTo(cx - radius * 0.5, cy - radius * 0.3);\n    context.closePath();\n    context.fill();\n\n    // Add glow\n    context.shadowColor = '#4169E1';\n    context.shadowBlur = 10;\n    context.beginPath();\n    context.arc(cx, cy, radius, 0, Math.PI * 2);\n    context.fill();\n  }\n\n  /**\n   * Clean up and mark the power-up for removal\n   */\n  destroy(): void {\n    this.active = false;\n  }\n\n  /**\n   * Get a random power-up type\n   * @returns Random PowerUpType\n   */\n  static getRandomType(): PowerUpType {\n    const types = [PowerUpType.WEAPON_UPGRADE, PowerUpType.HEALTH, PowerUpType.SHIELD];\n    const weights = [0.4, 0.4, 0.2]; // 40% weapon, 40% health, 20% shield\n    \n    const random = Math.random();\n    let cumulative = 0;\n    \n    for (let i = 0; i < types.length; i++) {\n      cumulative += weights[i];\n      if (random < cumulative) {\n        return types[i];\n      }\n    }\n    \n    return types[0];\n  }\n}\n","/**\n * SpawnSystem Class\n * ç”Ÿæˆç³»ç»Ÿç±»\n * \n * Controls enemy and power-up spawning logic.\n * æ§åˆ¶æ•Œæœºå’Œé“å…·çš„ç”Ÿæˆé€»è¾‘ã€‚\n */\nimport { EnemyType, PowerUpType } from '../types/enums';\nimport { DEFAULT_GAME_CONFIG, GameConfig } from '../types/GameConfig';\nimport { EnemyAircraft } from '../entities/EnemyAircraft';\nimport { PowerUp } from '../entities/PowerUp';\nimport { EntityManager } from '../core/EntityManager';\n\n/**\n * Spawn Configuration Interface\n * ç”Ÿæˆé…ç½®æ¥å£\n */\nexport interface SpawnConfig {\n  /** Enemy spawn rate in milliseconds */\n  enemySpawnRate: number;\n  /** Difficulty increase interval in milliseconds */\n  difficultyIncreaseRate: number;\n  /** Power-up drop chance (0-1) */\n  powerUpDropChance: number;\n}\n\n/**\n * SpawnSystem Class\n * ç”Ÿæˆç³»ç»Ÿ\n */\nexport class SpawnSystem {\n  private config: SpawnConfig;\n  private gameConfig: GameConfig;\n  private lastSpawnTime: number = 0;\n  private gameTime: number = 0;\n  private currentDifficulty: number = 1;\n  private enemiesDestroyed: number = 0;\n  private bossActive: boolean = false;\n  private lastDifficultyIncrease: number = 0;\n\n  // Enemy type spawn probabilities\n  private readonly ENEMY_TYPE_WEIGHTS = {\n    [EnemyType.BASIC]: 0.60,    // 60%\n    [EnemyType.SHOOTER]: 0.25,  // 25%\n    [EnemyType.ZIGZAG]: 0.15    // 15%\n  };\n\n  /**\n   * Create a new spawn system\n   * @param config Spawn configuration (optional)\n   * @param gameConfig Game configuration (optional)\n   */\n  constructor(\n    config?: Partial<SpawnConfig>,\n    gameConfig: GameConfig = DEFAULT_GAME_CONFIG\n  ) {\n    this.gameConfig = gameConfig;\n    this.config = {\n      enemySpawnRate: config?.enemySpawnRate ?? gameConfig.spawn.initialRate,\n      difficultyIncreaseRate: config?.difficultyIncreaseRate ?? gameConfig.spawn.difficultyIncrease,\n      powerUpDropChance: config?.powerUpDropChance ?? gameConfig.powerUp.dropChance\n    };\n  }\n\n  /**\n   * Update the spawn system\n   * æ›´æ–°ç”Ÿæˆç³»ç»Ÿ\n   * @param deltaTime Time elapsed since last frame in seconds\n   * @param entityManager Entity manager to add spawned entities\n   * @param currentTime Current game time in milliseconds\n   */\n  update(deltaTime: number, entityManager: EntityManager, currentTime: number): void {\n    this.gameTime += deltaTime * 1000; // Convert to milliseconds\n\n    // Check for difficulty increase\n    this.updateDifficulty();\n\n    // Check if it's time to spawn an enemy\n    if (currentTime - this.lastSpawnTime >= this.calculateSpawnRate()) {\n      this.spawnEnemy(entityManager);\n      this.lastSpawnTime = currentTime;\n    }\n  }\n\n  /**\n   * Update difficulty based on game time\n   * æ ¹æ®æ¸¸æˆæ—¶é—´æ›´æ–°éš¾åº¦\n   */\n  private updateDifficulty(): void {\n    const difficultyIntervals = Math.floor(this.gameTime / this.config.difficultyIncreaseRate);\n    \n    if (difficultyIntervals > this.lastDifficultyIncrease) {\n      this.currentDifficulty = 1 + difficultyIntervals * 0.1; // 10% increase per interval\n      this.lastDifficultyIncrease = difficultyIntervals;\n    }\n  }\n\n  /**\n   * Calculate current spawn rate based on difficulty\n   * æ ¹æ®éš¾åº¦è®¡ç®—å½“å‰ç”Ÿæˆé¢‘ç‡\n   * @returns Spawn rate in milliseconds\n   */\n  calculateSpawnRate(): number {\n    // Decrease spawn rate (faster spawning) as difficulty increases\n    const baseRate = this.config.enemySpawnRate;\n    const minRate = this.gameConfig.spawn.minRate;\n    \n    // Reduce spawn rate by 10% for each difficulty level\n    const adjustedRate = baseRate / this.currentDifficulty;\n    \n    // Clamp to minimum rate\n    return Math.max(adjustedRate, minRate);\n  }\n\n  /**\n   * Spawn an enemy at the top of the screen\n   * åœ¨å±å¹•é¡¶éƒ¨ç”Ÿæˆæ•Œæœº\n   * @param entityManager Entity manager to add the enemy\n   */\n  spawnEnemy(entityManager: EntityManager): void {\n    // Don't spawn regular enemies if boss is active\n    if (this.bossActive) return;\n\n    const enemyType = this.selectEnemyType();\n    const enemyConfig = this.getEnemyConfigByType(enemyType);\n    \n    // Random X position within canvas bounds\n    const maxX = this.gameConfig.canvas.width - enemyConfig.width;\n    const x = Math.random() * maxX;\n    \n    // Spawn above the screen\n    const y = -enemyConfig.height;\n\n    const enemy = new EnemyAircraft(x, y, enemyType, this.gameConfig);\n    entityManager.addEntity(enemy);\n  }\n\n  /**\n   * Get enemy config by type\n   * æ ¹æ®ç±»å‹è·å–æ•Œæœºé…ç½®\n   */\n  private getEnemyConfigByType(type: EnemyType) {\n    switch (type) {\n      case EnemyType.BASIC:\n        return this.gameConfig.enemy.basic;\n      case EnemyType.SHOOTER:\n        return this.gameConfig.enemy.shooter;\n      case EnemyType.ZIGZAG:\n        return this.gameConfig.enemy.zigzag;\n      case EnemyType.BOSS:\n        return this.gameConfig.enemy.boss;\n      default:\n        return this.gameConfig.enemy.basic;\n    }\n  }\n\n  /**\n   * Select enemy type based on weighted probabilities\n   * æ ¹æ®åŠ æƒæ¦‚ç‡é€‰æ‹©æ•Œæœºç±»å‹\n   * @returns Selected enemy type\n   */\n  selectEnemyType(): EnemyType {\n    const random = Math.random();\n    let cumulative = 0;\n\n    // Check each enemy type weight\n    for (const [type, weight] of Object.entries(this.ENEMY_TYPE_WEIGHTS)) {\n      cumulative += weight;\n      if (random < cumulative) {\n        return type as EnemyType;\n      }\n    }\n\n    // Default to BASIC\n    return EnemyType.BASIC;\n  }\n\n  /**\n   * Spawn a power-up at the specified position\n   * åœ¨æŒ‡å®šä½ç½®ç”Ÿæˆé“å…·\n   * @param x X position\n   * @param y Y position\n   * @param entityManager Entity manager to add the power-up\n   */\n  spawnPowerUp(x: number, y: number, entityManager: EntityManager): void {\n    const type = this.selectPowerUpType();\n    const powerUp = new PowerUp(x, y, type, this.gameConfig);\n    entityManager.addEntity(powerUp);\n  }\n\n  /**\n   * Try to spawn a power-up based on drop chance\n   * æ ¹æ®æ‰è½æ¦‚ç‡å°è¯•ç”Ÿæˆé“å…·\n   * @param x X position\n   * @param y Y position\n   * @param entityManager Entity manager to add the power-up\n   * @returns true if power-up was spawned\n   */\n  trySpawnPowerUp(x: number, y: number, entityManager: EntityManager): boolean {\n    if (Math.random() < this.config.powerUpDropChance) {\n      this.spawnPowerUp(x, y, entityManager);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Select power-up type randomly\n   * éšæœºé€‰æ‹©é“å…·ç±»å‹\n   * @returns Selected power-up type\n   */\n  selectPowerUpType(): PowerUpType {\n    return PowerUp.getRandomType();\n  }\n\n  /**\n   * Record an enemy destroyed and check for boss spawn\n   * è®°å½•æ•Œæœºè¢«å‡»æ¯å¹¶æ£€æŸ¥æ˜¯å¦éœ€è¦ç”ŸæˆBoss\n   * @param entityManager Entity manager to add boss if triggered\n   */\n  recordEnemyDestroyed(entityManager: EntityManager): void {\n    this.enemiesDestroyed++;\n\n    // Check boss spawn condition (every 50 enemies)\n    if (this.enemiesDestroyed % 50 === 0 && !this.bossActive) {\n      this.spawnBoss(entityManager);\n    }\n  }\n\n  /**\n   * Spawn a boss enemy\n   * ç”ŸæˆBossæ•Œæœº\n   * @param entityManager Entity manager to add the boss\n   */\n  spawnBoss(entityManager: EntityManager): void {\n    const bossConfig = this.gameConfig.enemy.boss;\n    \n    // Spawn boss at center top of screen\n    const x = (this.gameConfig.canvas.width - bossConfig.width) / 2;\n    const y = -bossConfig.height;\n\n    const boss = new EnemyAircraft(x, y, EnemyType.BOSS, this.gameConfig);\n    entityManager.addEntity(boss);\n    \n    this.bossActive = true;\n  }\n\n  /**\n   * Mark boss as defeated\n   * æ ‡è®°Bosså·²è¢«å‡»è´¥\n   */\n  onBossDefeated(): void {\n    this.bossActive = false;\n  }\n\n  /**\n   * Check if boss is currently active\n   * æ£€æŸ¥Bossæ˜¯å¦å½“å‰æ´»è·ƒ\n   */\n  isBossActive(): boolean {\n    return this.bossActive;\n  }\n\n  /**\n   * Get current difficulty level\n   * è·å–å½“å‰éš¾åº¦ç­‰çº§\n   */\n  getCurrentDifficulty(): number {\n    return this.currentDifficulty;\n  }\n\n  /**\n   * Get total enemies destroyed\n   * è·å–å‡»æ¯çš„æ•Œæœºæ€»æ•°\n   */\n  getEnemiesDestroyed(): number {\n    return this.enemiesDestroyed;\n  }\n\n  /**\n   * Get current game time\n   * è·å–å½“å‰æ¸¸æˆæ—¶é—´\n   */\n  getGameTime(): number {\n    return this.gameTime;\n  }\n\n  /**\n   * Reset the spawn system\n   * é‡ç½®ç”Ÿæˆç³»ç»Ÿ\n   */\n  reset(): void {\n    this.lastSpawnTime = 0;\n    this.gameTime = 0;\n    this.currentDifficulty = 1;\n    this.enemiesDestroyed = 0;\n    this.bossActive = false;\n    this.lastDifficultyIncrease = 0;\n  }\n\n  /**\n   * Set spawn configuration\n   * è®¾ç½®ç”Ÿæˆé…ç½®\n   * @param config Partial spawn configuration\n   */\n  setConfig(config: Partial<SpawnConfig>): void {\n    this.config = { ...this.config, ...config };\n  }\n\n  /**\n   * Get current spawn configuration\n   * è·å–å½“å‰ç”Ÿæˆé…ç½®\n   */\n  getConfig(): SpawnConfig {\n    return { ...this.config };\n  }\n}\n","/**\n * ScoreSystem Class\n * å¾—åˆ†ç³»ç»Ÿç±»\n * \n * Manages scoring, high scores, and statistics.\n * ç®¡ç†å¾—åˆ†ã€æœ€é«˜åˆ†å’Œç»Ÿè®¡æ•°æ®ã€‚\n */\n\n/**\n * Score Data Interface\n * å¾—åˆ†æ•°æ®æ¥å£\n */\nexport interface ScoreData {\n  /** Current score */\n  currentScore: number;\n  /** High score */\n  highScore: number;\n  /** Total enemies destroyed */\n  enemiesDestroyed: number;\n  /** Accuracy percentage (0-100) */\n  accuracy: number;\n}\n\n/**\n * Local Storage Key for high score\n */\nconst HIGH_SCORE_KEY = 'thunderFighter_highScore';\n\n/**\n * ScoreSystem Class\n * å¾—åˆ†ç³»ç»Ÿ\n */\nexport class ScoreSystem {\n  private currentScore: number = 0;\n  private highScore: number = 0;\n  private enemiesDestroyed: number = 0;\n  private totalShots: number = 0;\n  private totalHits: number = 0;\n  \n  // Combo system\n  private consecutiveKills: number = 0;\n  private lastKillTime: number = 0;\n  private readonly COMBO_TIMEOUT: number = 2000; // 2 seconds to maintain combo\n  private readonly COMBO_THRESHOLD: number = 3; // 3+ kills for bonus\n  private readonly COMBO_MULTIPLIER: number = 1.5; // 1.5x score for combo\n\n  constructor() {\n    this.loadHighScore();\n  }\n\n  /**\n   * Add score points\n   * æ·»åŠ å¾—åˆ†\n   * @param points Base points to add\n   * @param currentTime Current game time in milliseconds (optional, for combo)\n   * @returns Actual points added (may include combo bonus)\n   */\n  addScore(points: number, currentTime?: number): number {\n    let actualPoints = points;\n\n    // Check for combo bonus\n    if (currentTime !== undefined) {\n      // Check if combo is still active\n      if (currentTime - this.lastKillTime <= this.COMBO_TIMEOUT) {\n        this.consecutiveKills++;\n      } else {\n        this.consecutiveKills = 1;\n      }\n      this.lastKillTime = currentTime;\n\n      // Apply combo multiplier if threshold met\n      if (this.consecutiveKills >= this.COMBO_THRESHOLD) {\n        actualPoints = Math.floor(points * this.COMBO_MULTIPLIER);\n      }\n    }\n\n    this.currentScore += actualPoints;\n\n    // Update high score if current score exceeds it\n    if (this.currentScore > this.highScore) {\n      this.highScore = this.currentScore;\n    }\n\n    return actualPoints;\n  }\n\n  /**\n   * Record an enemy destroyed\n   * è®°å½•æ•Œæœºè¢«å‡»æ¯\n   */\n  recordEnemyDestroyed(): void {\n    this.enemiesDestroyed++;\n  }\n\n  /**\n   * Record a shot fired\n   * è®°å½•å‘å°„çš„å­å¼¹\n   */\n  recordShot(): void {\n    this.totalShots++;\n  }\n\n  /**\n   * Record multiple shots fired\n   * è®°å½•å‘å°„çš„å¤šä¸ªå­å¼¹\n   * @param count Number of shots\n   */\n  recordShots(count: number): void {\n    this.totalShots += count;\n  }\n\n  /**\n   * Record a hit\n   * è®°å½•å‘½ä¸­\n   */\n  recordHit(): void {\n    this.totalHits++;\n  }\n\n  /**\n   * Get current score data\n   * è·å–å½“å‰å¾—åˆ†æ•°æ®\n   * @returns Score data object\n   */\n  getScoreData(): ScoreData {\n    return {\n      currentScore: this.currentScore,\n      highScore: this.highScore,\n      enemiesDestroyed: this.enemiesDestroyed,\n      accuracy: this.calculateAccuracy()\n    };\n  }\n\n  /**\n   * Get current score\n   * è·å–å½“å‰å¾—åˆ†\n   */\n  getCurrentScore(): number {\n    return this.currentScore;\n  }\n\n  /**\n   * Get high score\n   * è·å–æœ€é«˜åˆ†\n   */\n  getHighScore(): number {\n    return this.highScore;\n  }\n\n  /**\n   * Get enemies destroyed count\n   * è·å–å‡»æ¯æ•Œæœºæ•°é‡\n   */\n  getEnemiesDestroyed(): number {\n    return this.enemiesDestroyed;\n  }\n\n  /**\n   * Get current combo count\n   * è·å–å½“å‰è¿å‡»æ•°\n   */\n  getComboCount(): number {\n    return this.consecutiveKills;\n  }\n\n  /**\n   * Check if combo is active\n   * æ£€æŸ¥è¿å‡»æ˜¯å¦æ¿€æ´»\n   * @param currentTime Current game time in milliseconds\n   */\n  isComboActive(currentTime: number): boolean {\n    return (\n      this.consecutiveKills >= this.COMBO_THRESHOLD &&\n      currentTime - this.lastKillTime <= this.COMBO_TIMEOUT\n    );\n  }\n\n  /**\n   * Calculate accuracy percentage\n   * è®¡ç®—å‡†ç¡®ç‡ç™¾åˆ†æ¯”\n   * @returns Accuracy as percentage (0-100)\n   */\n  calculateAccuracy(): number {\n    if (this.totalShots === 0) {\n      return 0;\n    }\n    return Math.round((this.totalHits / this.totalShots) * 100);\n  }\n\n  /**\n   * Get total shots fired\n   * è·å–å‘å°„çš„å­å¼¹æ€»æ•°\n   */\n  getTotalShots(): number {\n    return this.totalShots;\n  }\n\n  /**\n   * Get total hits\n   * è·å–å‘½ä¸­æ€»æ•°\n   */\n  getTotalHits(): number {\n    return this.totalHits;\n  }\n\n  /**\n   * Save high score to local storage\n   * ä¿å­˜æœ€é«˜åˆ†åˆ°æœ¬åœ°å­˜å‚¨\n   */\n  saveHighScore(): void {\n    try {\n      localStorage.setItem(HIGH_SCORE_KEY, this.highScore.toString());\n    } catch (error) {\n      // localStorage not available, fail silently\n      console.warn('Unable to save high score to localStorage:', error);\n    }\n  }\n\n  /**\n   * Load high score from local storage\n   * ä»æœ¬åœ°å­˜å‚¨åŠ è½½æœ€é«˜åˆ†\n   */\n  loadHighScore(): void {\n    try {\n      const saved = localStorage.getItem(HIGH_SCORE_KEY);\n      if (saved !== null) {\n        const parsed = parseInt(saved, 10);\n        if (!isNaN(parsed) && parsed >= 0) {\n          this.highScore = parsed;\n        }\n      }\n    } catch (error) {\n      // localStorage not available, fail silently\n      console.warn('Unable to load high score from localStorage:', error);\n    }\n  }\n\n  /**\n   * Reset score for new game (keeps high score)\n   * é‡ç½®å¾—åˆ†ä»¥å¼€å§‹æ–°æ¸¸æˆï¼ˆä¿ç•™æœ€é«˜åˆ†ï¼‰\n   */\n  reset(): void {\n    // Save high score before reset\n    this.saveHighScore();\n    \n    this.currentScore = 0;\n    this.enemiesDestroyed = 0;\n    this.totalShots = 0;\n    this.totalHits = 0;\n    this.consecutiveKills = 0;\n    this.lastKillTime = 0;\n  }\n\n  /**\n   * Reset everything including high score\n   * é‡ç½®æ‰€æœ‰æ•°æ®åŒ…æ‹¬æœ€é«˜åˆ†\n   */\n  resetAll(): void {\n    this.currentScore = 0;\n    this.highScore = 0;\n    this.enemiesDestroyed = 0;\n    this.totalShots = 0;\n    this.totalHits = 0;\n    this.consecutiveKills = 0;\n    this.lastKillTime = 0;\n\n    // Clear from localStorage\n    try {\n      localStorage.removeItem(HIGH_SCORE_KEY);\n    } catch (error) {\n      console.warn('Unable to clear high score from localStorage:', error);\n    }\n  }\n\n  /**\n   * Calculate final score with accuracy bonus\n   * è®¡ç®—å¸¦å‡†ç¡®ç‡å¥–åŠ±çš„æœ€ç»ˆå¾—åˆ†\n   * @returns Final score with bonus applied\n   */\n  calculateFinalScore(): number {\n    const accuracy = this.calculateAccuracy();\n    let finalScore = this.currentScore;\n\n    // Apply accuracy bonus if accuracy > 70%\n    if (accuracy > 70) {\n      finalScore = Math.floor(finalScore * 1.2);\n    }\n\n    return finalScore;\n  }\n\n  /**\n   * Apply final score bonus and update high score\n   * åº”ç”¨æœ€ç»ˆå¾—åˆ†å¥–åŠ±å¹¶æ›´æ–°æœ€é«˜åˆ†\n   */\n  applyFinalBonus(): void {\n    const finalScore = this.calculateFinalScore();\n    this.currentScore = finalScore;\n\n    if (this.currentScore > this.highScore) {\n      this.highScore = this.currentScore;\n    }\n\n    this.saveHighScore();\n  }\n}\n","/**\n * AudioManager Class\n * éŸ³é¢‘ç®¡ç†å™¨ç±»\n * \n * Manages sound effects and background music.\n * ç®¡ç†éŸ³æ•ˆå’ŒèƒŒæ™¯éŸ³ä¹ã€‚\n */\nimport { SoundEffect } from '../types/enums';\n\n/**\n * Audio Configuration Interface\n * éŸ³é¢‘é…ç½®æ¥å£\n */\nexport interface AudioConfig {\n  /** Sound effects volume (0-1) */\n  soundVolume: number;\n  /** Music volume (0-1) */\n  musicVolume: number;\n  /** Whether audio is muted */\n  muted: boolean;\n}\n\n/**\n * AudioManager Class\n * éŸ³é¢‘ç®¡ç†å™¨\n */\nexport class AudioManager {\n  private sounds: Map<SoundEffect, HTMLAudioElement> = new Map();\n  private bgm: HTMLAudioElement | null = null;\n  private soundVolume: number = 0.7;\n  private musicVolume: number = 0.5;\n  private muted: boolean = false;\n  private audioContext: AudioContext | null = null;\n  private initialized: boolean = false;\n\n  constructor() {\n    // Try to create AudioContext for better audio handling\n    try {\n      this.audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n    } catch (error) {\n      console.warn('AudioContext not available:', error);\n    }\n  }\n\n  /**\n   * Initialize audio system (must be called after user interaction)\n   * åˆå§‹åŒ–éŸ³é¢‘ç³»ç»Ÿï¼ˆå¿…é¡»åœ¨ç”¨æˆ·äº¤äº’åè°ƒç”¨ï¼‰\n   */\n  async initialize(): Promise<void> {\n    if (this.initialized) return;\n\n    // Resume AudioContext if suspended\n    if (this.audioContext && this.audioContext.state === 'suspended') {\n      try {\n        await this.audioContext.resume();\n      } catch (error) {\n        console.warn('Failed to resume AudioContext:', error);\n      }\n    }\n\n    this.initialized = true;\n  }\n\n  /**\n   * Load a sound effect\n   * åŠ è½½éŸ³æ•ˆ\n   * @param effect Sound effect type\n   * @param path Path to audio file\n   * @returns Promise that resolves when loaded\n   */\n  loadSound(effect: SoundEffect, path: string): Promise<void> {\n    return new Promise((resolve) => {\n      const audio = new Audio();\n      \n      audio.addEventListener('canplaythrough', () => {\n        this.sounds.set(effect, audio);\n        resolve();\n      }, { once: true });\n\n      audio.addEventListener('error', (error) => {\n        console.warn(`Failed to load sound effect ${effect}:`, error);\n        // Resolve anyway to not block game loading\n        resolve();\n      }, { once: true });\n\n      audio.src = path;\n      audio.load();\n    });\n  }\n\n  /**\n   * Load background music\n   * åŠ è½½èƒŒæ™¯éŸ³ä¹\n   * @param path Path to audio file\n   * @returns Promise that resolves when loaded\n   */\n  loadMusic(path: string): Promise<void> {\n    return new Promise((resolve) => {\n      this.bgm = new Audio();\n      \n      this.bgm.addEventListener('canplaythrough', () => {\n        if (this.bgm) {\n          this.bgm.loop = true;\n          this.bgm.volume = this.muted ? 0 : this.musicVolume;\n        }\n        resolve();\n      }, { once: true });\n\n      this.bgm.addEventListener('error', (error) => {\n        console.warn('Failed to load background music:', error);\n        this.bgm = null;\n        // Resolve anyway to not block game loading\n        resolve();\n      }, { once: true });\n\n      this.bgm.src = path;\n      this.bgm.load();\n    });\n  }\n\n  /**\n   * Play a sound effect\n   * æ’­æ”¾éŸ³æ•ˆ\n   * @param effect Sound effect to play\n   */\n  playSound(effect: SoundEffect): void {\n    if (this.muted) return;\n\n    const audio = this.sounds.get(effect);\n    if (!audio) {\n      // Sound not loaded, fail silently\n      return;\n    }\n\n    try {\n      // Clone the audio element for overlapping sounds\n      const clone = audio.cloneNode() as HTMLAudioElement;\n      clone.volume = this.soundVolume;\n      \n      // Play and clean up after\n      clone.play().catch(error => {\n        // Autoplay may be blocked, fail silently\n        console.debug('Sound playback blocked:', error);\n      });\n\n      // Remove clone after playback\n      clone.addEventListener('ended', () => {\n        clone.remove();\n      }, { once: true });\n    } catch (error) {\n      console.warn(`Failed to play sound effect ${effect}:`, error);\n    }\n  }\n\n  /**\n   * Play background music\n   * æ’­æ”¾èƒŒæ™¯éŸ³ä¹\n   */\n  playMusic(): void {\n    if (!this.bgm) return;\n\n    try {\n      this.bgm.volume = this.muted ? 0 : this.musicVolume;\n      this.bgm.play().catch(error => {\n        // Autoplay may be blocked\n        console.debug('Music playback blocked:', error);\n      });\n    } catch (error) {\n      console.warn('Failed to play background music:', error);\n    }\n  }\n\n  /**\n   * Stop background music\n   * åœæ­¢èƒŒæ™¯éŸ³ä¹\n   */\n  stopMusic(): void {\n    if (!this.bgm) return;\n\n    try {\n      this.bgm.pause();\n      this.bgm.currentTime = 0;\n    } catch (error) {\n      console.warn('Failed to stop background music:', error);\n    }\n  }\n\n  /**\n   * Pause background music\n   * æš‚åœèƒŒæ™¯éŸ³ä¹\n   */\n  pauseMusic(): void {\n    if (!this.bgm) return;\n\n    try {\n      this.bgm.pause();\n    } catch (error) {\n      console.warn('Failed to pause background music:', error);\n    }\n  }\n\n  /**\n   * Resume background music\n   * æ¢å¤èƒŒæ™¯éŸ³ä¹\n   */\n  resumeMusic(): void {\n    if (!this.bgm || this.muted) return;\n\n    try {\n      this.bgm.play().catch(error => {\n        console.debug('Music resume blocked:', error);\n      });\n    } catch (error) {\n      console.warn('Failed to resume background music:', error);\n    }\n  }\n\n  /**\n   * Set sound effects volume\n   * è®¾ç½®éŸ³æ•ˆéŸ³é‡\n   * @param volume Volume level (0-1)\n   */\n  setSoundVolume(volume: number): void {\n    this.soundVolume = Math.max(0, Math.min(1, volume));\n  }\n\n  /**\n   * Get sound effects volume\n   * è·å–éŸ³æ•ˆéŸ³é‡\n   */\n  getSoundVolume(): number {\n    return this.soundVolume;\n  }\n\n  /**\n   * Set music volume\n   * è®¾ç½®éŸ³ä¹éŸ³é‡\n   * @param volume Volume level (0-1)\n   */\n  setMusicVolume(volume: number): void {\n    this.musicVolume = Math.max(0, Math.min(1, volume));\n    \n    if (this.bgm && !this.muted) {\n      this.bgm.volume = this.musicVolume;\n    }\n  }\n\n  /**\n   * Get music volume\n   * è·å–éŸ³ä¹éŸ³é‡\n   */\n  getMusicVolume(): number {\n    return this.musicVolume;\n  }\n\n  /**\n   * Toggle mute state\n   * åˆ‡æ¢é™éŸ³çŠ¶æ€\n   * @returns New mute state\n   */\n  toggleMute(): boolean {\n    this.muted = !this.muted;\n    \n    if (this.bgm) {\n      this.bgm.volume = this.muted ? 0 : this.musicVolume;\n    }\n    \n    return this.muted;\n  }\n\n  /**\n   * Set mute state\n   * è®¾ç½®é™éŸ³çŠ¶æ€\n   * @param muted Whether to mute\n   */\n  setMuted(muted: boolean): void {\n    this.muted = muted;\n    \n    if (this.bgm) {\n      this.bgm.volume = this.muted ? 0 : this.musicVolume;\n    }\n  }\n\n  /**\n   * Check if audio is muted\n   * æ£€æŸ¥æ˜¯å¦é™éŸ³\n   */\n  isMuted(): boolean {\n    return this.muted;\n  }\n\n  /**\n   * Get audio configuration\n   * è·å–éŸ³é¢‘é…ç½®\n   */\n  getConfig(): AudioConfig {\n    return {\n      soundVolume: this.soundVolume,\n      musicVolume: this.musicVolume,\n      muted: this.muted\n    };\n  }\n\n  /**\n   * Set audio configuration\n   * è®¾ç½®éŸ³é¢‘é…ç½®\n   * @param config Audio configuration\n   */\n  setConfig(config: Partial<AudioConfig>): void {\n    if (config.soundVolume !== undefined) {\n      this.setSoundVolume(config.soundVolume);\n    }\n    if (config.musicVolume !== undefined) {\n      this.setMusicVolume(config.musicVolume);\n    }\n    if (config.muted !== undefined) {\n      this.setMuted(config.muted);\n    }\n  }\n\n  /**\n   * Check if a sound effect is loaded\n   * æ£€æŸ¥éŸ³æ•ˆæ˜¯å¦å·²åŠ è½½\n   * @param effect Sound effect to check\n   */\n  isSoundLoaded(effect: SoundEffect): boolean {\n    return this.sounds.has(effect);\n  }\n\n  /**\n   * Check if background music is loaded\n   * æ£€æŸ¥èƒŒæ™¯éŸ³ä¹æ˜¯å¦å·²åŠ è½½\n   */\n  isMusicLoaded(): boolean {\n    return this.bgm !== null;\n  }\n\n  /**\n   * Preload all game sounds\n   * é¢„åŠ è½½æ‰€æœ‰æ¸¸æˆéŸ³æ•ˆ\n   * @param basePath Base path for audio files\n   */\n  async preloadSounds(basePath: string = 'assets/audio/'): Promise<void> {\n    const soundFiles: Record<SoundEffect, string> = {\n      [SoundEffect.PLAYER_SHOOT]: 'player_shoot.mp3',\n      [SoundEffect.ENEMY_SHOOT]: 'enemy_shoot.mp3',\n      [SoundEffect.EXPLOSION]: 'explosion.mp3',\n      [SoundEffect.POWER_UP]: 'power_up.mp3',\n      [SoundEffect.HIT]: 'hit.mp3'\n    };\n\n    const loadPromises: Promise<void>[] = [];\n\n    for (const [effect, filename] of Object.entries(soundFiles)) {\n      loadPromises.push(\n        this.loadSound(effect as SoundEffect, basePath + filename)\n      );\n    }\n\n    await Promise.all(loadPromises);\n  }\n\n  /**\n   * Clean up audio resources\n   * æ¸…ç†éŸ³é¢‘èµ„æº\n   */\n  dispose(): void {\n    // Stop and clear background music\n    if (this.bgm) {\n      this.bgm.pause();\n      this.bgm.src = '';\n      this.bgm = null;\n    }\n\n    // Clear all sound effects\n    for (const audio of this.sounds.values()) {\n      audio.src = '';\n    }\n    this.sounds.clear();\n\n    // Close AudioContext\n    if (this.audioContext) {\n      this.audioContext.close().catch(() => {});\n      this.audioContext = null;\n    }\n\n    this.initialized = false;\n  }\n}\n","/**\n * VisualEffects Class\n * è§†è§‰æ•ˆæœç±»\n * \n * Manages all visual effects including explosions, particles, and screen effects.\n * ç®¡ç†æ‰€æœ‰è§†è§‰æ•ˆæœï¼ŒåŒ…æ‹¬çˆ†ç‚¸ã€ç²’å­å’Œå±å¹•æ•ˆæœã€‚\n */\nimport { GameConfig, DEFAULT_GAME_CONFIG } from '../types/GameConfig';\n\n/**\n * Particle Interface\n * ç²’å­æ¥å£\n */\nexport interface Particle {\n  x: number;\n  y: number;\n  vx: number;\n  vy: number;\n  life: number;\n  maxLife: number;\n  size: number;\n  color: string;\n  alpha: number;\n  type: ParticleType;\n  rotation?: number;\n  rotationSpeed?: number;\n}\n\n/**\n * Particle Type Enum\n * ç²’å­ç±»å‹æšä¸¾\n */\nexport enum ParticleType {\n  SPARK = 'spark',\n  SMOKE = 'smoke',\n  FIRE = 'fire',\n  DEBRIS = 'debris',\n  TRAIL = 'trail',\n  STAR = 'star'\n}\n\n/**\n * Explosion Interface\n * çˆ†ç‚¸æ¥å£\n */\nexport interface Explosion {\n  x: number;\n  y: number;\n  radius: number;\n  maxRadius: number;\n  life: number;\n  maxLife: number;\n  particles: Particle[];\n  shockwave: boolean;\n  shockwaveRadius: number;\n}\n\n/**\n * Screen Effect Interface\n * å±å¹•æ•ˆæœæ¥å£\n */\nexport interface ScreenEffect {\n  type: 'shake' | 'flash' | 'damage';\n  duration: number;\n  elapsed: number;\n  intensity: number;\n  color?: string;\n}\n\n/**\n * VisualEffects Class\n * è§†è§‰æ•ˆæœ\n */\nexport class VisualEffects {\n  private config: GameConfig;\n  private particles: Particle[] = [];\n  private explosions: Explosion[] = [];\n  private screenEffects: ScreenEffect[] = [];\n  private time: number = 0;\n\n  // Explosion color palettes\n  private readonly explosionColors = {\n    normal: ['#ffffff', '#ffff00', '#ff8800', '#ff4400', '#ff0000'],\n    blue: ['#ffffff', '#88ffff', '#00ccff', '#0088ff', '#0044aa'],\n    green: ['#ffffff', '#88ff88', '#00ff00', '#00cc00', '#008800'],\n    purple: ['#ffffff', '#ff88ff', '#ff00ff', '#cc00cc', '#880088']\n  };\n\n  constructor(config: GameConfig = DEFAULT_GAME_CONFIG) {\n    this.config = config;\n  }\n\n  /**\n   * Update all visual effects\n   * æ›´æ–°æ‰€æœ‰è§†è§‰æ•ˆæœ\n   */\n  update(deltaTime: number): void {\n    this.time += deltaTime;\n    this.updateParticles(deltaTime);\n    this.updateExplosions(deltaTime);\n    this.updateScreenEffects(deltaTime);\n  }\n\n  /**\n   * Create an explosion at position\n   * åœ¨æŒ‡å®šä½ç½®åˆ›å»ºçˆ†ç‚¸\n   */\n  createExplosion(\n    x: number,\n    y: number,\n    size: number = 1,\n    colorPalette: keyof typeof this.explosionColors = 'normal'\n  ): void {\n    const colors = this.explosionColors[colorPalette];\n    const particles: Particle[] = [];\n    const particleCount = Math.floor(25 * size);\n\n    // Create fire particles\n    for (let i = 0; i < particleCount; i++) {\n      const angle = Math.random() * Math.PI * 2;\n      const speed = 80 + Math.random() * 150 * size;\n      \n      particles.push({\n        x: x,\n        y: y,\n        vx: Math.cos(angle) * speed,\n        vy: Math.sin(angle) * speed,\n        life: 0.4 + Math.random() * 0.4,\n        maxLife: 0.8,\n        size: 3 + Math.random() * 6 * size,\n        color: colors[Math.floor(Math.random() * colors.length)],\n        alpha: 1,\n        type: ParticleType.FIRE\n      });\n    }\n\n    // Create smoke particles\n    for (let i = 0; i < particleCount / 2; i++) {\n      const angle = Math.random() * Math.PI * 2;\n      const speed = 30 + Math.random() * 50;\n      \n      particles.push({\n        x: x + (Math.random() - 0.5) * 20,\n        y: y + (Math.random() - 0.5) * 20,\n        vx: Math.cos(angle) * speed,\n        vy: Math.sin(angle) * speed - 30,\n        life: 0.6 + Math.random() * 0.6,\n        maxLife: 1.2,\n        size: 8 + Math.random() * 12 * size,\n        color: '#444444',\n        alpha: 0.6,\n        type: ParticleType.SMOKE\n      });\n    }\n\n    // Create debris particles\n    for (let i = 0; i < 8 * size; i++) {\n      const angle = Math.random() * Math.PI * 2;\n      const speed = 100 + Math.random() * 200;\n      \n      particles.push({\n        x: x,\n        y: y,\n        vx: Math.cos(angle) * speed,\n        vy: Math.sin(angle) * speed,\n        life: 0.5 + Math.random() * 0.5,\n        maxLife: 1,\n        size: 2 + Math.random() * 4,\n        color: '#888888',\n        alpha: 1,\n        type: ParticleType.DEBRIS,\n        rotation: Math.random() * Math.PI * 2,\n        rotationSpeed: (Math.random() - 0.5) * 20\n      });\n    }\n\n    this.explosions.push({\n      x: x,\n      y: y,\n      radius: 0,\n      maxRadius: 40 * size,\n      life: 0.3,\n      maxLife: 0.3,\n      particles: particles,\n      shockwave: size >= 1,\n      shockwaveRadius: 0\n    });\n\n    // Add screen shake for large explosions\n    if (size >= 1.5) {\n      this.addScreenShake(0.2, size * 3);\n    }\n  }\n\n  /**\n   * Create engine trail particles\n   * åˆ›å»ºå¼•æ“å°¾è¿¹ç²’å­\n   */\n  createEngineTrail(x: number, y: number, isPlayer: boolean = true): void {\n    const color = isPlayer ? '#00aaff' : '#ff6600';\n    const secondaryColor = isPlayer ? '#ffffff' : '#ffff00';\n\n    for (let i = 0; i < 2; i++) {\n      this.particles.push({\n        x: x + (Math.random() - 0.5) * 8,\n        y: y,\n        vx: (Math.random() - 0.5) * 15,\n        vy: 80 + Math.random() * 40,\n        life: 0.15 + Math.random() * 0.1,\n        maxLife: 0.25,\n        size: 3 + Math.random() * 3,\n        color: Math.random() > 0.5 ? color : secondaryColor,\n        alpha: 0.8,\n        type: ParticleType.TRAIL\n      });\n    }\n  }\n\n  /**\n   * Create bullet impact sparks\n   * åˆ›å»ºå­å¼¹æ’å‡»ç«èŠ±\n   */\n  createImpactSparks(x: number, y: number, count: number = 8): void {\n    for (let i = 0; i < count; i++) {\n      const angle = Math.random() * Math.PI * 2;\n      const speed = 100 + Math.random() * 150;\n\n      this.particles.push({\n        x: x,\n        y: y,\n        vx: Math.cos(angle) * speed,\n        vy: Math.sin(angle) * speed,\n        life: 0.1 + Math.random() * 0.15,\n        maxLife: 0.25,\n        size: 2 + Math.random() * 2,\n        color: Math.random() > 0.5 ? '#ffff00' : '#ffffff',\n        alpha: 1,\n        type: ParticleType.SPARK\n      });\n    }\n  }\n\n  /**\n   * Create power-up collection effect\n   * åˆ›å»ºé“å…·æ”¶é›†æ•ˆæœ\n   */\n  createPowerUpEffect(x: number, y: number, color: string): void {\n    // Star burst\n    for (let i = 0; i < 12; i++) {\n      const angle = (i / 12) * Math.PI * 2;\n      const speed = 80 + Math.random() * 40;\n\n      this.particles.push({\n        x: x,\n        y: y,\n        vx: Math.cos(angle) * speed,\n        vy: Math.sin(angle) * speed,\n        life: 0.4 + Math.random() * 0.2,\n        maxLife: 0.6,\n        size: 4 + Math.random() * 4,\n        color: color,\n        alpha: 1,\n        type: ParticleType.STAR\n      });\n    }\n\n    // Add screen flash\n    this.addScreenFlash(0.1, color);\n  }\n\n  /**\n   * Create damage flash effect for player\n   * åˆ›å»ºç©å®¶å—ä¼¤é—ªçƒæ•ˆæœ\n   */\n  createDamageEffect(): void {\n    this.screenEffects.push({\n      type: 'damage',\n      duration: 0.3,\n      elapsed: 0,\n      intensity: 0.4,\n      color: '#ff0000'\n    });\n  }\n\n  /**\n   * Add screen shake effect\n   * æ·»åŠ å±å¹•éœ‡åŠ¨æ•ˆæœ\n   */\n  addScreenShake(duration: number, intensity: number): void {\n    this.screenEffects.push({\n      type: 'shake',\n      duration: duration,\n      elapsed: 0,\n      intensity: intensity\n    });\n  }\n\n  /**\n   * Add screen flash effect\n   * æ·»åŠ å±å¹•é—ªå…‰æ•ˆæœ\n   */\n  addScreenFlash(duration: number, color: string): void {\n    this.screenEffects.push({\n      type: 'flash',\n      duration: duration,\n      elapsed: 0,\n      intensity: 0.3,\n      color: color\n    });\n  }\n\n  /**\n   * Update particles\n   * æ›´æ–°ç²’å­\n   */\n  private updateParticles(deltaTime: number): void {\n    for (let i = this.particles.length - 1; i >= 0; i--) {\n      const particle = this.particles[i];\n\n      // Update position\n      particle.x += particle.vx * deltaTime;\n      particle.y += particle.vy * deltaTime;\n\n      // Apply gravity to certain particle types\n      if (particle.type === ParticleType.DEBRIS || particle.type === ParticleType.SMOKE) {\n        particle.vy += 200 * deltaTime;\n      }\n\n      // Update rotation\n      if (particle.rotation !== undefined && particle.rotationSpeed !== undefined) {\n        particle.rotation += particle.rotationSpeed * deltaTime;\n      }\n\n      // Update life and alpha\n      particle.life -= deltaTime;\n      particle.alpha = Math.max(0, particle.life / particle.maxLife);\n\n      // Shrink particles as they die\n      if (particle.type === ParticleType.SMOKE) {\n        particle.size += 10 * deltaTime;\n      }\n\n      // Remove dead particles\n      if (particle.life <= 0) {\n        this.particles.splice(i, 1);\n      }\n    }\n  }\n\n  /**\n   * Update explosions\n   * æ›´æ–°çˆ†ç‚¸\n   */\n  private updateExplosions(deltaTime: number): void {\n    for (let i = this.explosions.length - 1; i >= 0; i--) {\n      const explosion = this.explosions[i];\n\n      // Update explosion\n      explosion.life -= deltaTime;\n      const progress = 1 - (explosion.life / explosion.maxLife);\n      explosion.radius = explosion.maxRadius * progress;\n\n      // Update shockwave\n      if (explosion.shockwave) {\n        explosion.shockwaveRadius = explosion.maxRadius * 2 * progress;\n      }\n\n      // Update explosion particles\n      for (const particle of explosion.particles) {\n        particle.x += particle.vx * deltaTime;\n        particle.y += particle.vy * deltaTime;\n        particle.life -= deltaTime;\n        particle.alpha = Math.max(0, particle.life / particle.maxLife);\n\n        // Apply gravity\n        if (particle.type === ParticleType.DEBRIS || particle.type === ParticleType.SMOKE) {\n          particle.vy += 150 * deltaTime;\n        }\n\n        // Slow down fire particles\n        if (particle.type === ParticleType.FIRE) {\n          particle.vx *= 0.95;\n          particle.vy *= 0.95;\n        }\n\n        // Update rotation\n        if (particle.rotation !== undefined && particle.rotationSpeed !== undefined) {\n          particle.rotation += particle.rotationSpeed * deltaTime;\n        }\n      }\n\n      // Remove dead explosions\n      if (explosion.life <= 0) {\n        this.explosions.splice(i, 1);\n      }\n    }\n  }\n\n  /**\n   * Update screen effects\n   * æ›´æ–°å±å¹•æ•ˆæœ\n   */\n  private updateScreenEffects(deltaTime: number): void {\n    for (let i = this.screenEffects.length - 1; i >= 0; i--) {\n      const effect = this.screenEffects[i];\n      effect.elapsed += deltaTime;\n\n      if (effect.elapsed >= effect.duration) {\n        this.screenEffects.splice(i, 1);\n      }\n    }\n  }\n\n  /**\n   * Render all visual effects\n   * æ¸²æŸ“æ‰€æœ‰è§†è§‰æ•ˆæœ\n   */\n  render(ctx: CanvasRenderingContext2D): void {\n    ctx.save();\n\n    // Apply screen shake\n    const shakeEffect = this.screenEffects.find(e => e.type === 'shake');\n    if (shakeEffect) {\n      const progress = 1 - (shakeEffect.elapsed / shakeEffect.duration);\n      const shakeX = (Math.random() - 0.5) * shakeEffect.intensity * progress * 2;\n      const shakeY = (Math.random() - 0.5) * shakeEffect.intensity * progress * 2;\n      ctx.translate(shakeX, shakeY);\n    }\n\n    // Render explosions\n    this.renderExplosions(ctx);\n\n    // Render particles\n    this.renderParticles(ctx);\n\n    ctx.restore();\n\n    // Render screen effects (after restore to not be affected by shake)\n    this.renderScreenEffects(ctx);\n  }\n\n  /**\n   * Render explosions\n   * æ¸²æŸ“çˆ†ç‚¸\n   */\n  private renderExplosions(ctx: CanvasRenderingContext2D): void {\n    for (const explosion of this.explosions) {\n      const alpha = explosion.life / explosion.maxLife;\n\n      // Render shockwave\n      if (explosion.shockwave && explosion.shockwaveRadius > 0) {\n        ctx.save();\n        ctx.globalAlpha = alpha * 0.3;\n        ctx.strokeStyle = '#ffffff';\n        ctx.lineWidth = 3;\n        ctx.beginPath();\n        ctx.arc(explosion.x, explosion.y, explosion.shockwaveRadius, 0, Math.PI * 2);\n        ctx.stroke();\n        ctx.restore();\n      }\n\n      // Render explosion flash\n      ctx.save();\n      ctx.globalAlpha = alpha * 0.6;\n      const flashGradient = ctx.createRadialGradient(\n        explosion.x, explosion.y, 0,\n        explosion.x, explosion.y, explosion.radius\n      );\n      flashGradient.addColorStop(0, '#ffffff');\n      flashGradient.addColorStop(0.3, '#ffff00');\n      flashGradient.addColorStop(0.6, '#ff6600');\n      flashGradient.addColorStop(1, 'rgba(255, 0, 0, 0)');\n      ctx.fillStyle = flashGradient;\n      ctx.beginPath();\n      ctx.arc(explosion.x, explosion.y, explosion.radius, 0, Math.PI * 2);\n      ctx.fill();\n      ctx.restore();\n\n      // Render explosion particles\n      for (const particle of explosion.particles) {\n        this.renderParticle(ctx, particle);\n      }\n    }\n  }\n\n  /**\n   * Render particles\n   * æ¸²æŸ“ç²’å­\n   */\n  private renderParticles(ctx: CanvasRenderingContext2D): void {\n    for (const particle of this.particles) {\n      this.renderParticle(ctx, particle);\n    }\n  }\n\n  /**\n   * Render a single particle\n   * æ¸²æŸ“å•ä¸ªç²’å­\n   */\n  private renderParticle(ctx: CanvasRenderingContext2D, particle: Particle): void {\n    if (particle.alpha <= 0) return;\n\n    ctx.save();\n    ctx.globalAlpha = particle.alpha;\n\n    switch (particle.type) {\n      case ParticleType.SPARK:\n      case ParticleType.FIRE:\n        // Glowing circle\n        const gradient = ctx.createRadialGradient(\n          particle.x, particle.y, 0,\n          particle.x, particle.y, particle.size\n        );\n        gradient.addColorStop(0, particle.color);\n        gradient.addColorStop(0.5, particle.color);\n        gradient.addColorStop(1, 'transparent');\n        ctx.fillStyle = gradient;\n        ctx.beginPath();\n        ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);\n        ctx.fill();\n        break;\n\n      case ParticleType.SMOKE:\n        // Soft smoke circle\n        ctx.fillStyle = particle.color;\n        ctx.globalAlpha = particle.alpha * 0.4;\n        ctx.beginPath();\n        ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);\n        ctx.fill();\n        break;\n\n      case ParticleType.DEBRIS:\n        // Rotating square\n        ctx.translate(particle.x, particle.y);\n        if (particle.rotation !== undefined) {\n          ctx.rotate(particle.rotation);\n        }\n        ctx.fillStyle = particle.color;\n        ctx.fillRect(-particle.size / 2, -particle.size / 2, particle.size, particle.size);\n        break;\n\n      case ParticleType.TRAIL:\n        // Elongated trail\n        ctx.fillStyle = particle.color;\n        ctx.beginPath();\n        ctx.ellipse(particle.x, particle.y, particle.size / 2, particle.size, 0, 0, Math.PI * 2);\n        ctx.fill();\n        break;\n\n      case ParticleType.STAR:\n        // Star shape\n        this.drawStar(ctx, particle.x, particle.y, 5, particle.size, particle.size / 2, particle.color);\n        break;\n    }\n\n    ctx.restore();\n  }\n\n  /**\n   * Render screen effects\n   * æ¸²æŸ“å±å¹•æ•ˆæœ\n   */\n  private renderScreenEffects(ctx: CanvasRenderingContext2D): void {\n    const { width, height } = this.config.canvas;\n\n    for (const effect of this.screenEffects) {\n      const progress = effect.elapsed / effect.duration;\n\n      switch (effect.type) {\n        case 'flash':\n          ctx.save();\n          ctx.globalAlpha = effect.intensity * (1 - progress);\n          ctx.fillStyle = effect.color || '#ffffff';\n          ctx.fillRect(0, 0, width, height);\n          ctx.restore();\n          break;\n\n        case 'damage':\n          // Red vignette effect\n          ctx.save();\n          const vignetteAlpha = effect.intensity * (1 - progress);\n          const vignetteGradient = ctx.createRadialGradient(\n            width / 2, height / 2, height * 0.3,\n            width / 2, height / 2, height * 0.8\n          );\n          vignetteGradient.addColorStop(0, 'transparent');\n          vignetteGradient.addColorStop(1, `rgba(255, 0, 0, ${vignetteAlpha})`);\n          ctx.fillStyle = vignetteGradient;\n          ctx.fillRect(0, 0, width, height);\n          ctx.restore();\n          break;\n      }\n    }\n  }\n\n  /**\n   * Draw a star shape\n   * ç»˜åˆ¶æ˜Ÿå½¢\n   */\n  private drawStar(\n    ctx: CanvasRenderingContext2D,\n    cx: number,\n    cy: number,\n    spikes: number,\n    outerRadius: number,\n    innerRadius: number,\n    color: string\n  ): void {\n    ctx.fillStyle = color;\n    ctx.beginPath();\n\n    for (let i = 0; i < spikes * 2; i++) {\n      const radius = i % 2 === 0 ? outerRadius : innerRadius;\n      const angle = (i * Math.PI) / spikes - Math.PI / 2;\n      const x = cx + Math.cos(angle) * radius;\n      const y = cy + Math.sin(angle) * radius;\n\n      if (i === 0) {\n        ctx.moveTo(x, y);\n      } else {\n        ctx.lineTo(x, y);\n      }\n    }\n\n    ctx.closePath();\n    ctx.fill();\n  }\n\n  /**\n   * Clear all effects\n   * æ¸…é™¤æ‰€æœ‰æ•ˆæœ\n   */\n  clear(): void {\n    this.particles = [];\n    this.explosions = [];\n    this.screenEffects = [];\n  }\n\n  /**\n   * Get particle count (for debugging)\n   * è·å–ç²’å­æ•°é‡ï¼ˆç”¨äºè°ƒè¯•ï¼‰\n   */\n  getParticleCount(): number {\n    let count = this.particles.length;\n    for (const explosion of this.explosions) {\n      count += explosion.particles.length;\n    }\n    return count;\n  }\n\n  /**\n   * Check if there are active screen effects\n   * æ£€æŸ¥æ˜¯å¦æœ‰æ´»åŠ¨çš„å±å¹•æ•ˆæœ\n   */\n  hasActiveScreenEffects(): boolean {\n    return this.screenEffects.length > 0;\n  }\n}\n","/**\n * BackgroundRenderer Class\n * èƒŒæ™¯æ¸²æŸ“å™¨ç±»\n * \n * Handles procedural background generation and scrolling effects.\n * å¤„ç†ç¨‹åºåŒ–èƒŒæ™¯ç”Ÿæˆå’Œæ»šåŠ¨æ•ˆæœã€‚\n */\nimport { GameConfig, DEFAULT_GAME_CONFIG } from '../types/GameConfig';\n\n/**\n * Star Interface\n * æ˜Ÿæ˜Ÿæ¥å£\n */\ninterface Star {\n  x: number;\n  y: number;\n  size: number;\n  speed: number;\n  brightness: number;\n  twinklePhase: number;\n}\n\n/**\n * Nebula Interface\n * æ˜Ÿäº‘æ¥å£\n */\ninterface Nebula {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  color: string;\n  alpha: number;\n}\n\n/**\n * BackgroundRenderer Class\n * èƒŒæ™¯æ¸²æŸ“å™¨\n */\nexport class BackgroundRenderer {\n  private config: GameConfig;\n  private stars: Star[] = [];\n  private nebulae: Nebula[] = [];\n  private scrollOffset: number = 0;\n  private scrollSpeed: number = 50;\n  private time: number = 0;\n  \n  // Pre-rendered background layers\n  private starfieldCanvas: HTMLCanvasElement | null = null;\n  private nebulaCanvas: HTMLCanvasElement | null = null;\n\n  constructor(config: GameConfig = DEFAULT_GAME_CONFIG) {\n    this.config = config;\n    this.initialize();\n  }\n\n  /**\n   * Initialize background elements\n   * åˆå§‹åŒ–èƒŒæ™¯å…ƒç´ \n   */\n  private initialize(): void {\n    this.generateStars();\n    this.generateNebulae();\n    this.preRenderLayers();\n  }\n\n  /**\n   * Generate star field\n   * ç”Ÿæˆæ˜Ÿç©º\n   */\n  private generateStars(): void {\n    const { width, height } = this.config.canvas;\n    const starCount = 150;\n\n    for (let i = 0; i < starCount; i++) {\n      this.stars.push({\n        x: Math.random() * width,\n        y: Math.random() * height * 2, // Double height for seamless scrolling\n        size: Math.random() * 2 + 0.5,\n        speed: Math.random() * 0.5 + 0.3,\n        brightness: Math.random() * 0.5 + 0.5,\n        twinklePhase: Math.random() * Math.PI * 2\n      });\n    }\n  }\n\n  /**\n   * Generate nebula clouds\n   * ç”Ÿæˆæ˜Ÿäº‘\n   */\n  private generateNebulae(): void {\n    const { width, height } = this.config.canvas;\n    const nebulaColors = [\n      'rgba(100, 50, 150, 0.1)',\n      'rgba(50, 100, 150, 0.08)',\n      'rgba(150, 50, 100, 0.06)',\n      'rgba(50, 150, 100, 0.05)'\n    ];\n\n    for (let i = 0; i < 5; i++) {\n      this.nebulae.push({\n        x: Math.random() * width - 100,\n        y: Math.random() * height * 2,\n        width: 200 + Math.random() * 200,\n        height: 150 + Math.random() * 150,\n        color: nebulaColors[Math.floor(Math.random() * nebulaColors.length)],\n        alpha: 0.3 + Math.random() * 0.3\n      });\n    }\n  }\n\n  /**\n   * Pre-render static background layers\n   * é¢„æ¸²æŸ“é™æ€èƒŒæ™¯å±‚\n   */\n  private preRenderLayers(): void {\n    const { width, height } = this.config.canvas;\n    const doubleHeight = height * 2;\n\n    // Create starfield canvas\n    this.starfieldCanvas = document.createElement('canvas');\n    this.starfieldCanvas.width = width;\n    this.starfieldCanvas.height = doubleHeight;\n    const starCtx = this.starfieldCanvas.getContext('2d')!;\n\n    // Draw base gradient\n    const gradient = starCtx.createLinearGradient(0, 0, 0, doubleHeight);\n    gradient.addColorStop(0, '#0a0a1a');\n    gradient.addColorStop(0.3, '#0f0f2a');\n    gradient.addColorStop(0.5, '#1a1a3a');\n    gradient.addColorStop(0.7, '#0f0f2a');\n    gradient.addColorStop(1, '#0a0a1a');\n    starCtx.fillStyle = gradient;\n    starCtx.fillRect(0, 0, width, doubleHeight);\n\n    // Draw static stars\n    for (const star of this.stars) {\n      starCtx.fillStyle = `rgba(255, 255, 255, ${star.brightness})`;\n      starCtx.beginPath();\n      starCtx.arc(star.x, star.y, star.size, 0, Math.PI * 2);\n      starCtx.fill();\n    }\n\n    // Create nebula canvas\n    this.nebulaCanvas = document.createElement('canvas');\n    this.nebulaCanvas.width = width;\n    this.nebulaCanvas.height = doubleHeight;\n    const nebulaCtx = this.nebulaCanvas.getContext('2d')!;\n\n    // Draw nebulae\n    for (const nebula of this.nebulae) {\n      const nebulaGradient = nebulaCtx.createRadialGradient(\n        nebula.x + nebula.width / 2,\n        nebula.y + nebula.height / 2,\n        0,\n        nebula.x + nebula.width / 2,\n        nebula.y + nebula.height / 2,\n        Math.max(nebula.width, nebula.height) / 2\n      );\n      nebulaGradient.addColorStop(0, nebula.color);\n      nebulaGradient.addColorStop(1, 'transparent');\n      nebulaCtx.fillStyle = nebulaGradient;\n      nebulaCtx.fillRect(nebula.x, nebula.y, nebula.width, nebula.height);\n    }\n  }\n\n  /**\n   * Update background state\n   * æ›´æ–°èƒŒæ™¯çŠ¶æ€\n   * @param deltaTime Time elapsed since last frame in seconds\n   */\n  update(deltaTime: number): void {\n    this.time += deltaTime;\n    this.scrollOffset += this.scrollSpeed * deltaTime;\n    \n    const { height } = this.config.canvas;\n    if (this.scrollOffset >= height) {\n      this.scrollOffset -= height;\n    }\n  }\n\n  /**\n   * Render the background\n   * æ¸²æŸ“èƒŒæ™¯\n   * @param ctx Canvas rendering context\n   */\n  render(ctx: CanvasRenderingContext2D): void {\n    const { width, height } = this.config.canvas;\n\n    // Draw base color\n    ctx.fillStyle = '#0a0a1a';\n    ctx.fillRect(0, 0, width, height);\n\n    // Draw scrolling starfield\n    if (this.starfieldCanvas) {\n      // Draw two copies for seamless scrolling\n      ctx.drawImage(\n        this.starfieldCanvas,\n        0, this.scrollOffset,\n        width, height,\n        0, 0,\n        width, height\n      );\n      \n      if (this.scrollOffset > 0) {\n        ctx.drawImage(\n          this.starfieldCanvas,\n          0, this.scrollOffset - height,\n          width, height,\n          0, 0,\n          width, height\n        );\n      }\n    }\n\n    // Draw nebulae with parallax\n    if (this.nebulaCanvas) {\n      const parallaxOffset = this.scrollOffset * 0.3;\n      ctx.globalAlpha = 0.5;\n      ctx.drawImage(\n        this.nebulaCanvas,\n        0, parallaxOffset % height,\n        width, height,\n        0, 0,\n        width, height\n      );\n      ctx.globalAlpha = 1;\n    }\n\n    // Draw twinkling stars overlay\n    this.renderTwinklingStars(ctx);\n\n    // Draw distant planets/objects occasionally\n    this.renderDistantObjects(ctx);\n  }\n\n  /**\n   * Render twinkling star effect\n   * æ¸²æŸ“é—ªçƒæ˜Ÿæ˜Ÿæ•ˆæœ\n   */\n  private renderTwinklingStars(ctx: CanvasRenderingContext2D): void {\n    const { height } = this.config.canvas;\n    \n    for (let i = 0; i < 20; i++) {\n      const star = this.stars[i % this.stars.length];\n      const twinkle = Math.sin(this.time * 3 + star.twinklePhase) * 0.5 + 0.5;\n      const y = (star.y + this.scrollOffset * star.speed) % height;\n      \n      if (twinkle > 0.7) {\n        ctx.fillStyle = `rgba(255, 255, 255, ${twinkle * star.brightness})`;\n        ctx.beginPath();\n        ctx.arc(star.x, y, star.size * 1.5, 0, Math.PI * 2);\n        ctx.fill();\n        \n        // Add cross flare for bright stars\n        if (twinkle > 0.9 && star.size > 1.5) {\n          ctx.strokeStyle = `rgba(255, 255, 255, ${twinkle * 0.3})`;\n          ctx.lineWidth = 1;\n          ctx.beginPath();\n          ctx.moveTo(star.x - 5, y);\n          ctx.lineTo(star.x + 5, y);\n          ctx.moveTo(star.x, y - 5);\n          ctx.lineTo(star.x, y + 5);\n          ctx.stroke();\n        }\n      }\n    }\n  }\n\n  /**\n   * Render distant space objects\n   * æ¸²æŸ“è¿œå¤„çš„å¤ªç©ºç‰©ä½“\n   */\n  private renderDistantObjects(ctx: CanvasRenderingContext2D): void {\n    const { width, height } = this.config.canvas;\n    \n    // Draw a distant planet\n    const planetY = ((this.scrollOffset * 0.1) % (height * 3)) - height;\n    if (planetY > -100 && planetY < height + 100) {\n      const planetGradient = ctx.createRadialGradient(\n        width * 0.8 - 10, planetY - 10, 0,\n        width * 0.8, planetY, 40\n      );\n      planetGradient.addColorStop(0, 'rgba(100, 80, 120, 0.3)');\n      planetGradient.addColorStop(0.5, 'rgba(60, 50, 80, 0.2)');\n      planetGradient.addColorStop(1, 'rgba(30, 25, 40, 0.1)');\n      \n      ctx.fillStyle = planetGradient;\n      ctx.beginPath();\n      ctx.arc(width * 0.8, planetY, 40, 0, Math.PI * 2);\n      ctx.fill();\n    }\n  }\n\n  /**\n   * Set scroll speed\n   * è®¾ç½®æ»šåŠ¨é€Ÿåº¦\n   */\n  setScrollSpeed(speed: number): void {\n    this.scrollSpeed = speed;\n  }\n\n  /**\n   * Get current scroll offset\n   * è·å–å½“å‰æ»šåŠ¨åç§»\n   */\n  getScrollOffset(): number {\n    return this.scrollOffset;\n  }\n\n  /**\n   * Reset background state\n   * é‡ç½®èƒŒæ™¯çŠ¶æ€\n   */\n  reset(): void {\n    this.scrollOffset = 0;\n    this.time = 0;\n  }\n}\n","/**\n * UIRenderer Class\n * UIæ¸²æŸ“å™¨ç±»\n * \n * Handles rendering of all UI elements with enhanced visual styling.\n * å¤„ç†æ‰€æœ‰UIå…ƒç´ çš„æ¸²æŸ“ï¼Œå…·æœ‰å¢å¼ºçš„è§†è§‰æ ·å¼ã€‚\n */\nimport { GameConfig, DEFAULT_GAME_CONFIG } from '../types/GameConfig';\nimport { ScoreData } from './ScoreSystem';\n\n/**\n * Button State Interface\n * æŒ‰é’®çŠ¶æ€æ¥å£\n */\nexport interface ButtonState {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  text: string;\n  hovered: boolean;\n  selected: boolean;\n}\n\n/**\n * UIRenderer Class\n * UIæ¸²æŸ“å™¨\n */\nexport class UIRenderer {\n  private config: GameConfig;\n  private time: number = 0;\n  \n  // Font settings\n  private readonly titleFont = 'bold 48px \"Segoe UI\", Arial, sans-serif';\n  private readonly subtitleFont = '24px \"Segoe UI\", Arial, sans-serif';\n  private readonly buttonFont = 'bold 22px \"Segoe UI\", Arial, sans-serif';\n  private readonly textFont = '18px \"Segoe UI\", Arial, sans-serif';\n  private readonly smallFont = '14px \"Segoe UI\", Arial, sans-serif';\n\n  // Color scheme\n  private readonly colors = {\n    primary: '#00d4ff',\n    secondary: '#ff6b6b',\n    accent: '#ffd700',\n    success: '#00ff88',\n    danger: '#ff4444',\n    text: '#ffffff',\n    textMuted: '#aaaaaa',\n    background: 'rgba(0, 0, 0, 0.8)',\n    panel: 'rgba(20, 30, 50, 0.9)'\n  };\n\n  constructor(config: GameConfig = DEFAULT_GAME_CONFIG) {\n    this.config = config;\n  }\n\n  /**\n   * Update UI state\n   * æ›´æ–°UIçŠ¶æ€\n   */\n  update(deltaTime: number): void {\n    this.time += deltaTime;\n  }\n\n  /**\n   * Render main menu screen\n   * æ¸²æŸ“ä¸»èœå•ç•Œé¢\n   */\n  renderMenuScreen(ctx: CanvasRenderingContext2D, selectedOption: number = 0): void {\n    const { width, height } = this.config.canvas;\n\n    // Draw semi-transparent overlay\n    ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';\n    ctx.fillRect(0, 0, width, height);\n\n    // Draw title with glow effect\n    this.drawGlowText(ctx, 'THUNDER FIGHTER', width / 2, height * 0.25, {\n      font: this.titleFont,\n      color: this.colors.primary,\n      glowColor: this.colors.primary,\n      glowSize: 20\n    });\n\n    // Draw Chinese subtitle\n    ctx.fillStyle = this.colors.text;\n    ctx.font = this.subtitleFont;\n    ctx.textAlign = 'center';\n    ctx.fillText('é›·éœ†æˆ˜æœº', width / 2, height * 0.25 + 50);\n\n    // Draw animated decorative line\n    this.drawAnimatedLine(ctx, width / 2 - 100, height * 0.35, 200);\n\n    // Draw menu options\n    const options = ['å¼€å§‹æ¸¸æˆ / START GAME', 'è®¾ç½® / SETTINGS', 'å…³äº / ABOUT'];\n    const optionY = height * 0.5;\n    const optionSpacing = 60;\n\n    options.forEach((option, index) => {\n      const y = optionY + index * optionSpacing;\n      const isSelected = index === selectedOption;\n      this.drawMenuButton(ctx, option, width / 2, y, isSelected);\n    });\n\n    // Draw controls hint\n    ctx.fillStyle = this.colors.textMuted;\n    ctx.font = this.smallFont;\n    ctx.textAlign = 'center';\n    ctx.fillText('â†‘â†“ é€‰æ‹© / Select   ENTER ç¡®è®¤ / Confirm', width / 2, height - 60);\n    ctx.fillText('WASD/æ–¹å‘é”® ç§»åŠ¨ | SPACE å°„å‡» | P æš‚åœ', width / 2, height - 35);\n\n    // Draw version\n    ctx.fillStyle = this.colors.textMuted;\n    ctx.font = this.smallFont;\n    ctx.textAlign = 'right';\n    ctx.fillText('v1.0.0', width - 15, height - 15);\n  }\n\n  /**\n   * Draw menu button with hover effect\n   * ç»˜åˆ¶å¸¦æ‚¬åœæ•ˆæœçš„èœå•æŒ‰é’®\n   */\n  private drawMenuButton(\n    ctx: CanvasRenderingContext2D,\n    text: string,\n    x: number,\n    y: number,\n    selected: boolean\n  ): void {\n    const buttonWidth = 280;\n    const buttonHeight = 45;\n    const bx = x - buttonWidth / 2;\n    const by = y - buttonHeight / 2;\n\n    ctx.save();\n\n    if (selected) {\n      // Selected button with glow\n      const pulse = Math.sin(this.time * 4) * 0.1 + 0.9;\n      \n      // Glow effect\n      ctx.shadowColor = this.colors.primary;\n      ctx.shadowBlur = 15 * pulse;\n      \n      // Button background\n      const gradient = ctx.createLinearGradient(bx, by, bx + buttonWidth, by + buttonHeight);\n      gradient.addColorStop(0, 'rgba(0, 212, 255, 0.3)');\n      gradient.addColorStop(0.5, 'rgba(0, 212, 255, 0.5)');\n      gradient.addColorStop(1, 'rgba(0, 212, 255, 0.3)');\n      ctx.fillStyle = gradient;\n      ctx.beginPath();\n      ctx.roundRect(bx, by, buttonWidth, buttonHeight, 8);\n      ctx.fill();\n\n      // Border\n      ctx.strokeStyle = this.colors.primary;\n      ctx.lineWidth = 2;\n      ctx.stroke();\n\n      // Selection indicator\n      ctx.fillStyle = this.colors.primary;\n      ctx.beginPath();\n      ctx.moveTo(bx - 20, y);\n      ctx.lineTo(bx - 8, y - 8);\n      ctx.lineTo(bx - 8, y + 8);\n      ctx.closePath();\n      ctx.fill();\n\n      // Text\n      ctx.fillStyle = this.colors.text;\n      ctx.font = this.buttonFont;\n      ctx.textAlign = 'center';\n      ctx.textBaseline = 'middle';\n      ctx.fillText(text, x, y);\n    } else {\n      // Unselected button\n      ctx.fillStyle = 'rgba(50, 50, 70, 0.5)';\n      ctx.beginPath();\n      ctx.roundRect(bx, by, buttonWidth, buttonHeight, 8);\n      ctx.fill();\n\n      ctx.strokeStyle = 'rgba(100, 100, 120, 0.5)';\n      ctx.lineWidth = 1;\n      ctx.stroke();\n\n      ctx.fillStyle = this.colors.textMuted;\n      ctx.font = '20px \"Segoe UI\", Arial, sans-serif';\n      ctx.textAlign = 'center';\n      ctx.textBaseline = 'middle';\n      ctx.fillText(text, x, y);\n    }\n\n    ctx.restore();\n  }\n\n  /**\n   * Render in-game HUD\n   * æ¸²æŸ“æ¸¸æˆä¸­çš„HUD\n   */\n  renderGameHUD(\n    ctx: CanvasRenderingContext2D,\n    scoreData: ScoreData,\n    health: number,\n    maxHealth: number,\n    weaponLevel: number\n  ): void {\n    const { width } = this.config.canvas;\n\n    ctx.save();\n\n    // Top bar background\n    const topBarGradient = ctx.createLinearGradient(0, 0, 0, 50);\n    topBarGradient.addColorStop(0, 'rgba(0, 0, 0, 0.7)');\n    topBarGradient.addColorStop(1, 'rgba(0, 0, 0, 0)');\n    ctx.fillStyle = topBarGradient;\n    ctx.fillRect(0, 0, width, 50);\n\n    // Score display (left side)\n    this.drawScoreDisplay(ctx, scoreData.currentScore, 15, 12);\n\n    // High score (center)\n    ctx.fillStyle = this.colors.accent;\n    ctx.font = this.smallFont;\n    ctx.textAlign = 'center';\n    ctx.fillText(`HIGH: ${scoreData.highScore}`, width / 2, 25);\n\n    // Health bar (right side)\n    this.drawHealthBar(ctx, health, maxHealth, width - 130, 10, 115, 18);\n\n    // Weapon level indicator\n    this.drawWeaponLevel(ctx, weaponLevel, width - 130, 35);\n\n    // Bottom bar with stats\n    const bottomBarGradient = ctx.createLinearGradient(0, this.config.canvas.height - 40, 0, this.config.canvas.height);\n    bottomBarGradient.addColorStop(0, 'rgba(0, 0, 0, 0)');\n    bottomBarGradient.addColorStop(1, 'rgba(0, 0, 0, 0.5)');\n    ctx.fillStyle = bottomBarGradient;\n    ctx.fillRect(0, this.config.canvas.height - 40, width, 40);\n\n    // Stats at bottom\n    ctx.fillStyle = this.colors.textMuted;\n    ctx.font = this.smallFont;\n    ctx.textAlign = 'left';\n    ctx.fillText(`å‡»æ¯: ${scoreData.enemiesDestroyed}`, 15, this.config.canvas.height - 15);\n    \n    ctx.textAlign = 'right';\n    ctx.fillText(`å‘½ä¸­ç‡: ${scoreData.accuracy}%`, width - 15, this.config.canvas.height - 15);\n\n    ctx.restore();\n  }\n\n  /**\n   * Draw score display with animation\n   * ç»˜åˆ¶å¸¦åŠ¨ç”»çš„åˆ†æ•°æ˜¾ç¤º\n   */\n  private drawScoreDisplay(ctx: CanvasRenderingContext2D, score: number, x: number, y: number): void {\n    // Score label\n    ctx.fillStyle = this.colors.textMuted;\n    ctx.font = this.smallFont;\n    ctx.textAlign = 'left';\n    ctx.fillText('SCORE', x, y + 8);\n\n    // Score value with glow\n    ctx.shadowColor = this.colors.accent;\n    ctx.shadowBlur = 5;\n    ctx.fillStyle = this.colors.text;\n    ctx.font = 'bold 24px \"Segoe UI\", Arial, sans-serif';\n    ctx.fillText(score.toLocaleString(), x, y + 32);\n    ctx.shadowBlur = 0;\n  }\n\n  /**\n   * Draw health bar\n   * ç»˜åˆ¶ç”Ÿå‘½å€¼æ¡\n   */\n  private drawHealthBar(\n    ctx: CanvasRenderingContext2D,\n    health: number,\n    maxHealth: number,\n    x: number,\n    y: number,\n    width: number,\n    height: number\n  ): void {\n    const healthPercent = health / maxHealth;\n    const healthColor = healthPercent > 0.5 ? this.colors.success : \n                        healthPercent > 0.25 ? this.colors.accent : this.colors.danger;\n\n    // Background\n    ctx.fillStyle = 'rgba(50, 50, 50, 0.8)';\n    ctx.beginPath();\n    ctx.roundRect(x, y, width, height, 4);\n    ctx.fill();\n\n    // Health fill with gradient\n    if (healthPercent > 0) {\n      const healthGradient = ctx.createLinearGradient(x, y, x, y + height);\n      healthGradient.addColorStop(0, healthColor);\n      healthGradient.addColorStop(1, this.adjustColor(healthColor, -30));\n      ctx.fillStyle = healthGradient;\n      ctx.beginPath();\n      ctx.roundRect(x + 2, y + 2, (width - 4) * healthPercent, height - 4, 2);\n      ctx.fill();\n    }\n\n    // Border\n    ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';\n    ctx.lineWidth = 1;\n    ctx.beginPath();\n    ctx.roundRect(x, y, width, height, 4);\n    ctx.stroke();\n\n    // Health text\n    ctx.fillStyle = this.colors.text;\n    ctx.font = 'bold 12px \"Segoe UI\", Arial, sans-serif';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillText(`${health}/${maxHealth}`, x + width / 2, y + height / 2);\n  }\n\n  /**\n   * Draw weapon level indicator\n   * ç»˜åˆ¶æ­¦å™¨ç­‰çº§æŒ‡ç¤ºå™¨\n   */\n  private drawWeaponLevel(ctx: CanvasRenderingContext2D, level: number, x: number, y: number): void {\n    ctx.fillStyle = this.colors.textMuted;\n    ctx.font = this.smallFont;\n    ctx.textAlign = 'left';\n    ctx.fillText('WEAPON:', x, y);\n\n    // Draw level indicators\n    for (let i = 1; i <= 3; i++) {\n      const indicatorX = x + 60 + (i - 1) * 18;\n      if (i <= level) {\n        ctx.fillStyle = this.colors.accent;\n        ctx.shadowColor = this.colors.accent;\n        ctx.shadowBlur = 5;\n      } else {\n        ctx.fillStyle = 'rgba(100, 100, 100, 0.5)';\n        ctx.shadowBlur = 0;\n      }\n      ctx.beginPath();\n      ctx.arc(indicatorX, y - 4, 6, 0, Math.PI * 2);\n      ctx.fill();\n    }\n    ctx.shadowBlur = 0;\n  }\n\n  /**\n   * Render pause screen\n   * æ¸²æŸ“æš‚åœç•Œé¢\n   */\n  renderPauseScreen(ctx: CanvasRenderingContext2D, selectedOption: number = 0): void {\n    const { width, height } = this.config.canvas;\n\n    // Dark overlay\n    ctx.fillStyle = 'rgba(0, 0, 0, 0.75)';\n    ctx.fillRect(0, 0, width, height);\n\n    // Pause panel\n    const panelWidth = 320;\n    const panelHeight = 280;\n    const panelX = (width - panelWidth) / 2;\n    const panelY = (height - panelHeight) / 2;\n\n    this.drawPanel(ctx, panelX, panelY, panelWidth, panelHeight);\n\n    // Title\n    this.drawGlowText(ctx, 'PAUSED', width / 2, panelY + 50, {\n      font: 'bold 36px \"Segoe UI\", Arial, sans-serif',\n      color: this.colors.text,\n      glowColor: this.colors.primary,\n      glowSize: 10\n    });\n\n    ctx.fillStyle = this.colors.textMuted;\n    ctx.font = this.subtitleFont;\n    ctx.textAlign = 'center';\n    ctx.fillText('æ¸¸æˆæš‚åœ', width / 2, panelY + 85);\n\n    // Options\n    const options = ['ç»§ç»­æ¸¸æˆ / RESUME', 'é‡æ–°å¼€å§‹ / RESTART', 'è¿”å›èœå• / MAIN MENU'];\n    const optionY = panelY + 130;\n    const optionSpacing = 50;\n\n    options.forEach((option, index) => {\n      const y = optionY + index * optionSpacing;\n      const isSelected = index === selectedOption;\n      this.drawMenuButton(ctx, option, width / 2, y, isSelected);\n    });\n  }\n\n  /**\n   * Render game over screen\n   * æ¸²æŸ“æ¸¸æˆç»“æŸç•Œé¢\n   */\n  renderGameOverScreen(\n    ctx: CanvasRenderingContext2D,\n    scoreData: ScoreData,\n    isNewHighScore: boolean,\n    selectedOption: number = 0\n  ): void {\n    const { width, height } = this.config.canvas;\n\n    // Dark overlay with red tint\n    const overlay = ctx.createRadialGradient(width / 2, height / 2, 0, width / 2, height / 2, width);\n    overlay.addColorStop(0, 'rgba(50, 0, 0, 0.8)');\n    overlay.addColorStop(1, 'rgba(0, 0, 0, 0.9)');\n    ctx.fillStyle = overlay;\n    ctx.fillRect(0, 0, width, height);\n\n    // Game Over title\n    this.drawGlowText(ctx, 'GAME OVER', width / 2, height * 0.2, {\n      font: 'bold 52px \"Segoe UI\", Arial, sans-serif',\n      color: this.colors.secondary,\n      glowColor: this.colors.secondary,\n      glowSize: 25\n    });\n\n    ctx.fillStyle = this.colors.textMuted;\n    ctx.font = this.subtitleFont;\n    ctx.textAlign = 'center';\n    ctx.fillText('æ¸¸æˆç»“æŸ', width / 2, height * 0.2 + 50);\n\n    // Score panel\n    const panelY = height * 0.35;\n    this.drawPanel(ctx, width / 2 - 150, panelY, 300, 150);\n\n    // Final score\n    ctx.fillStyle = this.colors.textMuted;\n    ctx.font = this.textFont;\n    ctx.fillText('æœ€ç»ˆå¾—åˆ† / FINAL SCORE', width / 2, panelY + 35);\n\n    ctx.fillStyle = this.colors.text;\n    ctx.font = 'bold 42px \"Segoe UI\", Arial, sans-serif';\n    ctx.fillText(scoreData.currentScore.toLocaleString(), width / 2, panelY + 80);\n\n    // New high score indicator\n    if (isNewHighScore) {\n      const pulse = Math.sin(this.time * 5) * 0.3 + 0.7;\n      ctx.fillStyle = `rgba(255, 215, 0, ${pulse})`;\n      ctx.font = 'bold 18px \"Segoe UI\", Arial, sans-serif';\n      ctx.fillText('ğŸ‰ NEW HIGH SCORE! æ–°çºªå½•! ğŸ‰', width / 2, panelY + 115);\n    } else {\n      ctx.fillStyle = this.colors.accent;\n      ctx.font = this.smallFont;\n      ctx.fillText(`æœ€é«˜åˆ†: ${scoreData.highScore}`, width / 2, panelY + 115);\n    }\n\n    // Stats\n    ctx.fillStyle = this.colors.textMuted;\n    ctx.font = this.smallFont;\n    ctx.fillText(`å‡»æ¯æ•Œæœº: ${scoreData.enemiesDestroyed} | å‘½ä¸­ç‡: ${scoreData.accuracy}%`, \n                 width / 2, panelY + 140);\n\n    // Options\n    const options = ['é‡æ–°å¼€å§‹ / RESTART', 'è¿”å›èœå• / MAIN MENU'];\n    const optionY = height * 0.72;\n    const optionSpacing = 55;\n\n    options.forEach((option, index) => {\n      const y = optionY + index * optionSpacing;\n      const isSelected = index === selectedOption;\n      this.drawMenuButton(ctx, option, width / 2, y, isSelected);\n    });\n  }\n\n  /**\n   * Draw a panel with border and background\n   * ç»˜åˆ¶å¸¦è¾¹æ¡†å’ŒèƒŒæ™¯çš„é¢æ¿\n   */\n  private drawPanel(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number\n  ): void {\n    ctx.save();\n\n    // Panel background\n    const gradient = ctx.createLinearGradient(x, y, x, y + height);\n    gradient.addColorStop(0, 'rgba(30, 40, 60, 0.95)');\n    gradient.addColorStop(1, 'rgba(20, 30, 50, 0.95)');\n    ctx.fillStyle = gradient;\n    ctx.beginPath();\n    ctx.roundRect(x, y, width, height, 12);\n    ctx.fill();\n\n    // Border\n    ctx.strokeStyle = 'rgba(100, 150, 200, 0.3)';\n    ctx.lineWidth = 2;\n    ctx.stroke();\n\n    // Inner glow\n    ctx.strokeStyle = 'rgba(100, 150, 200, 0.1)';\n    ctx.lineWidth = 4;\n    ctx.beginPath();\n    ctx.roundRect(x + 4, y + 4, width - 8, height - 8, 8);\n    ctx.stroke();\n\n    ctx.restore();\n  }\n\n  /**\n   * Draw text with glow effect\n   * ç»˜åˆ¶å¸¦å‘å…‰æ•ˆæœçš„æ–‡å­—\n   */\n  private drawGlowText(\n    ctx: CanvasRenderingContext2D,\n    text: string,\n    x: number,\n    y: number,\n    options: {\n      font: string;\n      color: string;\n      glowColor: string;\n      glowSize: number;\n    }\n  ): void {\n    ctx.save();\n    ctx.font = options.font;\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n\n    // Glow layers\n    ctx.shadowColor = options.glowColor;\n    ctx.shadowBlur = options.glowSize;\n    ctx.fillStyle = options.color;\n    \n    // Draw multiple times for stronger glow\n    for (let i = 0; i < 3; i++) {\n      ctx.fillText(text, x, y);\n    }\n\n    ctx.restore();\n  }\n\n  /**\n   * Draw animated decorative line\n   * ç»˜åˆ¶åŠ¨ç”»è£…é¥°çº¿\n   */\n  private drawAnimatedLine(ctx: CanvasRenderingContext2D, x: number, y: number, width: number): void {\n    const progress = (Math.sin(this.time * 2) + 1) / 2;\n    \n    ctx.save();\n    \n    // Base line\n    ctx.strokeStyle = 'rgba(100, 150, 200, 0.3)';\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.moveTo(x, y);\n    ctx.lineTo(x + width, y);\n    ctx.stroke();\n\n    // Animated highlight\n    const highlightWidth = width * 0.3;\n    const highlightX = x + (width - highlightWidth) * progress;\n    \n    const gradient = ctx.createLinearGradient(highlightX, y, highlightX + highlightWidth, y);\n    gradient.addColorStop(0, 'rgba(0, 212, 255, 0)');\n    gradient.addColorStop(0.5, 'rgba(0, 212, 255, 0.8)');\n    gradient.addColorStop(1, 'rgba(0, 212, 255, 0)');\n    \n    ctx.strokeStyle = gradient;\n    ctx.lineWidth = 3;\n    ctx.beginPath();\n    ctx.moveTo(highlightX, y);\n    ctx.lineTo(highlightX + highlightWidth, y);\n    ctx.stroke();\n\n    ctx.restore();\n  }\n\n  /**\n   * Adjust color brightness\n   * è°ƒæ•´é¢œè‰²äº®åº¦\n   */\n  private adjustColor(color: string, amount: number): string {\n    const hex = color.replace('#', '');\n    const r = Math.max(0, Math.min(255, parseInt(hex.substr(0, 2), 16) + amount));\n    const g = Math.max(0, Math.min(255, parseInt(hex.substr(2, 2), 16) + amount));\n    const b = Math.max(0, Math.min(255, parseInt(hex.substr(4, 2), 16) + amount));\n    return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;\n  }\n\n  /**\n   * Check if a point is inside a button\n   * æ£€æŸ¥ç‚¹æ˜¯å¦åœ¨æŒ‰é’®å†…\n   */\n  isPointInButton(px: number, py: number, button: ButtonState): boolean {\n    return px >= button.x && px <= button.x + button.width &&\n           py >= button.y && py <= button.y + button.height;\n  }\n}\n","/**\n * SpriteManager Class\n * ç²¾çµç®¡ç†å™¨ç±»\n * \n * Manages sprite generation and caching for game entities.\n * Uses Canvas-based procedural generation for placeholder sprites.\n * ç®¡ç†æ¸¸æˆå®ä½“çš„ç²¾çµç”Ÿæˆå’Œç¼“å­˜ã€‚ä½¿ç”¨Canvasç¨‹åºåŒ–ç”Ÿæˆå ä½ç²¾çµã€‚\n */\nimport { EnemyType, PowerUpType } from '../types/enums';\n\n/**\n * Sprite Type Enum\n * ç²¾çµç±»å‹æšä¸¾\n */\nexport enum SpriteType {\n  PLAYER = 'player',\n  ENEMY_BASIC = 'enemy_basic',\n  ENEMY_SHOOTER = 'enemy_shooter',\n  ENEMY_ZIGZAG = 'enemy_zigzag',\n  ENEMY_BOSS = 'enemy_boss',\n  BULLET_PLAYER = 'bullet_player',\n  BULLET_ENEMY = 'bullet_enemy',\n  POWERUP_WEAPON = 'powerup_weapon',\n  POWERUP_HEALTH = 'powerup_health',\n  POWERUP_SHIELD = 'powerup_shield',\n  EXPLOSION_1 = 'explosion_1',\n  EXPLOSION_2 = 'explosion_2',\n  EXPLOSION_3 = 'explosion_3',\n  EXPLOSION_4 = 'explosion_4'\n}\n\n/**\n * Sprite Definition Interface\n * ç²¾çµå®šä¹‰æ¥å£\n */\nexport interface SpriteDefinition {\n  width: number;\n  height: number;\n  canvas: HTMLCanvasElement;\n}\n\n/**\n * SpriteManager Class\n * ç²¾çµç®¡ç†å™¨\n */\nexport class SpriteManager {\n  private sprites: Map<SpriteType, SpriteDefinition> = new Map();\n  private initialized: boolean = false;\n\n  constructor() {}\n\n  /**\n   * Initialize all sprites\n   * åˆå§‹åŒ–æ‰€æœ‰ç²¾çµ\n   */\n  initialize(): void {\n    if (this.initialized) return;\n\n    // Generate player sprite\n    this.generatePlayerSprite();\n    \n    // Generate enemy sprites\n    this.generateEnemySprites();\n    \n    // Generate bullet sprites\n    this.generateBulletSprites();\n    \n    // Generate power-up sprites\n    this.generatePowerUpSprites();\n    \n    // Generate explosion sprites\n    this.generateExplosionSprites();\n\n    this.initialized = true;\n  }\n\n  /**\n   * Get a sprite by type\n   * æ ¹æ®ç±»å‹è·å–ç²¾çµ\n   */\n  getSprite(type: SpriteType): SpriteDefinition | undefined {\n    return this.sprites.get(type);\n  }\n\n  /**\n   * Get enemy sprite by enemy type\n   * æ ¹æ®æ•Œæœºç±»å‹è·å–ç²¾çµ\n   */\n  getEnemySprite(enemyType: EnemyType): SpriteDefinition | undefined {\n    switch (enemyType) {\n      case EnemyType.BASIC:\n        return this.sprites.get(SpriteType.ENEMY_BASIC);\n      case EnemyType.SHOOTER:\n        return this.sprites.get(SpriteType.ENEMY_SHOOTER);\n      case EnemyType.ZIGZAG:\n        return this.sprites.get(SpriteType.ENEMY_ZIGZAG);\n      case EnemyType.BOSS:\n        return this.sprites.get(SpriteType.ENEMY_BOSS);\n      default:\n        return this.sprites.get(SpriteType.ENEMY_BASIC);\n    }\n  }\n\n  /**\n   * Get power-up sprite by type\n   * æ ¹æ®é“å…·ç±»å‹è·å–ç²¾çµ\n   */\n  getPowerUpSprite(powerUpType: PowerUpType): SpriteDefinition | undefined {\n    switch (powerUpType) {\n      case PowerUpType.WEAPON_UPGRADE:\n        return this.sprites.get(SpriteType.POWERUP_WEAPON);\n      case PowerUpType.HEALTH:\n        return this.sprites.get(SpriteType.POWERUP_HEALTH);\n      case PowerUpType.SHIELD:\n        return this.sprites.get(SpriteType.POWERUP_SHIELD);\n      default:\n        return this.sprites.get(SpriteType.POWERUP_WEAPON);\n    }\n  }\n\n  /**\n   * Generate player aircraft sprite\n   * ç”Ÿæˆç©å®¶é£æœºç²¾çµ\n   */\n  private generatePlayerSprite(): void {\n    const width = 48;\n    const height = 64;\n    const canvas = this.createCanvas(width, height);\n    const ctx = canvas.getContext('2d')!;\n\n    // Main body gradient\n    const bodyGradient = ctx.createLinearGradient(0, 0, width, height);\n    bodyGradient.addColorStop(0, '#00d4ff');\n    bodyGradient.addColorStop(0.5, '#0099cc');\n    bodyGradient.addColorStop(1, '#006699');\n\n    // Draw main body (sleek fighter shape)\n    ctx.fillStyle = bodyGradient;\n    ctx.beginPath();\n    ctx.moveTo(width / 2, 0); // Nose\n    ctx.lineTo(width * 0.85, height * 0.3); // Right front\n    ctx.lineTo(width, height * 0.6); // Right wing tip\n    ctx.lineTo(width * 0.7, height * 0.7); // Right wing back\n    ctx.lineTo(width * 0.6, height); // Right tail\n    ctx.lineTo(width * 0.4, height); // Left tail\n    ctx.lineTo(width * 0.3, height * 0.7); // Left wing back\n    ctx.lineTo(0, height * 0.6); // Left wing tip\n    ctx.lineTo(width * 0.15, height * 0.3); // Left front\n    ctx.closePath();\n    ctx.fill();\n\n    // Cockpit\n    const cockpitGradient = ctx.createRadialGradient(\n      width / 2, height * 0.35, 0,\n      width / 2, height * 0.35, 10\n    );\n    cockpitGradient.addColorStop(0, '#ffffff');\n    cockpitGradient.addColorStop(0.5, '#87ceeb');\n    cockpitGradient.addColorStop(1, '#4169e1');\n    ctx.fillStyle = cockpitGradient;\n    ctx.beginPath();\n    ctx.ellipse(width / 2, height * 0.35, 8, 12, 0, 0, Math.PI * 2);\n    ctx.fill();\n\n    // Engine glow\n    ctx.fillStyle = '#ff6600';\n    ctx.beginPath();\n    ctx.ellipse(width * 0.35, height - 3, 4, 6, 0, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.beginPath();\n    ctx.ellipse(width * 0.65, height - 3, 4, 6, 0, 0, Math.PI * 2);\n    ctx.fill();\n\n    // Highlight\n    ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';\n    ctx.lineWidth = 1;\n    ctx.beginPath();\n    ctx.moveTo(width / 2, 5);\n    ctx.lineTo(width * 0.3, height * 0.4);\n    ctx.stroke();\n\n    this.sprites.set(SpriteType.PLAYER, { width, height, canvas });\n  }\n\n  /**\n   * Generate enemy aircraft sprites\n   * ç”Ÿæˆæ•Œæœºç²¾çµ\n   */\n  private generateEnemySprites(): void {\n    // Basic enemy (red triangle)\n    this.generateBasicEnemySprite();\n    \n    // Shooter enemy (orange diamond)\n    this.generateShooterEnemySprite();\n    \n    // Zigzag enemy (purple hexagon)\n    this.generateZigzagEnemySprite();\n    \n    // Boss enemy (large red ship)\n    this.generateBossEnemySprite();\n  }\n\n  private generateBasicEnemySprite(): void {\n    const width = 32;\n    const height = 32;\n    const canvas = this.createCanvas(width, height);\n    const ctx = canvas.getContext('2d')!;\n\n    const gradient = ctx.createLinearGradient(0, 0, width, height);\n    gradient.addColorStop(0, '#ff6b6b');\n    gradient.addColorStop(1, '#cc4444');\n\n    ctx.fillStyle = gradient;\n    ctx.beginPath();\n    ctx.moveTo(width / 2, height); // Bottom center\n    ctx.lineTo(0, 0); // Top left\n    ctx.lineTo(width, 0); // Top right\n    ctx.closePath();\n    ctx.fill();\n\n    // Eye/cockpit\n    ctx.fillStyle = '#ffff00';\n    ctx.beginPath();\n    ctx.arc(width / 2, height * 0.4, 4, 0, Math.PI * 2);\n    ctx.fill();\n\n    this.sprites.set(SpriteType.ENEMY_BASIC, { width, height, canvas });\n  }\n\n  private generateShooterEnemySprite(): void {\n    const width = 36;\n    const height = 40;\n    const canvas = this.createCanvas(width, height);\n    const ctx = canvas.getContext('2d')!;\n\n    const gradient = ctx.createLinearGradient(0, 0, width, height);\n    gradient.addColorStop(0, '#ffa500');\n    gradient.addColorStop(1, '#cc7700');\n\n    ctx.fillStyle = gradient;\n    ctx.beginPath();\n    ctx.moveTo(width / 2, 0); // Top\n    ctx.lineTo(width, height / 2); // Right\n    ctx.lineTo(width / 2, height); // Bottom\n    ctx.lineTo(0, height / 2); // Left\n    ctx.closePath();\n    ctx.fill();\n\n    // Cannon\n    ctx.fillStyle = '#ff4500';\n    ctx.fillRect(width / 2 - 4, height - 8, 8, 10);\n\n    // Eye\n    ctx.fillStyle = '#ffffff';\n    ctx.beginPath();\n    ctx.arc(width / 2, height * 0.4, 5, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.fillStyle = '#000000';\n    ctx.beginPath();\n    ctx.arc(width / 2, height * 0.4, 2, 0, Math.PI * 2);\n    ctx.fill();\n\n    this.sprites.set(SpriteType.ENEMY_SHOOTER, { width, height, canvas });\n  }\n\n  private generateZigzagEnemySprite(): void {\n    const width = 36;\n    const height = 36;\n    const canvas = this.createCanvas(width, height);\n    const ctx = canvas.getContext('2d')!;\n\n    const gradient = ctx.createLinearGradient(0, 0, width, height);\n    gradient.addColorStop(0, '#9b59b6');\n    gradient.addColorStop(1, '#6c3483');\n\n    ctx.fillStyle = gradient;\n    ctx.beginPath();\n    ctx.moveTo(width * 0.3, 0);\n    ctx.lineTo(width * 0.7, 0);\n    ctx.lineTo(width, height * 0.4);\n    ctx.lineTo(width * 0.8, height);\n    ctx.lineTo(width * 0.2, height);\n    ctx.lineTo(0, height * 0.4);\n    ctx.closePath();\n    ctx.fill();\n\n    // Glowing core\n    const coreGradient = ctx.createRadialGradient(\n      width / 2, height / 2, 0,\n      width / 2, height / 2, 8\n    );\n    coreGradient.addColorStop(0, '#ffffff');\n    coreGradient.addColorStop(0.5, '#e74c3c');\n    coreGradient.addColorStop(1, '#9b59b6');\n    ctx.fillStyle = coreGradient;\n    ctx.beginPath();\n    ctx.arc(width / 2, height / 2, 8, 0, Math.PI * 2);\n    ctx.fill();\n\n    this.sprites.set(SpriteType.ENEMY_ZIGZAG, { width, height, canvas });\n  }\n\n  private generateBossEnemySprite(): void {\n    const width = 96;\n    const height = 80;\n    const canvas = this.createCanvas(width, height);\n    const ctx = canvas.getContext('2d')!;\n\n    // Main body gradient\n    const bodyGradient = ctx.createLinearGradient(0, 0, width, height);\n    bodyGradient.addColorStop(0, '#8b0000');\n    bodyGradient.addColorStop(0.5, '#cc0000');\n    bodyGradient.addColorStop(1, '#660000');\n\n    // Main body\n    ctx.fillStyle = bodyGradient;\n    ctx.beginPath();\n    ctx.moveTo(width / 2, height); // Bottom center\n    ctx.lineTo(0, height * 0.3); // Left wing\n    ctx.lineTo(width * 0.2, 0); // Top left\n    ctx.lineTo(width * 0.8, 0); // Top right\n    ctx.lineTo(width, height * 0.3); // Right wing\n    ctx.closePath();\n    ctx.fill();\n\n    // Wing details\n    ctx.fillStyle = '#4a0000';\n    ctx.beginPath();\n    ctx.moveTo(0, height * 0.35);\n    ctx.lineTo(width * 0.25, height * 0.5);\n    ctx.lineTo(width * 0.15, height * 0.7);\n    ctx.closePath();\n    ctx.fill();\n    ctx.beginPath();\n    ctx.moveTo(width, height * 0.35);\n    ctx.lineTo(width * 0.75, height * 0.5);\n    ctx.lineTo(width * 0.85, height * 0.7);\n    ctx.closePath();\n    ctx.fill();\n\n    // Cockpit\n    const cockpitGradient = ctx.createRadialGradient(\n      width / 2, height * 0.35, 0,\n      width / 2, height * 0.35, 15\n    );\n    cockpitGradient.addColorStop(0, '#ff0000');\n    cockpitGradient.addColorStop(0.7, '#990000');\n    cockpitGradient.addColorStop(1, '#660000');\n    ctx.fillStyle = cockpitGradient;\n    ctx.beginPath();\n    ctx.ellipse(width / 2, height * 0.35, 15, 12, 0, 0, Math.PI * 2);\n    ctx.fill();\n\n    // Cannons\n    ctx.fillStyle = '#333333';\n    ctx.fillRect(width * 0.3 - 4, height - 10, 8, 12);\n    ctx.fillRect(width * 0.5 - 4, height - 10, 8, 12);\n    ctx.fillRect(width * 0.7 - 4, height - 10, 8, 12);\n\n    this.sprites.set(SpriteType.ENEMY_BOSS, { width, height, canvas });\n  }\n\n  /**\n   * Generate bullet sprites\n   * ç”Ÿæˆå­å¼¹ç²¾çµ\n   */\n  private generateBulletSprites(): void {\n    // Player bullet (yellow/gold)\n    const playerWidth = 6;\n    const playerHeight = 16;\n    const playerCanvas = this.createCanvas(playerWidth, playerHeight);\n    const playerCtx = playerCanvas.getContext('2d')!;\n\n    const playerGradient = playerCtx.createLinearGradient(0, 0, playerWidth, 0);\n    playerGradient.addColorStop(0, '#ffcc00');\n    playerGradient.addColorStop(0.5, '#ffff00');\n    playerGradient.addColorStop(1, '#ffcc00');\n\n    playerCtx.fillStyle = playerGradient;\n    playerCtx.beginPath();\n    playerCtx.roundRect(0, 0, playerWidth, playerHeight, 3);\n    playerCtx.fill();\n\n    // Glow effect\n    playerCtx.shadowColor = '#ffff00';\n    playerCtx.shadowBlur = 5;\n    playerCtx.fill();\n\n    this.sprites.set(SpriteType.BULLET_PLAYER, { \n      width: playerWidth, \n      height: playerHeight, \n      canvas: playerCanvas \n    });\n\n    // Enemy bullet (red)\n    const enemyWidth = 8;\n    const enemyHeight = 8;\n    const enemyCanvas = this.createCanvas(enemyWidth, enemyHeight);\n    const enemyCtx = enemyCanvas.getContext('2d')!;\n\n    const enemyGradient = enemyCtx.createRadialGradient(\n      enemyWidth / 2, enemyHeight / 2, 0,\n      enemyWidth / 2, enemyHeight / 2, enemyWidth / 2\n    );\n    enemyGradient.addColorStop(0, '#ffffff');\n    enemyGradient.addColorStop(0.3, '#ff6666');\n    enemyGradient.addColorStop(1, '#ff0000');\n\n    enemyCtx.fillStyle = enemyGradient;\n    enemyCtx.beginPath();\n    enemyCtx.arc(enemyWidth / 2, enemyHeight / 2, enemyWidth / 2, 0, Math.PI * 2);\n    enemyCtx.fill();\n\n    this.sprites.set(SpriteType.BULLET_ENEMY, { \n      width: enemyWidth, \n      height: enemyHeight, \n      canvas: enemyCanvas \n    });\n  }\n\n  /**\n   * Generate power-up sprites\n   * ç”Ÿæˆé“å…·ç²¾çµ\n   */\n  private generatePowerUpSprites(): void {\n    const size = 28;\n\n    // Weapon upgrade (golden star)\n    const weaponCanvas = this.createCanvas(size, size);\n    const weaponCtx = weaponCanvas.getContext('2d')!;\n    this.drawStar(weaponCtx, size / 2, size / 2, 5, size / 2, size / 4, '#ffd700', '#ffaa00');\n    this.sprites.set(SpriteType.POWERUP_WEAPON, { width: size, height: size, canvas: weaponCanvas });\n\n    // Health (green cross)\n    const healthCanvas = this.createCanvas(size, size);\n    const healthCtx = healthCanvas.getContext('2d')!;\n    this.drawHealthCross(healthCtx, size);\n    this.sprites.set(SpriteType.POWERUP_HEALTH, { width: size, height: size, canvas: healthCanvas });\n\n    // Shield (blue shield)\n    const shieldCanvas = this.createCanvas(size, size);\n    const shieldCtx = shieldCanvas.getContext('2d')!;\n    this.drawShield(shieldCtx, size);\n    this.sprites.set(SpriteType.POWERUP_SHIELD, { width: size, height: size, canvas: shieldCanvas });\n  }\n\n  private drawStar(\n    ctx: CanvasRenderingContext2D,\n    cx: number, cy: number,\n    spikes: number,\n    outerRadius: number,\n    innerRadius: number,\n    fillColor: string,\n    strokeColor: string\n  ): void {\n    ctx.beginPath();\n    for (let i = 0; i < spikes * 2; i++) {\n      const radius = i % 2 === 0 ? outerRadius : innerRadius;\n      const angle = (i * Math.PI) / spikes - Math.PI / 2;\n      const x = cx + Math.cos(angle) * radius;\n      const y = cy + Math.sin(angle) * radius;\n      if (i === 0) ctx.moveTo(x, y);\n      else ctx.lineTo(x, y);\n    }\n    ctx.closePath();\n    \n    const gradient = ctx.createRadialGradient(cx, cy, 0, cx, cy, outerRadius);\n    gradient.addColorStop(0, '#ffffff');\n    gradient.addColorStop(0.3, fillColor);\n    gradient.addColorStop(1, strokeColor);\n    ctx.fillStyle = gradient;\n    ctx.fill();\n    \n    ctx.strokeStyle = strokeColor;\n    ctx.lineWidth = 1;\n    ctx.stroke();\n  }\n\n  private drawHealthCross(ctx: CanvasRenderingContext2D, size: number): void {\n    const crossWidth = size * 0.35;\n    const crossLength = size * 0.85;\n    const offset = (size - crossLength) / 2;\n    const widthOffset = (size - crossWidth) / 2;\n\n    // Background circle\n    const bgGradient = ctx.createRadialGradient(size/2, size/2, 0, size/2, size/2, size/2);\n    bgGradient.addColorStop(0, '#ffffff');\n    bgGradient.addColorStop(0.7, '#00ff00');\n    bgGradient.addColorStop(1, '#00aa00');\n    ctx.fillStyle = bgGradient;\n    ctx.beginPath();\n    ctx.arc(size / 2, size / 2, size / 2 - 2, 0, Math.PI * 2);\n    ctx.fill();\n\n    // Cross\n    ctx.fillStyle = '#ffffff';\n    ctx.fillRect(widthOffset, offset, crossWidth, crossLength);\n    ctx.fillRect(offset, widthOffset, crossLength, crossWidth);\n  }\n\n  private drawShield(ctx: CanvasRenderingContext2D, size: number): void {\n    const cx = size / 2;\n    const cy = size / 2;\n\n    // Outer glow\n    const glowGradient = ctx.createRadialGradient(cx, cy, 0, cx, cy, size / 2);\n    glowGradient.addColorStop(0, 'rgba(65, 105, 225, 0.8)');\n    glowGradient.addColorStop(0.7, 'rgba(65, 105, 225, 0.4)');\n    glowGradient.addColorStop(1, 'rgba(65, 105, 225, 0)');\n    ctx.fillStyle = glowGradient;\n    ctx.beginPath();\n    ctx.arc(cx, cy, size / 2, 0, Math.PI * 2);\n    ctx.fill();\n\n    // Shield shape\n    const shieldGradient = ctx.createLinearGradient(0, 0, size, size);\n    shieldGradient.addColorStop(0, '#87ceeb');\n    shieldGradient.addColorStop(0.5, '#4169e1');\n    shieldGradient.addColorStop(1, '#1e3a8a');\n    ctx.fillStyle = shieldGradient;\n    ctx.beginPath();\n    ctx.moveTo(cx, cy - size * 0.35);\n    ctx.lineTo(cx + size * 0.3, cy - size * 0.15);\n    ctx.lineTo(cx + size * 0.3, cy + size * 0.1);\n    ctx.lineTo(cx, cy + size * 0.35);\n    ctx.lineTo(cx - size * 0.3, cy + size * 0.1);\n    ctx.lineTo(cx - size * 0.3, cy - size * 0.15);\n    ctx.closePath();\n    ctx.fill();\n    ctx.strokeStyle = '#ffffff';\n    ctx.lineWidth = 2;\n    ctx.stroke();\n  }\n\n  /**\n   * Generate explosion animation sprites\n   * ç”Ÿæˆçˆ†ç‚¸åŠ¨ç”»ç²¾çµ\n   */\n  private generateExplosionSprites(): void {\n    const size = 64;\n    const frames = [\n      { radius: 0.2, alpha: 1.0, colors: ['#ffffff', '#ffff00', '#ff6600'] },\n      { radius: 0.5, alpha: 0.9, colors: ['#ffff00', '#ff6600', '#ff0000'] },\n      { radius: 0.8, alpha: 0.6, colors: ['#ff6600', '#ff0000', '#990000'] },\n      { radius: 1.0, alpha: 0.3, colors: ['#ff0000', '#990000', '#330000'] }\n    ];\n\n    const spriteTypes = [\n      SpriteType.EXPLOSION_1,\n      SpriteType.EXPLOSION_2,\n      SpriteType.EXPLOSION_3,\n      SpriteType.EXPLOSION_4\n    ];\n\n    frames.forEach((frame, index) => {\n      const canvas = this.createCanvas(size, size);\n      const ctx = canvas.getContext('2d')!;\n      \n      const cx = size / 2;\n      const cy = size / 2;\n      const maxRadius = (size / 2) * frame.radius;\n\n      // Outer glow\n      const glowGradient = ctx.createRadialGradient(cx, cy, 0, cx, cy, maxRadius * 1.5);\n      glowGradient.addColorStop(0, `rgba(255, 200, 0, ${frame.alpha * 0.5})`);\n      glowGradient.addColorStop(1, 'rgba(255, 100, 0, 0)');\n      ctx.fillStyle = glowGradient;\n      ctx.beginPath();\n      ctx.arc(cx, cy, maxRadius * 1.5, 0, Math.PI * 2);\n      ctx.fill();\n\n      // Main explosion\n      const mainGradient = ctx.createRadialGradient(cx, cy, 0, cx, cy, maxRadius);\n      mainGradient.addColorStop(0, frame.colors[0]);\n      mainGradient.addColorStop(0.5, frame.colors[1]);\n      mainGradient.addColorStop(1, frame.colors[2]);\n      ctx.globalAlpha = frame.alpha;\n      ctx.fillStyle = mainGradient;\n      ctx.beginPath();\n      ctx.arc(cx, cy, maxRadius, 0, Math.PI * 2);\n      ctx.fill();\n\n      // Sparks\n      ctx.globalAlpha = frame.alpha * 0.8;\n      for (let i = 0; i < 8; i++) {\n        const angle = (i / 8) * Math.PI * 2;\n        const sparkRadius = maxRadius * (0.8 + Math.random() * 0.4);\n        const sparkX = cx + Math.cos(angle) * sparkRadius;\n        const sparkY = cy + Math.sin(angle) * sparkRadius;\n        \n        ctx.fillStyle = frame.colors[Math.floor(Math.random() * frame.colors.length)];\n        ctx.beginPath();\n        ctx.arc(sparkX, sparkY, 3 + Math.random() * 3, 0, Math.PI * 2);\n        ctx.fill();\n      }\n\n      ctx.globalAlpha = 1;\n      this.sprites.set(spriteTypes[index], { width: size, height: size, canvas });\n    });\n  }\n\n  /**\n   * Create a canvas element\n   * åˆ›å»ºç”»å¸ƒå…ƒç´ \n   */\n  private createCanvas(width: number, height: number): HTMLCanvasElement {\n    const canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    return canvas;\n  }\n\n  /**\n   * Draw a sprite to a context\n   * å°†ç²¾çµç»˜åˆ¶åˆ°ä¸Šä¸‹æ–‡\n   */\n  drawSprite(\n    ctx: CanvasRenderingContext2D,\n    type: SpriteType,\n    x: number,\n    y: number,\n    width?: number,\n    height?: number\n  ): void {\n    const sprite = this.sprites.get(type);\n    if (!sprite) return;\n\n    const drawWidth = width ?? sprite.width;\n    const drawHeight = height ?? sprite.height;\n    ctx.drawImage(sprite.canvas, x, y, drawWidth, drawHeight);\n  }\n\n  /**\n   * Check if sprites are initialized\n   * æ£€æŸ¥ç²¾çµæ˜¯å¦å·²åˆå§‹åŒ–\n   */\n  isInitialized(): boolean {\n    return this.initialized;\n  }\n}\n","/**\n * PlayerAircraft Class\n * ç©å®¶é£æœºç±»\n * \n * The player-controlled aircraft with movement, shooting, and health management.\n * ç©å®¶æ§åˆ¶çš„é£æœºï¼Œå…·æœ‰ç§»åŠ¨ã€å°„å‡»å’Œç”Ÿå‘½å€¼ç®¡ç†åŠŸèƒ½ã€‚\n */\nimport { Collidable } from '../interfaces/Collidable';\nimport { Movable } from '../interfaces/Movable';\nimport { Rectangle } from '../types/Rectangle';\nimport { CollisionType, BulletOwner } from '../types/enums';\nimport { DEFAULT_GAME_CONFIG, GameConfig } from '../types/GameConfig';\nimport { Bullet } from './Bullet';\n\nexport class PlayerAircraft implements Collidable, Movable {\n  // GameObject properties\n  id: string;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  active: boolean;\n\n  // Movable properties\n  velocityX: number;\n  velocityY: number;\n  speed: number;\n\n  // Collidable properties\n  collisionBox: Rectangle;\n  collisionType: CollisionType;\n\n  // Player-specific properties\n  health: number;\n  maxHealth: number;\n  fireRate: number;\n  lastFireTime: number;\n  weaponLevel: number;\n\n  invincible: boolean;\n  invincibleTime: number;\n  invincibleDuration: number;\n\n  // Canvas bounds for boundary constraints\n  private canvasWidth: number;\n  private canvasHeight: number;\n  private config: GameConfig;\n\n  constructor(x: number, y: number, config: GameConfig = DEFAULT_GAME_CONFIG) {\n    this.id = `player_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    this.x = x;\n    this.y = y;\n    this.config = config;\n    this.width = config.player.width;\n    this.height = config.player.height;\n    this.active = true;\n\n    // Movable initialization\n    this.velocityX = 0;\n    this.velocityY = 0;\n    this.speed = config.player.speed;\n\n    // Collidable initialization\n    this.collisionBox = { x: this.x, y: this.y, width: this.width, height: this.height };\n    this.collisionType = CollisionType.PLAYER;\n\n    // Player-specific initialization\n    this.health = config.player.maxHealth;\n    this.maxHealth = config.player.maxHealth;\n    this.fireRate = config.player.fireRate;\n    this.lastFireTime = 0;\n    this.weaponLevel = 1;\n\n    this.invincible = false;\n    this.invincibleTime = 0;\n    this.invincibleDuration = config.player.invincibleDuration;\n\n    // Canvas bounds\n    this.canvasWidth = config.canvas.width;\n    this.canvasHeight = config.canvas.height;\n  }\n\n  /**\n   * Update the player aircraft state\n   * @param deltaTime Time elapsed since last frame in seconds\n   */\n  update(deltaTime: number): void {\n    if (!this.active) return;\n\n    // Move based on velocity\n    this.move(deltaTime);\n\n    // Update invincibility timer\n    if (this.invincible) {\n      this.invincibleTime -= deltaTime * 1000; // Convert to milliseconds\n      if (this.invincibleTime <= 0) {\n        this.invincible = false;\n        this.invincibleTime = 0;\n      }\n    }\n\n    // Update collision box position\n    this.collisionBox.x = this.x;\n    this.collisionBox.y = this.y;\n  }\n\n  /**\n   * Move the player aircraft based on velocity\n   * Implements boundary constraints to keep player within canvas\n   * @param deltaTime Time elapsed since last frame in seconds\n   */\n  move(deltaTime: number): void {\n    // Calculate new position\n    let newX = this.x + this.velocityX * deltaTime;\n    let newY = this.y + this.velocityY * deltaTime;\n\n    // Apply boundary constraints\n    newX = Math.max(0, Math.min(newX, this.canvasWidth - this.width));\n    newY = Math.max(0, Math.min(newY, this.canvasHeight - this.height));\n\n    this.x = newX;\n    this.y = newY;\n  }\n\n  /**\n   * Set the velocity of the player aircraft\n   * @param vx Velocity in X direction\n   * @param vy Velocity in Y direction\n   */\n  setVelocity(vx: number, vy: number): void {\n    this.velocityX = vx;\n    this.velocityY = vy;\n  }\n\n  /**\n   * Fire bullets based on current weapon level\n   * Implements fire rate limiting\n   * @param currentTime Current game time in milliseconds\n   * @returns Array of bullets fired, empty if fire rate not met\n   */\n  fire(currentTime: number): Bullet[] {\n    // Check fire rate limit\n    if (currentTime - this.lastFireTime < this.fireRate) {\n      return [];\n    }\n\n    this.lastFireTime = currentTime;\n    const bullets: Bullet[] = [];\n    const bulletConfig = this.config.bullet.player;\n\n    // Calculate bullet spawn position (center top of player)\n    const centerX = this.x + this.width / 2;\n    const bulletY = this.y - bulletConfig.height;\n\n    // Spawn bullets based on weapon level\n    switch (this.weaponLevel) {\n      case 1:\n        // Single bullet from center\n        bullets.push(new Bullet(\n          centerX - bulletConfig.width / 2,\n          bulletY,\n          BulletOwner.PLAYER,\n          -bulletConfig.speed, // Negative Y velocity (moving up)\n          this.config\n        ));\n        break;\n\n      case 2:\n        // Two bullets side by side\n        const offset2 = 10;\n        bullets.push(new Bullet(\n          centerX - bulletConfig.width / 2 - offset2,\n          bulletY,\n          BulletOwner.PLAYER,\n          -bulletConfig.speed,\n          this.config\n        ));\n        bullets.push(new Bullet(\n          centerX - bulletConfig.width / 2 + offset2,\n          bulletY,\n          BulletOwner.PLAYER,\n          -bulletConfig.speed,\n          this.config\n        ));\n        break;\n\n      case 3:\n      default:\n        // Three bullets in a spread pattern\n        const offset3 = 15;\n        bullets.push(new Bullet(\n          centerX - bulletConfig.width / 2 - offset3,\n          bulletY,\n          BulletOwner.PLAYER,\n          -bulletConfig.speed,\n          this.config\n        ));\n        bullets.push(new Bullet(\n          centerX - bulletConfig.width / 2,\n          bulletY,\n          BulletOwner.PLAYER,\n          -bulletConfig.speed,\n          this.config\n        ));\n        bullets.push(new Bullet(\n          centerX - bulletConfig.width / 2 + offset3,\n          bulletY,\n          BulletOwner.PLAYER,\n          -bulletConfig.speed,\n          this.config\n        ));\n        break;\n    }\n\n    return bullets;\n  }\n\n  /**\n   * Apply damage to the player\n   * Triggers invincibility if not already invincible\n   * @param damage Amount of damage to apply\n   */\n  takeDamage(damage: number): void {\n    if (this.invincible || !this.active) return;\n\n    this.health -= damage;\n\n    if (this.health <= 0) {\n      this.health = 0;\n      this.active = false;\n    } else {\n      // Trigger invincibility after taking damage\n      this.invincible = true;\n      this.invincibleTime = this.invincibleDuration;\n    }\n  }\n\n  /**\n   * Heal the player\n   * @param amount Amount of health to restore\n   */\n  heal(amount: number): void {\n    this.health = Math.min(this.health + amount, this.maxHealth);\n  }\n\n  /**\n   * Upgrade the weapon level\n   * Maximum weapon level is 3\n   */\n  upgradeWeapon(): void {\n    if (this.weaponLevel < 3) {\n      this.weaponLevel++;\n    }\n  }\n\n  /**\n   * Activate shield (temporary invincibility)\n   * @param duration Duration in milliseconds\n   */\n  activateShield(duration: number): void {\n    this.invincible = true;\n    this.invincibleTime = duration;\n  }\n\n  /**\n   * Handle collision with another object\n   * @param other The other collidable object\n   */\n  onCollision(other: Collidable): void {\n    switch (other.collisionType) {\n      case CollisionType.ENEMY:\n      case CollisionType.ENEMY_BULLET:\n        this.takeDamage(1);\n        break;\n      case CollisionType.POWER_UP:\n        // Power-up effects are handled by the PowerUp class\n        break;\n    }\n  }\n\n  /**\n   * Check collision with another object using AABB\n   * @param other The other collidable object\n   * @returns true if collision detected\n   */\n  checkCollision(other: Collidable): boolean {\n    const a = this.collisionBox;\n    const b = other.collisionBox;\n\n    return (\n      a.x < b.x + b.width &&\n      a.x + a.width > b.x &&\n      a.y < b.y + b.height &&\n      a.y + a.height > b.y\n    );\n  }\n\n  /**\n   * Render the player aircraft\n   * @param context The 2D rendering context\n   */\n  render(context: CanvasRenderingContext2D): void {\n    if (!this.active) return;\n\n    // Apply blinking effect when invincible\n    if (this.invincible && Math.floor(this.invincibleTime / 100) % 2 === 0) {\n      return; // Skip rendering for blink effect\n    }\n\n    context.save();\n\n    // Draw player aircraft as a triangle (placeholder)\n    context.fillStyle = '#00BFFF'; // Deep sky blue\n    context.beginPath();\n    context.moveTo(this.x + this.width / 2, this.y); // Top center\n    context.lineTo(this.x, this.y + this.height); // Bottom left\n    context.lineTo(this.x + this.width, this.y + this.height); // Bottom right\n    context.closePath();\n    context.fill();\n\n    // Draw cockpit\n    context.fillStyle = '#87CEEB'; // Light sky blue\n    context.beginPath();\n    context.arc(\n      this.x + this.width / 2,\n      this.y + this.height * 0.4,\n      this.width * 0.15,\n      0,\n      Math.PI * 2\n    );\n    context.fill();\n\n    context.restore();\n  }\n\n  /**\n   * Clean up and mark the player for removal\n   */\n  destroy(): void {\n    this.active = false;\n  }\n\n  /**\n   * Reset player to initial state\n   * @param x Initial X position\n   * @param y Initial Y position\n   */\n  reset(x: number, y: number): void {\n    this.x = x;\n    this.y = y;\n    this.velocityX = 0;\n    this.velocityY = 0;\n    this.health = this.maxHealth;\n    this.weaponLevel = 1;\n    this.invincible = false;\n    this.invincibleTime = 0;\n    this.lastFireTime = 0;\n    this.active = true;\n    this.collisionBox.x = this.x;\n    this.collisionBox.y = this.y;\n  }\n}\n","/**\n * Thunder Fighter Game - Main Entry Point\n * é›·éœ†æˆ˜æœºæ¸¸æˆ - ä¸»å…¥å£æ–‡ä»¶\n * \n * This file initializes and integrates all game systems:\n * - GameEngine: Core game loop and state management\n * - StateManager: Game state transitions (Menu, Playing, Paused, GameOver)\n * - InputManager: Keyboard and mouse input handling\n * - EntityManager: Game entity lifecycle management\n * - CollisionSystem: Collision detection and response\n * - SpawnSystem: Enemy and power-up spawning\n * - ScoreSystem: Score tracking and persistence\n * - RenderSystem: Visual rendering\n * - AudioManager: Sound effects and music\n * - VisualEffects: Explosions, particles, screen effects\n * - BackgroundRenderer: Scrolling space background\n * - UIRenderer: HUD and menu rendering\n * - SpriteManager: Procedural sprite generation\n */\n\nimport { GameEngine } from './core/GameEngine';\nimport { StateManager } from './core/StateManager';\nimport { EntityManager } from './core/EntityManager';\nimport { InputManager } from './core/InputManager';\nimport { MenuState } from './core/states/MenuState';\nimport { PlayingState } from './core/states/PlayingState';\nimport { PausedState } from './core/states/PausedState';\nimport { GameOverState } from './core/states/GameOverState';\nimport { CollisionSystem, CollisionEventType } from './systems/CollisionSystem';\nimport { SpawnSystem } from './systems/SpawnSystem';\nimport { ScoreSystem } from './systems/ScoreSystem';\n// RenderSystem available for advanced rendering features\n// import { RenderSystem } from './systems/RenderSystem';\nimport { AudioManager } from './systems/AudioManager';\nimport { VisualEffects } from './systems/VisualEffects';\nimport { BackgroundRenderer } from './systems/BackgroundRenderer';\nimport { UIRenderer } from './systems/UIRenderer';\nimport { SpriteManager } from './systems/SpriteManager';\nimport { PlayerAircraft } from './entities/PlayerAircraft';\nimport { EnemyAircraft } from './entities/EnemyAircraft';\nimport { Bullet } from './entities/Bullet';\nimport { PowerUp } from './entities/PowerUp';\nimport { GameStateType, SoundEffect, EnemyType } from './types/enums';\nimport { DEFAULT_GAME_CONFIG, GameConfig } from './types/GameConfig';\n\n/**\n * ThunderFighterGame Class\n * é›·éœ†æˆ˜æœºæ¸¸æˆç±»\n * \n * Main game class that orchestrates all systems and manages the game lifecycle.\n */\nclass ThunderFighterGame {\n  // Core systems\n  private engine: GameEngine;\n  private stateManager: StateManager;\n  private entityManager: EntityManager;\n  private inputManager: InputManager;\n  \n  // Game systems\n  private collisionSystem: CollisionSystem;\n  private spawnSystem: SpawnSystem;\n  private scoreSystem: ScoreSystem;\n  // RenderSystem is available but we use custom rendering in this integration\n  // private renderSystem: RenderSystem;\n  private audioManager: AudioManager;\n  \n  // Visual systems\n  private visualEffects: VisualEffects;\n  private backgroundRenderer: BackgroundRenderer;\n  private uiRenderer: UIRenderer;\n  private spriteManager: SpriteManager;\n  \n  // Game state\n  private player: PlayerAircraft | null = null;\n  private config: GameConfig;\n  private gameTime: number = 0;\n  private isInitialized: boolean = false;\n  \n  // Game states\n  private menuState: MenuState | null = null;\n  private playingState: PlayingState | null = null;\n  private pausedState: PausedState | null = null;\n  private gameOverState: GameOverState | null = null;\n\n  constructor(canvasId: string = 'gameCanvas') {\n    this.config = DEFAULT_GAME_CONFIG;\n    \n    // Initialize core engine\n    this.engine = new GameEngine(canvasId, this.config);\n    this.stateManager = this.engine.getStateManager();\n    this.entityManager = this.engine.getEntityManager();\n    this.inputManager = this.engine.getInputManager();\n    \n    // Initialize game systems\n    this.collisionSystem = new CollisionSystem();\n    this.spawnSystem = new SpawnSystem(undefined, this.config);\n    this.scoreSystem = new ScoreSystem();\n    // RenderSystem available for future use\n    // this.renderSystem = new RenderSystem(this.engine.getContext(), this.config);\n    this.audioManager = new AudioManager();\n    \n    // Initialize visual systems\n    this.visualEffects = new VisualEffects(this.config);\n    this.backgroundRenderer = new BackgroundRenderer(this.config);\n    this.uiRenderer = new UIRenderer(this.config);\n    this.spriteManager = new SpriteManager();\n  }\n\n  /**\n   * Initialize the game\n   * åˆå§‹åŒ–æ¸¸æˆ\n   */\n  async initialize(): Promise<void> {\n    if (this.isInitialized) return;\n    \n    console.log('Thunder Fighter - Initializing...');\n    \n    // Initialize sprite manager\n    this.spriteManager.initialize();\n    \n    // Initialize audio (will be fully activated on first user interaction)\n    await this.audioManager.initialize();\n    \n    // Load audio assets (non-blocking)\n    this.loadAudioAssets();\n    \n    // Register game states\n    this.registerGameStates();\n    \n    // Setup collision callbacks\n    this.setupCollisionCallbacks();\n    \n    // Override engine's update and render methods\n    this.setupGameLoop();\n    \n    this.isInitialized = true;\n    console.log('Thunder Fighter - Initialization complete!');\n  }\n\n  /**\n   * Register all game states with the state manager\n   * å‘çŠ¶æ€ç®¡ç†å™¨æ³¨å†Œæ‰€æœ‰æ¸¸æˆçŠ¶æ€\n   */\n  private registerGameStates(): void {\n    // Create game states\n    this.menuState = new MenuState(this.stateManager, this.config);\n    this.playingState = new PlayingState(this.stateManager, this.entityManager, this.config);\n    this.pausedState = new PausedState(this.stateManager, this.config);\n    this.gameOverState = new GameOverState(this.stateManager, this.config);\n    \n    // Register states\n    this.stateManager.registerState(GameStateType.MENU, this.menuState);\n    this.stateManager.registerState(GameStateType.PLAYING, this.playingState);\n    this.stateManager.registerState(GameStateType.PAUSED, this.pausedState);\n    this.stateManager.registerState(GameStateType.GAME_OVER, this.gameOverState);\n    \n    // Set initial state to menu\n    this.stateManager.changeState(GameStateType.MENU);\n    \n    console.log('Game states registered: Menu, Playing, Paused, GameOver');\n  }\n\n  /**\n   * Setup collision system callbacks\n   * è®¾ç½®ç¢°æ’ç³»ç»Ÿå›è°ƒ\n   */\n  private setupCollisionCallbacks(): void {\n    // Player bullet hits enemy\n    this.collisionSystem.onCollision(CollisionEventType.PLAYER_BULLET_ENEMY, (event) => {\n      const bullet = event.entityA as Bullet;\n      const enemy = event.entityB as EnemyAircraft;\n      \n      // Apply damage to enemy\n      enemy.takeDamage(bullet.damage);\n      bullet.active = false;\n      \n      // Record hit for accuracy\n      this.scoreSystem.recordHit();\n      \n      // Create impact sparks\n      this.visualEffects.createImpactSparks(bullet.x, bullet.y, 5);\n      \n      // Play hit sound\n      this.audioManager.playSound(SoundEffect.HIT);\n      \n      // If enemy destroyed\n      if (!enemy.active) {\n        // Add score\n        this.scoreSystem.addScore(enemy.scoreValue, this.gameTime);\n        this.scoreSystem.recordEnemyDestroyed();\n        \n        // Create explosion\n        const explosionSize = enemy.type === EnemyType.BOSS ? 2 : 1;\n        this.visualEffects.createExplosion(\n          enemy.x + enemy.width / 2,\n          enemy.y + enemy.height / 2,\n          explosionSize\n        );\n        \n        // Play explosion sound\n        this.audioManager.playSound(SoundEffect.EXPLOSION);\n        \n        // Try to spawn power-up\n        this.spawnSystem.trySpawnPowerUp(\n          enemy.x + enemy.width / 2,\n          enemy.y + enemy.height / 2,\n          this.entityManager\n        );\n        \n        // Record for boss tracking\n        if (enemy.type === EnemyType.BOSS) {\n          this.spawnSystem.onBossDefeated();\n        } else {\n          this.spawnSystem.recordEnemyDestroyed(this.entityManager);\n        }\n      }\n    });\n\n    // Enemy bullet hits player\n    this.collisionSystem.onCollision(CollisionEventType.ENEMY_BULLET_PLAYER, (event) => {\n      const bullet = event.entityA as Bullet;\n      const player = event.entityB as PlayerAircraft;\n      \n      if (!player.invincible) {\n        player.takeDamage(bullet.damage);\n        bullet.active = false;\n        \n        // Create damage effect\n        this.visualEffects.createDamageEffect();\n        this.audioManager.playSound(SoundEffect.HIT);\n        \n        // Update playing state health\n        if (this.playingState) {\n          this.playingState.setHealth(player.health);\n        }\n        \n        // Check for game over\n        if (player.health <= 0) {\n          this.handleGameOver();\n        }\n      }\n    });\n\n    // Player collides with enemy\n    this.collisionSystem.onCollision(CollisionEventType.PLAYER_ENEMY, (event) => {\n      const player = event.entityA as PlayerAircraft;\n      const enemy = event.entityB as EnemyAircraft;\n      \n      if (!player.invincible) {\n        player.takeDamage(1);\n        enemy.active = false;\n        \n        // Create effects\n        this.visualEffects.createDamageEffect();\n        this.visualEffects.createExplosion(\n          enemy.x + enemy.width / 2,\n          enemy.y + enemy.height / 2,\n          0.8\n        );\n        this.audioManager.playSound(SoundEffect.EXPLOSION);\n        \n        // Update playing state health\n        if (this.playingState) {\n          this.playingState.setHealth(player.health);\n        }\n        \n        // Check for game over\n        if (player.health <= 0) {\n          this.handleGameOver();\n        }\n      }\n    });\n\n    // Player collects power-up\n    this.collisionSystem.onCollision(CollisionEventType.PLAYER_POWERUP, (event) => {\n      const player = event.entityA as PlayerAircraft;\n      const powerUp = event.entityB as PowerUp;\n      \n      // Apply power-up effect\n      powerUp.apply(player);\n      \n      // Create collection effect\n      const colors: Record<string, string> = {\n        'weaponUpgrade': '#ffd700',\n        'health': '#00ff00',\n        'shield': '#4169e1'\n      };\n      this.visualEffects.createPowerUpEffect(\n        powerUp.x + powerUp.width / 2,\n        powerUp.y + powerUp.height / 2,\n        colors[powerUp.type] || '#ffffff'\n      );\n      \n      // Play power-up sound\n      this.audioManager.playSound(SoundEffect.POWER_UP);\n      \n      // Update playing state health if health power-up\n      if (this.playingState) {\n        this.playingState.setHealth(player.health);\n      }\n    });\n  }\n\n  /**\n   * Setup the main game loop integration\n   * è®¾ç½®ä¸»æ¸¸æˆå¾ªç¯é›†æˆ\n   */\n  private setupGameLoop(): void {\n    // Store original methods\n    const originalUpdate = this.stateManager.update.bind(this.stateManager);\n    const originalRender = this.stateManager.render.bind(this.stateManager);\n    \n    // Override state manager update\n    this.stateManager.update = (deltaTime: number) => {\n      const currentState = this.stateManager.getCurrentStateType();\n      \n      if (currentState === GameStateType.PLAYING) {\n        this.updatePlaying(deltaTime);\n      } else if (currentState === GameStateType.MENU) {\n        this.updateMenu(deltaTime);\n      }\n      \n      // Call original update for state-specific logic\n      originalUpdate(deltaTime);\n    };\n    \n    // Override state manager render\n    this.stateManager.render = (context: CanvasRenderingContext2D) => {\n      const currentState = this.stateManager.getCurrentStateType();\n      \n      if (currentState === GameStateType.PLAYING) {\n        this.renderPlaying(context);\n      } else if (currentState === GameStateType.MENU) {\n        this.renderMenu(context);\n      } else if (currentState === GameStateType.PAUSED) {\n        // Render game state behind pause overlay\n        this.renderPlaying(context);\n        originalRender(context);\n      } else if (currentState === GameStateType.GAME_OVER) {\n        this.renderPlaying(context);\n        originalRender(context);\n      } else {\n        originalRender(context);\n      }\n    };\n    \n    // Listen for state changes\n    this.setupStateChangeListeners();\n  }\n\n  /**\n   * Setup listeners for state changes\n   * è®¾ç½®çŠ¶æ€å˜åŒ–ç›‘å¬å™¨\n   */\n  private setupStateChangeListeners(): void {\n    // Store original changeState\n    const originalChangeState = this.stateManager.changeState.bind(this.stateManager);\n    \n    this.stateManager.changeState = (type: GameStateType): boolean => {\n      const previousState = this.stateManager.getCurrentStateType();\n      const result = originalChangeState(type);\n      \n      if (result) {\n        this.onStateChange(previousState, type);\n      }\n      \n      return result;\n    };\n  }\n\n  /**\n   * Handle state change events\n   * å¤„ç†çŠ¶æ€å˜åŒ–äº‹ä»¶\n   */\n  private onStateChange(from: GameStateType | null, to: GameStateType): void {\n    console.log(`State change: ${from} -> ${to}`);\n    \n    if (to === GameStateType.PLAYING && from !== GameStateType.PAUSED) {\n      // Starting new game\n      this.startNewGame();\n    } else if (to === GameStateType.PLAYING && from === GameStateType.PAUSED) {\n      // Resuming from pause\n      this.audioManager.resumeMusic();\n    } else if (to === GameStateType.PAUSED) {\n      // Pausing game\n      this.audioManager.pauseMusic();\n    } else if (to === GameStateType.MENU) {\n      // Returning to menu\n      this.audioManager.stopMusic();\n      this.resetGame();\n    } else if (to === GameStateType.GAME_OVER) {\n      // Game over\n      this.audioManager.stopMusic();\n    }\n  }\n\n  /**\n   * Start a new game\n   * å¼€å§‹æ–°æ¸¸æˆ\n   */\n  private startNewGame(): void {\n    console.log('Starting new game...');\n    \n    // Reset systems\n    this.entityManager.clear();\n    this.scoreSystem.reset();\n    this.spawnSystem.reset();\n    this.visualEffects.clear();\n    this.backgroundRenderer.reset();\n    this.gameTime = 0;\n    \n    // Create player at bottom center\n    const playerX = (this.config.canvas.width - this.config.player.width) / 2;\n    const playerY = this.config.canvas.height - this.config.player.height - 50;\n    this.player = new PlayerAircraft(playerX, playerY, this.config);\n    this.entityManager.addEntity(this.player);\n    \n    // Update playing state\n    if (this.playingState) {\n      this.playingState.setHealth(this.player.health);\n    }\n    \n    // Start background music\n    this.audioManager.playMusic();\n    \n    console.log('New game started!');\n  }\n\n  /**\n   * Reset game state\n   * é‡ç½®æ¸¸æˆçŠ¶æ€\n   */\n  private resetGame(): void {\n    this.entityManager.clear();\n    this.visualEffects.clear();\n    this.player = null;\n    this.gameTime = 0;\n  }\n\n  /**\n   * Handle game over\n   * å¤„ç†æ¸¸æˆç»“æŸ\n   */\n  private handleGameOver(): void {\n    // Apply final score bonus\n    this.scoreSystem.applyFinalBonus();\n    \n    // Set final score in game over state\n    if (this.gameOverState) {\n      this.gameOverState.setFinalScore(this.scoreSystem.getCurrentScore());\n    }\n    \n    // Create big explosion at player position\n    if (this.player) {\n      this.visualEffects.createExplosion(\n        this.player.x + this.player.width / 2,\n        this.player.y + this.player.height / 2,\n        2,\n        'normal'\n      );\n    }\n    \n    // Transition to game over state\n    this.stateManager.changeState(GameStateType.GAME_OVER);\n  }\n\n  /**\n   * Update menu state\n   * æ›´æ–°èœå•çŠ¶æ€\n   */\n  private updateMenu(deltaTime: number): void {\n    this.backgroundRenderer.update(deltaTime);\n    this.uiRenderer.update(deltaTime);\n  }\n\n  /**\n   * Update playing state\n   * æ›´æ–°æ¸¸æˆçŠ¶æ€\n   */\n  private updatePlaying(deltaTime: number): void {\n    this.gameTime += deltaTime * 1000; // Convert to milliseconds\n    \n    // Update background\n    this.backgroundRenderer.update(deltaTime);\n    \n    // Update visual effects\n    this.visualEffects.update(deltaTime);\n    this.uiRenderer.update(deltaTime);\n    \n    // Handle player input\n    this.handlePlayerInput(deltaTime);\n    \n    // Update spawn system\n    this.spawnSystem.update(deltaTime, this.entityManager, this.gameTime);\n    \n    // Update all entities\n    this.entityManager.update(deltaTime);\n    \n    // Handle enemy shooting\n    this.handleEnemyShooting();\n    \n    // Check collisions\n    if (this.player && this.player.active) {\n      const enemies = this.entityManager.getEntitiesByType(EnemyAircraft);\n      const bullets = this.entityManager.getEntitiesByType(Bullet);\n      const powerUps = this.entityManager.getEntitiesByType(PowerUp);\n      \n      this.collisionSystem.update(this.player, enemies, bullets, powerUps);\n    }\n    \n    // Update playing state score\n    if (this.playingState) {\n      this.playingState.addScore(0); // Trigger score update\n    }\n    \n    // Create engine trails for player\n    if (this.player && this.player.active && Math.random() < 0.3) {\n      this.visualEffects.createEngineTrail(\n        this.player.x + this.player.width / 2,\n        this.player.y + this.player.height\n      );\n    }\n  }\n\n  /**\n   * Handle player input\n   * å¤„ç†ç©å®¶è¾“å…¥\n   */\n  private handlePlayerInput(_deltaTime: number): void {\n    if (!this.player || !this.player.active) return;\n    \n    let vx = 0;\n    let vy = 0;\n    \n    // Movement\n    if (this.inputManager.isActionActive('moveUp')) {\n      vy = -this.player.speed;\n    }\n    if (this.inputManager.isActionActive('moveDown')) {\n      vy = this.player.speed;\n    }\n    if (this.inputManager.isActionActive('moveLeft')) {\n      vx = -this.player.speed;\n    }\n    if (this.inputManager.isActionActive('moveRight')) {\n      vx = this.player.speed;\n    }\n    \n    // Normalize diagonal movement\n    if (vx !== 0 && vy !== 0) {\n      const factor = 1 / Math.sqrt(2);\n      vx *= factor;\n      vy *= factor;\n    }\n    \n    this.player.setVelocity(vx, vy);\n    \n    // Shooting\n    if (this.inputManager.isActionActive('fire')) {\n      const bullets = this.player.fire(this.gameTime);\n      if (bullets.length > 0) {\n        for (const bullet of bullets) {\n          this.entityManager.addEntity(bullet);\n        }\n        this.scoreSystem.recordShots(bullets.length);\n        this.audioManager.playSound(SoundEffect.PLAYER_SHOOT);\n      }\n    }\n  }\n\n  /**\n   * Handle enemy shooting\n   * å¤„ç†æ•Œæœºå°„å‡»\n   */\n  private handleEnemyShooting(): void {\n    const enemies = this.entityManager.getEntitiesByType(EnemyAircraft);\n    \n    for (const enemy of enemies) {\n      if (!enemy.active) continue;\n      \n      if (enemy.type === EnemyType.BOSS) {\n        const bullets = enemy.fireBoss(this.gameTime);\n        for (const bullet of bullets) {\n          this.entityManager.addEntity(bullet);\n        }\n        if (bullets.length > 0) {\n          this.audioManager.playSound(SoundEffect.ENEMY_SHOOT);\n        }\n      } else {\n        const bullet = enemy.fire(this.gameTime);\n        if (bullet) {\n          this.entityManager.addEntity(bullet);\n          this.audioManager.playSound(SoundEffect.ENEMY_SHOOT);\n        }\n      }\n    }\n  }\n\n  /**\n   * Render menu state\n   * æ¸²æŸ“èœå•çŠ¶æ€\n   */\n  private renderMenu(context: CanvasRenderingContext2D): void {\n    // Render background\n    this.backgroundRenderer.render(context);\n    \n    // Render menu UI\n    this.uiRenderer.renderMenuScreen(context, 0);\n  }\n\n  /**\n   * Render playing state\n   * æ¸²æŸ“æ¸¸æˆçŠ¶æ€\n   */\n  private renderPlaying(context: CanvasRenderingContext2D): void {\n    // Render background\n    this.backgroundRenderer.render(context);\n    \n    // Render entities in order: power-ups, bullets, enemies, player\n    const powerUps = this.entityManager.getEntitiesByType(PowerUp);\n    const bullets = this.entityManager.getEntitiesByType(Bullet);\n    const enemies = this.entityManager.getEntitiesByType(EnemyAircraft);\n    \n    for (const powerUp of powerUps) {\n      powerUp.render(context);\n    }\n    \n    for (const bullet of bullets) {\n      bullet.render(context);\n    }\n    \n    for (const enemy of enemies) {\n      enemy.render(context);\n    }\n    \n    if (this.player && this.player.active) {\n      this.player.render(context);\n    }\n    \n    // Render visual effects\n    this.visualEffects.render(context);\n    \n    // Render HUD\n    const scoreData = this.scoreSystem.getScoreData();\n    const health = this.player?.health ?? 0;\n    const maxHealth = this.player?.maxHealth ?? this.config.player.maxHealth;\n    const weaponLevel = this.player?.weaponLevel ?? 1;\n    \n    this.uiRenderer.renderGameHUD(context, scoreData, health, maxHealth, weaponLevel);\n  }\n\n  /**\n   * Load audio assets\n   * åŠ è½½éŸ³é¢‘èµ„æº\n   */\n  private async loadAudioAssets(): Promise<void> {\n    try {\n      // Try to load sounds (will fail gracefully if files don't exist)\n      // Note: In Vite, public directory files are served at root path\n      await Promise.all([\n        this.audioManager.loadSound(SoundEffect.PLAYER_SHOOT, 'sounds/player_shoot.mp3'),\n        this.audioManager.loadSound(SoundEffect.ENEMY_SHOOT, 'sounds/enemy_shoot.mp3'),\n        this.audioManager.loadSound(SoundEffect.EXPLOSION, 'sounds/explosion.mp3'),\n        this.audioManager.loadSound(SoundEffect.POWER_UP, 'sounds/power_up.mp3'),\n        this.audioManager.loadSound(SoundEffect.HIT, 'sounds/hit.mp3'),\n        this.audioManager.loadMusic('music/bgm.mp3')\n      ]);\n      console.log('Audio assets loaded (or using fallbacks)');\n    } catch (error) {\n      console.warn('Some audio assets could not be loaded:', error);\n    }\n  }\n\n  /**\n   * Start the game\n   * å¯åŠ¨æ¸¸æˆ\n   */\n  start(): void {\n    if (!this.isInitialized) {\n      console.error('Game not initialized! Call initialize() first.');\n      return;\n    }\n    \n    console.log('Thunder Fighter - Starting game engine...');\n    this.engine.start();\n  }\n\n  /**\n   * Stop the game\n   * åœæ­¢æ¸¸æˆ\n   */\n  stop(): void {\n    this.engine.stop();\n    this.audioManager.dispose();\n  }\n\n  /**\n   * Get the game engine\n   * è·å–æ¸¸æˆå¼•æ“\n   */\n  getEngine(): GameEngine {\n    return this.engine;\n  }\n}\n\n// Global game instance\nlet game: ThunderFighterGame | null = null;\n\n/**\n * Initialize and start the game when DOM is ready\n * å½“DOMå‡†å¤‡å°±ç»ªæ—¶åˆå§‹åŒ–å¹¶å¯åŠ¨æ¸¸æˆ\n */\ndocument.addEventListener('DOMContentLoaded', async () => {\n  console.log('Thunder Fighter Game - Loading...');\n  \n  const canvas = document.getElementById('gameCanvas') as HTMLCanvasElement;\n  if (!canvas) {\n    console.error('Canvas element not found!');\n    return;\n  }\n  \n  const ctx = canvas.getContext('2d');\n  if (!ctx) {\n    console.error('Could not get 2D context!');\n    return;\n  }\n  \n  // Display loading message\n  ctx.fillStyle = '#1a1a2e';\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  ctx.fillStyle = '#00d4ff';\n  ctx.font = 'bold 36px Arial';\n  ctx.textAlign = 'center';\n  ctx.fillText('THUNDER FIGHTER', canvas.width / 2, canvas.height / 2 - 40);\n  ctx.fillStyle = '#ffffff';\n  ctx.font = '24px Arial';\n  ctx.fillText('é›·éœ†æˆ˜æœº', canvas.width / 2, canvas.height / 2);\n  ctx.fillStyle = '#aaaaaa';\n  ctx.font = '18px Arial';\n  ctx.fillText('Loading...', canvas.width / 2, canvas.height / 2 + 40);\n  \n  try {\n    // Create and initialize game\n    game = new ThunderFighterGame('gameCanvas');\n    await game.initialize();\n    \n    // Start the game\n    game.start();\n    \n    console.log('Thunder Fighter Game - Ready!');\n  } catch (error) {\n    console.error('Failed to initialize game:', error);\n    \n    // Display error message\n    ctx.fillStyle = '#1a1a2e';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    ctx.fillStyle = '#ff4444';\n    ctx.font = '20px Arial';\n    ctx.textAlign = 'center';\n    ctx.fillText('Failed to load game', canvas.width / 2, canvas.height / 2);\n    ctx.fillStyle = '#aaaaaa';\n    ctx.font = '14px Arial';\n    ctx.fillText('Please refresh the page', canvas.width / 2, canvas.height / 2 + 30);\n  }\n});\n\n// Export for potential external use\nexport { ThunderFighterGame, game };\n"],"names":["GameStateType","EnemyType","BulletOwner","PowerUpType","CollisionType","SoundEffect","MovementPattern","VALID_TRANSITIONS","_StateManager","type","state","newState","validTransitions","targetType","deltaTime","context","input","__name","StateManager","createDefaultInputState","DEFAULT_KEY_BINDINGS","_InputManager","canvas","action","key","boundAction","keyCode","event","rect","scaleX","scaleY","InputManager","_EntityManager","entity","id","result","e","inactiveIds","EntityManager","DEFAULT_GAME_CONFIG","_GameEngine","canvasId","config","currentTime","inputState","elapsed","GameEngine","_MenuState","stateManager","_deltaTime","width","height","alpha","startPressed","MenuState","_PlayingState","entityManager","pausePressed","offset","x","y","size","points","health","damage","PlayingState","_PausedState","options","optionStartY","optionSpacing","option","index","isSelected","resumePressed","PausedState","_GameOverState","confirmPressed","score","saved","GameOverState","CollisionEventType","_CollisionSystem","a","b","bullets","enemies","events","playerBullets","bullet","enemy","player","enemyBullets","powerUps","powerUp","callback","callbacks","CollisionSystem","_Bullet","owner","velocityY","bulletConfig","vx","vy","other","Bullet","_EnemyAircraft","enemyConfig","newX","verticalOffset","bulletX","bulletY","centerX","spread","i","healthBarWidth","healthBarHeight","healthBarX","healthBarY","healthPercent","EnemyAircraft","_PowerUp","centerY","cx","cy","outerRadius","innerRadius","spikes","radius","angle","crossWidth","crossLength","types","weights","random","cumulative","PowerUp","_SpawnSystem","gameConfig","difficultyIntervals","baseRate","minRate","adjustedRate","enemyType","maxX","weight","bossConfig","boss","SpawnSystem","HIGH_SCORE_KEY","_ScoreSystem","actualPoints","count","parsed","accuracy","finalScore","ScoreSystem","_AudioManager","effect","path","resolve","audio","error","clone","volume","muted","basePath","soundFiles","loadPromises","filename","AudioManager","_VisualEffects","colorPalette","colors","particles","particleCount","speed","isPlayer","color","secondaryColor","duration","intensity","particle","explosion","progress","ctx","shakeEffect","shakeX","shakeY","flashGradient","gradient","vignetteAlpha","vignetteGradient","VisualEffects","_BackgroundRenderer","starCount","nebulaColors","doubleHeight","starCtx","star","nebulaCtx","nebula","nebulaGradient","parallaxOffset","twinkle","planetY","planetGradient","BackgroundRenderer","_UIRenderer","selectedOption","optionY","text","selected","bx","by","pulse","scoreData","maxHealth","weaponLevel","topBarGradient","bottomBarGradient","healthColor","healthGradient","level","indicatorX","panelWidth","panelHeight","panelX","panelY","isNewHighScore","overlay","highlightWidth","highlightX","amount","hex","r","g","px","py","button","UIRenderer","_SpriteManager","powerUpType","bodyGradient","cockpitGradient","coreGradient","playerCanvas","playerCtx","playerGradient","enemyWidth","enemyHeight","enemyCanvas","enemyCtx","enemyGradient","weaponCanvas","weaponCtx","healthCanvas","healthCtx","shieldCanvas","shieldCtx","fillColor","strokeColor","widthOffset","bgGradient","glowGradient","shieldGradient","frames","spriteTypes","frame","maxRadius","mainGradient","sparkRadius","sparkX","sparkY","sprite","drawWidth","drawHeight","SpriteManager","_PlayerAircraft","newY","offset2","offset3","PlayerAircraft","_ThunderFighterGame","explosionSize","originalUpdate","originalRender","currentState","originalChangeState","previousState","from","to","playerX","playerY","factor","ThunderFighterGame","game"],"mappings":"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"}